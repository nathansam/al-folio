/**
 * @licstart The following is the entire license notice for the
 * Javascript code in this page
 *
 * Copyright 2022 Mozilla Foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * @licend The above is the entire license notice for the
 * Javascript code in this page
 */(()=>{"use strict";var __webpack_modules__=[,(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.compatibilityParams=exports.OptionKind=exports.AppOptions=void 0;const compatibilityParams=Object.create(null);exports.compatibilityParams=compatibilityParams;{const userAgent=navigator.userAgent||"",platform=navigator.platform||"",maxTouchPoints=navigator.maxTouchPoints||1,isAndroid=/Android/.test(userAgent);(/\b(iPad|iPhone|iPod)(?=;)/.test(userAgent)||"MacIntel"===platform&&maxTouchPoints>1||isAndroid)&&(compatibilityParams.maxCanvasPixels=5242880)}const OptionKind={VIEWER:2,API:4,WORKER:8,PREFERENCE:128};exports.OptionKind=OptionKind;const defaultOptions={annotationMode:{value:2,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},cursorToolOnLoad:{value:0,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},defaultUrl:{value:"compressed.tracemonkey-pldi-09.pdf",kind:OptionKind.VIEWER},defaultZoomValue:{value:"",kind:OptionKind.VIEWER+OptionKind.PREFERENCE},disableHistory:{value:!1,kind:OptionKind.VIEWER},disablePageLabels:{value:!1,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},enablePermissions:{value:!1,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},enablePrintAutoRotate:{value:!0,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},enableScripting:{value:!0,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},externalLinkRel:{value:"noopener noreferrer nofollow",kind:OptionKind.VIEWER},externalLinkTarget:{value:0,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},historyUpdateUrl:{value:!1,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},ignoreDestinationZoom:{value:!1,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},imageResourcesPath:{value:"./images/",kind:OptionKind.VIEWER},maxCanvasPixels:{value:16777216,compatibility:compatibilityParams.maxCanvasPixels,kind:OptionKind.VIEWER},pdfBugEnabled:{value:!1,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},printResolution:{value:150,kind:OptionKind.VIEWER},renderer:{value:"canvas",kind:OptionKind.VIEWER},sidebarViewOnLoad:{value:-1,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},scrollModeOnLoad:{value:-1,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},spreadModeOnLoad:{value:-1,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},textLayerMode:{value:1,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},useOnlyCssZoom:{value:!1,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},viewerCssTheme:{value:0,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},viewOnLoad:{value:0,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},cMapPacked:{value:!0,kind:OptionKind.API},cMapUrl:{value:"../web/cmaps/",kind:OptionKind.API},disableAutoFetch:{value:!1,kind:OptionKind.API+OptionKind.PREFERENCE},disableFontFace:{value:!1,kind:OptionKind.API+OptionKind.PREFERENCE},disableRange:{value:!1,kind:OptionKind.API+OptionKind.PREFERENCE},disableStream:{value:!1,kind:OptionKind.API+OptionKind.PREFERENCE},docBaseUrl:{value:"",kind:OptionKind.API},enableXfa:{value:!0,kind:OptionKind.API+OptionKind.PREFERENCE},fontExtraProperties:{value:!1,kind:OptionKind.API},isEvalSupported:{value:!0,kind:OptionKind.API},maxImageSize:{value:-1,kind:OptionKind.API},pdfBug:{value:!1,kind:OptionKind.API},standardFontDataUrl:{value:"../web/standard_fonts/",kind:OptionKind.API},verbosity:{value:1,kind:OptionKind.API},workerPort:{value:null,kind:OptionKind.WORKER},workerSrc:{value:"../build/pdf.worker.js",kind:OptionKind.WORKER}};defaultOptions.disablePreferences={value:!1,kind:OptionKind.VIEWER},defaultOptions.locale={value:navigator.language||"en-US",kind:OptionKind.VIEWER},defaultOptions.sandboxBundleSrc={value:"../build/pdf.sandbox.js",kind:OptionKind.VIEWER},defaultOptions.renderer.kind+=OptionKind.PREFERENCE;const userOptions=Object.create(null);exports.AppOptions=class{constructor(){throw new Error("Cannot initialize AppOptions.")}static get(name){const userOption=userOptions[name];if(void 0!==userOption)return userOption;const defaultOption=defaultOptions[name];return void 0!==defaultOption?defaultOption.compatibility??defaultOption.value:void 0}static getAll(kind=null){const options=Object.create(null);for(const name in defaultOptions){const defaultOption=defaultOptions[name];if(kind){if(0==(kind&defaultOption.kind))continue;if(kind===OptionKind.PREFERENCE){const value=defaultOption.value,valueType=typeof value;if("boolean"===valueType||"string"===valueType||"number"===valueType&&Number.isInteger(value)){options[name]=value;continue}throw new Error(`Invalid type for preference: ${name}`)}}const userOption=userOptions[name];options[name]=void 0!==userOption?userOption:defaultOption.compatibility??defaultOption.value}return options}static set(name,value){userOptions[name]=value}static setAll(options){for(const name in options)userOptions[name]=options[name]}static remove(name){delete userOptions[name]}static _hasUserOptions(){return Object.keys(userOptions).length>0}}},(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.PDFViewerApplication=exports.PDFPrintServiceFactory=exports.DefaultExternalServices=void 0;var _ui_utils=__webpack_require__(3),_app_options=__webpack_require__(1),_event_utils=__webpack_require__(4),_pdfjsLib=__webpack_require__(5),_pdf_cursor_tools=__webpack_require__(6),_pdf_link_service=__webpack_require__(8),_overlay_manager=__webpack_require__(9),_password_prompt=__webpack_require__(10),_pdf_attachment_viewer=__webpack_require__(11),_pdf_document_properties=__webpack_require__(13),_pdf_find_bar=__webpack_require__(14),_pdf_find_controller=__webpack_require__(15),_pdf_history=__webpack_require__(17),_pdf_layer_viewer=__webpack_require__(18),_pdf_outline_viewer=__webpack_require__(19),_pdf_presentation_mode=__webpack_require__(20),_pdf_rendering_queue=__webpack_require__(21),_pdf_scripting_manager=__webpack_require__(22),_pdf_sidebar=__webpack_require__(23),_pdf_sidebar_resizer=__webpack_require__(24),_pdf_thumbnail_viewer=__webpack_require__(25),_pdf_viewer=__webpack_require__(27),_secondary_toolbar=__webpack_require__(36),_toolbar=__webpack_require__(37),_view_history=__webpack_require__(38);const ViewOnLoad_UNKNOWN=-1,ViewOnLoad_INITIAL=1,ViewerCssTheme={AUTOMATIC:0,LIGHT:1,DARK:2},KNOWN_VERSIONS=["1.0","1.1","1.2","1.3","1.4","1.5","1.6","1.7","1.8","1.9","2.0","2.1","2.2","2.3"],KNOWN_GENERATORS=["acrobat distiller","acrobat pdfwriter","adobe livecycle","adobe pdf library","adobe photoshop","ghostscript","tcpdf","cairo","dvipdfm","dvips","pdftex","pdfkit","itext","prince","quarkxpress","mac os x","microsoft","openoffice","oracle","luradocument","pdf-xchange","antenna house","aspose.cells","fpdf"];class DefaultExternalServices{constructor(){throw new Error("Cannot initialize DefaultExternalServices.")}static updateFindControlState(data){}static updateFindMatchesCount(data){}static initPassiveLoading(callbacks){}static async fallback(data){}static reportTelemetry(data){}static createDownloadManager(options){throw new Error("Not implemented: createDownloadManager")}static createPreferences(){throw new Error("Not implemented: createPreferences")}static createL10n(options){throw new Error("Not implemented: createL10n")}static createScripting(options){throw new Error("Not implemented: createScripting")}static get supportsIntegratedFind(){return(0,_pdfjsLib.shadow)(this,"supportsIntegratedFind",!1)}static get supportsDocumentFonts(){return(0,_pdfjsLib.shadow)(this,"supportsDocumentFonts",!0)}static get supportedMouseWheelZoomModifierKeys(){return(0,_pdfjsLib.shadow)(this,"supportedMouseWheelZoomModifierKeys",{ctrlKey:!0,metaKey:!0})}static get isInAutomation(){return(0,_pdfjsLib.shadow)(this,"isInAutomation",!1)}}exports.DefaultExternalServices=DefaultExternalServices;const PDFViewerApplication={initialBookmark:document.location.hash.substring(1),_initializedCapability:(0,_pdfjsLib.createPromiseCapability)(),_fellback:!1,appConfig:null,pdfDocument:null,pdfLoadingTask:null,printService:null,pdfViewer:null,pdfThumbnailViewer:null,pdfRenderingQueue:null,pdfPresentationMode:null,pdfDocumentProperties:null,pdfLinkService:null,pdfHistory:null,pdfSidebar:null,pdfSidebarResizer:null,pdfOutlineViewer:null,pdfAttachmentViewer:null,pdfLayerViewer:null,pdfCursorTools:null,pdfScriptingManager:null,store:null,downloadManager:null,overlayManager:null,preferences:null,toolbar:null,secondaryToolbar:null,eventBus:null,l10n:null,isInitialViewSet:!1,downloadComplete:!1,isViewerEmbedded:window.parent!==window,url:"",baseUrl:"",_downloadUrl:"",externalServices:DefaultExternalServices,_boundEvents:Object.create(null),documentInfo:null,metadata:null,_contentDispositionFilename:null,_contentLength:null,_saveInProgress:!1,_docStats:null,_wheelUnusedTicks:0,_idleCallbacks:new Set,async initialize(appConfig){this.preferences=this.externalServices.createPreferences(),this.appConfig=appConfig,await this._readPreferences(),await this._parseHashParameters(),this._forceCssTheme(),await this._initializeL10n(),this.isViewerEmbedded&&_app_options.AppOptions.get("externalLinkTarget")===_pdf_link_service.LinkTarget.NONE&&_app_options.AppOptions.set("externalLinkTarget",_pdf_link_service.LinkTarget.TOP),await this._initializeViewerComponents(),this.bindEvents(),this.bindWindowEvents();const appContainer=appConfig.appContainer||document.documentElement;this.l10n.translate(appContainer).then((()=>{this.eventBus.dispatch("localized",{source:this})})),this._initializedCapability.resolve()},async _readPreferences(){if(!_app_options.AppOptions.get("disablePreferences")){_app_options.AppOptions._hasUserOptions()&&console.warn('_readPreferences: The Preferences may override manually set AppOptions; please use the "disablePreferences"-option in order to prevent that.');try{_app_options.AppOptions.setAll(await this.preferences.getAll())}catch(reason){console.error(`_readPreferences: "${reason?.message}".`)}}},async _parseHashParameters(){if(!_app_options.AppOptions.get("pdfBugEnabled"))return;const hash=document.location.hash.substring(1);if(!hash)return;const params=(0,_ui_utils.parseQueryString)(hash),waitOn=[];if("true"===params.get("disableworker")&&waitOn.push(async function(){_pdfjsLib.GlobalWorkerOptions.workerSrc||(_pdfjsLib.GlobalWorkerOptions.workerSrc=_app_options.AppOptions.get("workerSrc"));await(0,_pdfjsLib.loadScript)(_pdfjsLib.PDFWorker.workerSrc)}()),params.has("disablerange")&&_app_options.AppOptions.set("disableRange","true"===params.get("disablerange")),params.has("disablestream")&&_app_options.AppOptions.set("disableStream","true"===params.get("disablestream")),params.has("disableautofetch")&&_app_options.AppOptions.set("disableAutoFetch","true"===params.get("disableautofetch")),params.has("disablefontface")&&_app_options.AppOptions.set("disableFontFace","true"===params.get("disablefontface")),params.has("disablehistory")&&_app_options.AppOptions.set("disableHistory","true"===params.get("disablehistory")),params.has("verbosity")&&_app_options.AppOptions.set("verbosity",0|params.get("verbosity")),params.has("textlayer"))switch(params.get("textlayer")){case"off":_app_options.AppOptions.set("textLayerMode",_ui_utils.TextLayerMode.DISABLE);break;case"visible":case"shadow":case"hover":this.appConfig.viewerContainer.classList.add(`textLayer-${params.get("textlayer")}`)}if(params.has("pdfbug")){_app_options.AppOptions.set("pdfBug",!0),_app_options.AppOptions.set("fontExtraProperties",!0);const enabled=params.get("pdfbug").split(",");waitOn.push(async function(enabledTabs){const{debuggerScriptPath:debuggerScriptPath,mainContainer:mainContainer}=PDFViewerApplication.appConfig;await(0,_pdfjsLib.loadScript)(debuggerScriptPath),PDFBug.init({OPS:_pdfjsLib.OPS},mainContainer,enabledTabs)}(enabled))}if(params.has("locale")&&_app_options.AppOptions.set("locale",params.get("locale")),0!==waitOn.length)try{await Promise.all(waitOn)}catch(reason){console.error(`_parseHashParameters: "${reason.message}".`)}},async _initializeL10n(){this.l10n=this.externalServices.createL10n({locale:_app_options.AppOptions.get("locale")});const dir=await this.l10n.getDirection();document.getElementsByTagName("html")[0].dir=dir},_forceCssTheme(){const cssTheme=_app_options.AppOptions.get("viewerCssTheme");if(cssTheme!==ViewerCssTheme.AUTOMATIC&&Object.values(ViewerCssTheme).includes(cssTheme))try{const styleSheet=document.styleSheets[0],cssRules=styleSheet?.cssRules||[];for(let i=0,ii=cssRules.length;i<ii;i++){const rule=cssRules[i];if(rule instanceof CSSMediaRule&&"(prefers-color-scheme: dark)"===rule.media?.[0]){if(cssTheme===ViewerCssTheme.LIGHT)return void styleSheet.deleteRule(i);const darkRules=/^@media \(prefers-color-scheme: dark\) {\n\s*([\w\s-.,:;/\\{}()]+)\n}$/.exec(rule.cssText);return void(darkRules?.[1]&&(styleSheet.deleteRule(i),styleSheet.insertRule(darkRules[1],i)))}}}catch(reason){console.error(`_forceCssTheme: "${reason?.message}".`)}},async _initializeViewerComponents(){const{appConfig:appConfig,externalServices:externalServices}=this,eventBus=externalServices.isInAutomation?new _event_utils.AutomationEventBus:new _event_utils.EventBus;this.eventBus=eventBus,this.overlayManager=new _overlay_manager.OverlayManager;const pdfRenderingQueue=new _pdf_rendering_queue.PDFRenderingQueue;pdfRenderingQueue.onIdle=this._cleanup.bind(this),this.pdfRenderingQueue=pdfRenderingQueue;const pdfLinkService=new _pdf_link_service.PDFLinkService({eventBus:eventBus,externalLinkTarget:_app_options.AppOptions.get("externalLinkTarget"),externalLinkRel:_app_options.AppOptions.get("externalLinkRel"),ignoreDestinationZoom:_app_options.AppOptions.get("ignoreDestinationZoom")});this.pdfLinkService=pdfLinkService;const downloadManager=externalServices.createDownloadManager();this.downloadManager=downloadManager;const findController=new _pdf_find_controller.PDFFindController({linkService:pdfLinkService,eventBus:eventBus});this.findController=findController;const pdfScriptingManager=new _pdf_scripting_manager.PDFScriptingManager({eventBus:eventBus,sandboxBundleSrc:_app_options.AppOptions.get("sandboxBundleSrc"),scriptingFactory:externalServices,docPropertiesLookup:this._scriptingDocProperties.bind(this)});this.pdfScriptingManager=pdfScriptingManager;const container=appConfig.mainContainer,viewer=appConfig.viewerContainer;this.pdfViewer=new _pdf_viewer.PDFViewer({container:container,viewer:viewer,eventBus:eventBus,renderingQueue:pdfRenderingQueue,linkService:pdfLinkService,downloadManager:downloadManager,findController:findController,scriptingManager:_app_options.AppOptions.get("enableScripting")&&pdfScriptingManager,renderer:_app_options.AppOptions.get("renderer"),l10n:this.l10n,textLayerMode:_app_options.AppOptions.get("textLayerMode"),annotationMode:_app_options.AppOptions.get("annotationMode"),imageResourcesPath:_app_options.AppOptions.get("imageResourcesPath"),enablePrintAutoRotate:_app_options.AppOptions.get("enablePrintAutoRotate"),useOnlyCssZoom:_app_options.AppOptions.get("useOnlyCssZoom"),maxCanvasPixels:_app_options.AppOptions.get("maxCanvasPixels"),enablePermissions:_app_options.AppOptions.get("enablePermissions")}),pdfRenderingQueue.setViewer(this.pdfViewer),pdfLinkService.setViewer(this.pdfViewer),pdfScriptingManager.setViewer(this.pdfViewer),this.pdfThumbnailViewer=new _pdf_thumbnail_viewer.PDFThumbnailViewer({container:appConfig.sidebar.thumbnailView,eventBus:eventBus,renderingQueue:pdfRenderingQueue,linkService:pdfLinkService,l10n:this.l10n}),pdfRenderingQueue.setThumbnailViewer(this.pdfThumbnailViewer),this.isViewerEmbedded||_app_options.AppOptions.get("disableHistory")||(this.pdfHistory=new _pdf_history.PDFHistory({linkService:pdfLinkService,eventBus:eventBus}),pdfLinkService.setHistory(this.pdfHistory)),this.supportsIntegratedFind||(this.findBar=new _pdf_find_bar.PDFFindBar(appConfig.findBar,eventBus,this.l10n)),this.pdfDocumentProperties=new _pdf_document_properties.PDFDocumentProperties(appConfig.documentProperties,this.overlayManager,eventBus,this.l10n),this.pdfCursorTools=new _pdf_cursor_tools.PDFCursorTools({container:container,eventBus:eventBus,cursorToolOnLoad:_app_options.AppOptions.get("cursorToolOnLoad")}),this.toolbar=new _toolbar.Toolbar(appConfig.toolbar,eventBus,this.l10n),this.secondaryToolbar=new _secondary_toolbar.SecondaryToolbar(appConfig.secondaryToolbar,container,eventBus),this.supportsFullscreen&&(this.pdfPresentationMode=new _pdf_presentation_mode.PDFPresentationMode({container:container,pdfViewer:this.pdfViewer,eventBus:eventBus})),this.passwordPrompt=new _password_prompt.PasswordPrompt(appConfig.passwordOverlay,this.overlayManager,this.l10n,this.isViewerEmbedded),this.pdfOutlineViewer=new _pdf_outline_viewer.PDFOutlineViewer({container:appConfig.sidebar.outlineView,eventBus:eventBus,linkService:pdfLinkService}),this.pdfAttachmentViewer=new _pdf_attachment_viewer.PDFAttachmentViewer({container:appConfig.sidebar.attachmentsView,eventBus:eventBus,downloadManager:downloadManager}),this.pdfLayerViewer=new _pdf_layer_viewer.PDFLayerViewer({container:appConfig.sidebar.layersView,eventBus:eventBus,l10n:this.l10n}),this.pdfSidebar=new _pdf_sidebar.PDFSidebar({elements:appConfig.sidebar,pdfViewer:this.pdfViewer,pdfThumbnailViewer:this.pdfThumbnailViewer,eventBus:eventBus,l10n:this.l10n}),this.pdfSidebar.onToggled=this.forceRendering.bind(this),this.pdfSidebarResizer=new _pdf_sidebar_resizer.PDFSidebarResizer(appConfig.sidebarResizer,eventBus,this.l10n)},run(config){this.initialize(config).then(webViewerInitialized)},get initialized(){return this._initializedCapability.settled},get initializedPromise(){return this._initializedCapability.promise},zoomIn(steps){this.pdfViewer.isInPresentationMode||this.pdfViewer.increaseScale(steps)},zoomOut(steps){this.pdfViewer.isInPresentationMode||this.pdfViewer.decreaseScale(steps)},zoomReset(){this.pdfViewer.isInPresentationMode||(this.pdfViewer.currentScaleValue=_ui_utils.DEFAULT_SCALE_VALUE)},get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0},get page(){return this.pdfViewer.currentPageNumber},set page(val){this.pdfViewer.currentPageNumber=val},get supportsPrinting(){return PDFPrintServiceFactory.instance.supportsPrinting},get supportsFullscreen(){return(0,_pdfjsLib.shadow)(this,"supportsFullscreen",document.fullscreenEnabled)},get supportsIntegratedFind(){return this.externalServices.supportsIntegratedFind},get supportsDocumentFonts(){return this.externalServices.supportsDocumentFonts},get loadingBar(){const bar=new _ui_utils.ProgressBar("#loadingBar");return(0,_pdfjsLib.shadow)(this,"loadingBar",bar)},get supportedMouseWheelZoomModifierKeys(){return this.externalServices.supportedMouseWheelZoomModifierKeys},initPassiveLoading(){throw new Error("Not implemented: initPassiveLoading")},setTitleUsingUrl(url="",downloadUrl=null){this.url=url,this.baseUrl=url.split("#")[0],downloadUrl&&(this._downloadUrl=downloadUrl===url?this.baseUrl:downloadUrl.split("#")[0]);let title=(0,_pdfjsLib.getPdfFilenameFromUrl)(url,"");if(!title)try{title=decodeURIComponent((0,_pdfjsLib.getFilenameFromUrl)(url))||url}catch(ex){title=url}this.setTitle(title)},setTitle(title){this.isViewerEmbedded||(document.title=title)},get _docFilename(){return this._contentDispositionFilename||(0,_pdfjsLib.getPdfFilenameFromUrl)(this.url)},_hideViewBookmark(){const{toolbar:toolbar,secondaryToolbar:secondaryToolbar}=this.appConfig;toolbar.viewBookmark.hidden=!0,secondaryToolbar.viewBookmarkButton.hidden=!0},_cancelIdleCallbacks(){if(this._idleCallbacks.size){for(const callback of this._idleCallbacks)window.cancelIdleCallback(callback);this._idleCallbacks.clear()}},async close(){this._unblockDocumentLoadEvent(),this._hideViewBookmark();const{container:container}=this.appConfig.errorWrapper;if(container.hidden=!0,!this.pdfLoadingTask)return;if(this.pdfDocument?.annotationStorage.size>0&&this._annotationStorageModified)try{await this.save({sourceEventType:"save"})}catch(reason){}const promises=[];promises.push(this.pdfLoadingTask.destroy()),this.pdfLoadingTask=null,this.pdfDocument&&(this.pdfDocument=null,this.pdfThumbnailViewer.setDocument(null),this.pdfViewer.setDocument(null),this.pdfLinkService.setDocument(null),this.pdfDocumentProperties.setDocument(null)),this.pdfLinkService.externalLinkEnabled=!0,this._fellback=!1,this.store=null,this.isInitialViewSet=!1,this.downloadComplete=!1,this.url="",this.baseUrl="",this._downloadUrl="",this.documentInfo=null,this.metadata=null,this._contentDispositionFilename=null,this._contentLength=null,this._saveInProgress=!1,this._docStats=null,this._cancelIdleCallbacks(),promises.push(this.pdfScriptingManager.destroyPromise),this.pdfSidebar.reset(),this.pdfOutlineViewer.reset(),this.pdfAttachmentViewer.reset(),this.pdfLayerViewer.reset(),this.pdfHistory?.reset(),this.findBar?.reset(),this.toolbar.reset(),this.secondaryToolbar.reset(),"undefined"!=typeof PDFBug&&PDFBug.cleanup(),await Promise.all(promises)},async open(file,args){this.pdfLoadingTask&&await this.close();const workerParameters=_app_options.AppOptions.getAll(_app_options.OptionKind.WORKER);for(const key in workerParameters)_pdfjsLib.GlobalWorkerOptions[key]=workerParameters[key];const parameters=Object.create(null);"string"==typeof file?(this.setTitleUsingUrl(file,file),parameters.url=file):file&&"byteLength"in file?parameters.data=file:file.url&&file.originalUrl&&(this.setTitleUsingUrl(file.originalUrl,file.url),parameters.url=file.url);const apiParameters=_app_options.AppOptions.getAll(_app_options.OptionKind.API);for(const key in apiParameters){let value=apiParameters[key];parameters[key]=value}if(args)for(const key in args)parameters[key]=args[key];const loadingTask=(0,_pdfjsLib.getDocument)(parameters);return this.pdfLoadingTask=loadingTask,loadingTask.onPassword=(updateCallback,reason)=>{this.pdfLinkService.externalLinkEnabled=!1,this.passwordPrompt.setUpdateCallback(updateCallback,reason),this.passwordPrompt.open()},loadingTask.onProgress=({loaded:loaded,total:total})=>{this.progress(loaded/total)},loadingTask.onUnsupportedFeature=this.fallback.bind(this),loadingTask.promise.then((pdfDocument=>{this.load(pdfDocument)}),(reason=>{if(loadingTask!==this.pdfLoadingTask)return;let key="loading_error";return reason instanceof _pdfjsLib.InvalidPDFException?key="invalid_file_error":reason instanceof _pdfjsLib.MissingPDFException?key="missing_file_error":reason instanceof _pdfjsLib.UnexpectedResponseException&&(key="unexpected_response_error"),this.l10n.get(key).then((msg=>{throw this._documentError(msg,{message:reason?.message}),reason}))}))},_ensureDownloadComplete(){if(!this.pdfDocument||!this.downloadComplete)throw new Error("PDF document not downloaded.")},async download({sourceEventType:sourceEventType="download"}={}){const url=this._downloadUrl,filename=this._docFilename;try{this._ensureDownloadComplete();const data=await this.pdfDocument.getData(),blob=new Blob([data],{type:"application/pdf"});await this.downloadManager.download(blob,url,filename,sourceEventType)}catch(reason){await this.downloadManager.downloadUrl(url,filename)}},async save({sourceEventType:sourceEventType="download"}={}){if(this._saveInProgress)return;this._saveInProgress=!0,await this.pdfScriptingManager.dispatchWillSave();const url=this._downloadUrl,filename=this._docFilename;try{this._ensureDownloadComplete();const data=await this.pdfDocument.saveDocument(),blob=new Blob([data],{type:"application/pdf"});await this.downloadManager.download(blob,url,filename,sourceEventType)}catch(reason){console.error(`Error when saving the document: ${reason.message}`),await this.download({sourceEventType:sourceEventType})}finally{await this.pdfScriptingManager.dispatchDidSave(),this._saveInProgress=!1}},downloadOrSave(options){this.pdfDocument?.annotationStorage.size>0?this.save(options):this.download(options)},fallback(featureId){this.externalServices.reportTelemetry({type:"unsupportedFeature",featureId:featureId}),this._fellback||(this._fellback=!0,this.externalServices.fallback({featureId:featureId,url:this.baseUrl}).then((download=>{download&&this.download({sourceEventType:"download"})})))},_documentError(message,moreInfo=null){this._unblockDocumentLoadEvent(),this._otherError(message,moreInfo),this.eventBus.dispatch("documenterror",{source:this,message:message,reason:moreInfo?.message??null})},_otherError(message,moreInfo=null){const moreInfoText=[this.l10n.get("error_version_info",{version:_pdfjsLib.version||"?",build:_pdfjsLib.build||"?"})];moreInfo&&(moreInfoText.push(this.l10n.get("error_message",{message:moreInfo.message})),moreInfo.stack?moreInfoText.push(this.l10n.get("error_stack",{stack:moreInfo.stack})):(moreInfo.filename&&moreInfoText.push(this.l10n.get("error_file",{file:moreInfo.filename})),moreInfo.lineNumber&&moreInfoText.push(this.l10n.get("error_line",{line:moreInfo.lineNumber}))));const errorWrapperConfig=this.appConfig.errorWrapper,errorWrapper=errorWrapperConfig.container;errorWrapper.hidden=!1;errorWrapperConfig.errorMessage.textContent=message;const closeButton=errorWrapperConfig.closeButton;closeButton.onclick=function(){errorWrapper.hidden=!0};const errorMoreInfo=errorWrapperConfig.errorMoreInfo,moreInfoButton=errorWrapperConfig.moreInfoButton,lessInfoButton=errorWrapperConfig.lessInfoButton;moreInfoButton.onclick=function(){errorMoreInfo.hidden=!1,moreInfoButton.hidden=!0,lessInfoButton.hidden=!1,errorMoreInfo.style.height=errorMoreInfo.scrollHeight+"px"},lessInfoButton.onclick=function(){errorMoreInfo.hidden=!0,moreInfoButton.hidden=!1,lessInfoButton.hidden=!0},moreInfoButton.oncontextmenu=_ui_utils.noContextMenuHandler,lessInfoButton.oncontextmenu=_ui_utils.noContextMenuHandler,closeButton.oncontextmenu=_ui_utils.noContextMenuHandler,moreInfoButton.hidden=!1,lessInfoButton.hidden=!0,Promise.all(moreInfoText).then((parts=>{errorMoreInfo.value=parts.join("\n")}))},progress(level){if(this.downloadComplete)return;const percent=Math.round(100*level);if(percent>this.loadingBar.percent||isNaN(percent)){this.loadingBar.percent=percent;(this.pdfDocument?this.pdfDocument.loadingParams.disableAutoFetch:_app_options.AppOptions.get("disableAutoFetch"))&&percent&&(this.disableAutoFetchLoadingBarTimeout&&(clearTimeout(this.disableAutoFetchLoadingBarTimeout),this.disableAutoFetchLoadingBarTimeout=null),this.loadingBar.show(),this.disableAutoFetchLoadingBarTimeout=setTimeout((()=>{this.loadingBar.hide(),this.disableAutoFetchLoadingBarTimeout=null}),5e3))}},load(pdfDocument){this.pdfDocument=pdfDocument,pdfDocument.getDownloadInfo().then((({length:length})=>{this._contentLength=length,this.downloadComplete=!0,this.loadingBar.hide(),firstPagePromise.then((()=>{this.eventBus.dispatch("documentloaded",{source:this})}))}));const pageLayoutPromise=pdfDocument.getPageLayout().catch((function(){})),pageModePromise=pdfDocument.getPageMode().catch((function(){})),openActionPromise=pdfDocument.getOpenAction().catch((function(){}));let baseDocumentUrl;this.toolbar.setPagesCount(pdfDocument.numPages,!1),this.secondaryToolbar.setPagesCount(pdfDocument.numPages),baseDocumentUrl=null,this.pdfLinkService.setDocument(pdfDocument,null),this.pdfDocumentProperties.setDocument(pdfDocument,this.url);const pdfViewer=this.pdfViewer;pdfViewer.setDocument(pdfDocument);const{firstPagePromise:firstPagePromise,onePageRendered:onePageRendered,pagesPromise:pagesPromise}=pdfViewer;this.pdfThumbnailViewer.setDocument(pdfDocument);const storedPromise=(this.store=new _view_history.ViewHistory(pdfDocument.fingerprints[0])).getMultiple({page:null,zoom:_ui_utils.DEFAULT_SCALE_VALUE,scrollLeft:"0",scrollTop:"0",rotation:null,sidebarView:_ui_utils.SidebarView.UNKNOWN,scrollMode:_ui_utils.ScrollMode.UNKNOWN,spreadMode:_ui_utils.SpreadMode.UNKNOWN}).catch((()=>Object.create(null)));firstPagePromise.then((pdfPage=>{this.loadingBar.setWidth(this.appConfig.viewerContainer),this._initializeAnnotationStorageCallbacks(pdfDocument),Promise.all([_ui_utils.animationStarted,storedPromise,pageLayoutPromise,pageModePromise,openActionPromise]).then((async([timeStamp,stored,pageLayout,pageMode,openAction])=>{const viewOnLoad=_app_options.AppOptions.get("viewOnLoad");this._initializePdfHistory({fingerprint:pdfDocument.fingerprints[0],viewOnLoad:viewOnLoad,initialDest:openAction?.dest});const initialBookmark=this.initialBookmark,zoom=_app_options.AppOptions.get("defaultZoomValue");let hash=zoom?`zoom=${zoom}`:null,rotation=null,sidebarView=_app_options.AppOptions.get("sidebarViewOnLoad"),scrollMode=_app_options.AppOptions.get("scrollModeOnLoad"),spreadMode=_app_options.AppOptions.get("spreadModeOnLoad");if(stored.page&&viewOnLoad!==ViewOnLoad_INITIAL&&(hash=`page=${stored.page}&zoom=${zoom||stored.zoom},${stored.scrollLeft},${stored.scrollTop}`,rotation=parseInt(stored.rotation,10),sidebarView===_ui_utils.SidebarView.UNKNOWN&&(sidebarView=0|stored.sidebarView),scrollMode===_ui_utils.ScrollMode.UNKNOWN&&(scrollMode=0|stored.scrollMode),spreadMode===_ui_utils.SpreadMode.UNKNOWN&&(spreadMode=0|stored.spreadMode)),pageMode&&sidebarView===_ui_utils.SidebarView.UNKNOWN&&(sidebarView=(0,_ui_utils.apiPageModeToSidebarView)(pageMode)),pageLayout&&scrollMode===_ui_utils.ScrollMode.UNKNOWN&&spreadMode===_ui_utils.SpreadMode.UNKNOWN){spreadMode=(0,_ui_utils.apiPageLayoutToViewerModes)(pageLayout).spreadMode}this.setInitialView(hash,{rotation:rotation,sidebarView:sidebarView,scrollMode:scrollMode,spreadMode:spreadMode}),this.eventBus.dispatch("documentinit",{source:this}),this.isViewerEmbedded||pdfViewer.focus(),await Promise.race([pagesPromise,new Promise((resolve=>{setTimeout(resolve,1e4)}))]),(initialBookmark||hash)&&(pdfViewer.hasEqualPageSizes||(this.initialBookmark=initialBookmark,pdfViewer.currentScaleValue=pdfViewer.currentScaleValue,this.setInitialView(hash)))})).catch((()=>{this.setInitialView()})).then((function(){pdfViewer.update()}))})),pagesPromise.then((()=>{this._unblockDocumentLoadEvent(),this._initializeAutoPrint(pdfDocument,openActionPromise)}),(reason=>{this.l10n.get("loading_error").then((msg=>{this._documentError(msg,{message:reason?.message})}))})),onePageRendered.then((data=>{if(this.externalServices.reportTelemetry({type:"pageInfo",timestamp:data.timestamp}),pdfDocument.getOutline().then((outline=>{pdfDocument===this.pdfDocument&&this.pdfOutlineViewer.render({outline:outline,pdfDocument:pdfDocument})})),pdfDocument.getAttachments().then((attachments=>{pdfDocument===this.pdfDocument&&this.pdfAttachmentViewer.render({attachments:attachments})})),pdfViewer.optionalContentConfigPromise.then((optionalContentConfig=>{pdfDocument===this.pdfDocument&&this.pdfLayerViewer.render({optionalContentConfig:optionalContentConfig,pdfDocument:pdfDocument})})),"requestIdleCallback"in window){const callback=window.requestIdleCallback((()=>{this._collectTelemetry(pdfDocument),this._idleCallbacks.delete(callback)}),{timeout:1e3});this._idleCallbacks.add(callback)}})),this._initializePageLabels(pdfDocument),this._initializeMetadata(pdfDocument)},async _scriptingDocProperties(pdfDocument){return(this.documentInfo||(await new Promise((resolve=>{this.eventBus._on("metadataloaded",resolve,{once:!0})})),pdfDocument===this.pdfDocument))&&(this._contentLength||(await new Promise((resolve=>{this.eventBus._on("documentloaded",resolve,{once:!0})})),pdfDocument===this.pdfDocument))?{...this.documentInfo,baseURL:this.baseUrl,filesize:this._contentLength,filename:this._docFilename,metadata:this.metadata?.getRaw(),authors:this.metadata?.get("dc:creator"),numPages:this.pagesCount,URL:this.url}:null},async _collectTelemetry(pdfDocument){const markInfo=await this.pdfDocument.getMarkInfo();if(pdfDocument!==this.pdfDocument)return;const tagged=markInfo?.Marked||!1;this.externalServices.reportTelemetry({type:"tagged",tagged:tagged})},async _initializeAutoPrint(pdfDocument,openActionPromise){const[openAction,javaScript]=await Promise.all([openActionPromise,this.pdfViewer.enableScripting?null:pdfDocument.getJavaScript()]);if(pdfDocument!==this.pdfDocument)return;let triggerAutoPrint=!1;if("Print"===openAction?.action&&(triggerAutoPrint=!0),javaScript&&(javaScript.some((js=>!!js&&(console.warn("Warning: JavaScript support is not enabled"),this.fallback(_pdfjsLib.UNSUPPORTED_FEATURES.javaScript),!0))),!triggerAutoPrint))for(const js of javaScript)if(js&&_ui_utils.AutoPrintRegExp.test(js)){triggerAutoPrint=!0;break}triggerAutoPrint&&this.triggerPrinting()},async _initializeMetadata(pdfDocument){const{info:info,metadata:metadata,contentDispositionFilename:contentDispositionFilename,contentLength:contentLength}=await pdfDocument.getMetadata();if(pdfDocument!==this.pdfDocument)return;this.documentInfo=info,this.metadata=metadata,this._contentDispositionFilename??=contentDispositionFilename,this._contentLength??=contentLength,console.log(`PDF ${pdfDocument.fingerprints[0]} [${info.PDFFormatVersion} ${(info.Producer||"-").trim()} / ${(info.Creator||"-").trim()}] (PDF.js: ${_pdfjsLib.version||"-"})`);let pdfTitle=info?.Title;const metadataTitle=metadata?.get("dc:title");metadataTitle&&("Untitled"===metadataTitle||/[\uFFF0-\uFFFF]/g.test(metadataTitle)||(pdfTitle=metadataTitle)),pdfTitle?this.setTitle(`${pdfTitle} - ${contentDispositionFilename||document.title}`):contentDispositionFilename&&this.setTitle(contentDispositionFilename),!info.IsXFAPresent||info.IsAcroFormPresent||pdfDocument.isPureXfa?!info.IsAcroFormPresent&&!info.IsXFAPresent||this.pdfViewer.renderForms||(console.warn("Warning: Interactive form support is not enabled"),this.fallback(_pdfjsLib.UNSUPPORTED_FEATURES.forms)):(pdfDocument.loadingParams.enableXfa?console.warn("Warning: XFA Foreground documents are not supported"):console.warn("Warning: XFA support is not enabled"),this.fallback(_pdfjsLib.UNSUPPORTED_FEATURES.forms)),info.IsSignaturesPresent&&(console.warn("Warning: Digital signatures validation is not supported"),this.fallback(_pdfjsLib.UNSUPPORTED_FEATURES.signatures));let versionId="other";KNOWN_VERSIONS.includes(info.PDFFormatVersion)&&(versionId=`v${info.PDFFormatVersion.replace(".","_")}`);let generatorId="other";if(info.Producer){const producer=info.Producer.toLowerCase();KNOWN_GENERATORS.some((function(generator){return!!producer.includes(generator)&&(generatorId=generator.replace(/[ .-]/g,"_"),!0)}))}let formType=null;info.IsXFAPresent?formType="xfa":info.IsAcroFormPresent&&(formType="acroform"),this.externalServices.reportTelemetry({type:"documentInfo",version:versionId,generator:generatorId,formType:formType}),this.eventBus.dispatch("metadataloaded",{source:this})},async _initializePageLabels(pdfDocument){const labels=await pdfDocument.getPageLabels();if(pdfDocument!==this.pdfDocument)return;if(!labels||_app_options.AppOptions.get("disablePageLabels"))return;const numLabels=labels.length;let standardLabels=0,emptyLabels=0;for(let i=0;i<numLabels;i++){const label=labels[i];if(label===(i+1).toString())standardLabels++;else{if(""!==label)break;emptyLabels++}}if(standardLabels>=numLabels||emptyLabels>=numLabels)return;const{pdfViewer:pdfViewer,pdfThumbnailViewer:pdfThumbnailViewer,toolbar:toolbar}=this;pdfViewer.setPageLabels(labels),pdfThumbnailViewer.setPageLabels(labels),toolbar.setPagesCount(numLabels,!0),toolbar.setPageNumber(pdfViewer.currentPageNumber,pdfViewer.currentPageLabel)},_initializePdfHistory({fingerprint:fingerprint,viewOnLoad:viewOnLoad,initialDest:initialDest=null}){this.pdfHistory&&(this.pdfHistory.initialize({fingerprint:fingerprint,resetHistory:viewOnLoad===ViewOnLoad_INITIAL,updateUrl:_app_options.AppOptions.get("historyUpdateUrl")}),this.pdfHistory.initialBookmark&&(this.initialBookmark=this.pdfHistory.initialBookmark,this.initialRotation=this.pdfHistory.initialRotation),initialDest&&!this.initialBookmark&&viewOnLoad===ViewOnLoad_UNKNOWN&&(this.initialBookmark=JSON.stringify(initialDest),this.pdfHistory.push({explicitDest:initialDest,pageNumber:null})))},_initializeAnnotationStorageCallbacks(pdfDocument){if(pdfDocument!==this.pdfDocument)return;const{annotationStorage:annotationStorage}=pdfDocument;annotationStorage.onSetModified=()=>{window.addEventListener("beforeunload",beforeUnload),this._annotationStorageModified=!0},annotationStorage.onResetModified=()=>{window.removeEventListener("beforeunload",beforeUnload),delete this._annotationStorageModified}},setInitialView(storedHash,{rotation:rotation,sidebarView:sidebarView,scrollMode:scrollMode,spreadMode:spreadMode}={}){const setRotation=angle=>{(0,_ui_utils.isValidRotation)(angle)&&(this.pdfViewer.pagesRotation=angle)};this.isInitialViewSet=!0,this.pdfSidebar.setInitialView(sidebarView),((scroll,spread)=>{(0,_ui_utils.isValidScrollMode)(scroll)&&(this.pdfViewer.scrollMode=scroll),(0,_ui_utils.isValidSpreadMode)(spread)&&(this.pdfViewer.spreadMode=spread)})(scrollMode,spreadMode),this.initialBookmark?(setRotation(this.initialRotation),delete this.initialRotation,this.pdfLinkService.setHash(this.initialBookmark),this.initialBookmark=null):storedHash&&(setRotation(rotation),this.pdfLinkService.setHash(storedHash)),this.toolbar.setPageNumber(this.pdfViewer.currentPageNumber,this.pdfViewer.currentPageLabel),this.secondaryToolbar.setPageNumber(this.pdfViewer.currentPageNumber),this.pdfViewer.currentScaleValue||(this.pdfViewer.currentScaleValue=_ui_utils.DEFAULT_SCALE_VALUE)},_cleanup(){this.pdfDocument&&(this.pdfViewer.cleanup(),this.pdfThumbnailViewer.cleanup(),this.pdfDocument.cleanup(this.pdfViewer.renderer===_ui_utils.RendererType.SVG))},forceRendering(){this.pdfRenderingQueue.printing=!!this.printService,this.pdfRenderingQueue.isThumbnailViewEnabled=this.pdfSidebar.isThumbnailViewVisible,this.pdfRenderingQueue.renderHighestPriority()},beforePrint(){if(this.pdfScriptingManager.dispatchWillPrint(),this.printService)return;if(!this.supportsPrinting)return void this.l10n.get("printing_not_supported").then((msg=>{this._otherError(msg)}));if(!this.pdfViewer.pageViewsReady)return void this.l10n.get("printing_not_ready").then((msg=>{window.alert(msg)}));const pagesOverview=this.pdfViewer.getPagesOverview(),printContainer=this.appConfig.printContainer,printResolution=_app_options.AppOptions.get("printResolution"),optionalContentConfigPromise=this.pdfViewer.optionalContentConfigPromise,printService=PDFPrintServiceFactory.instance.createPrintService(this.pdfDocument,pagesOverview,printContainer,printResolution,optionalContentConfigPromise,this.l10n);this.printService=printService,this.forceRendering(),printService.layout(),this.externalServices.reportTelemetry({type:"print"})},afterPrint(){this.pdfScriptingManager.dispatchDidPrint(),this.printService&&(this.printService.destroy(),this.printService=null,this.pdfDocument?.annotationStorage.resetModified()),this.forceRendering()},rotatePages(delta){this.pdfViewer.pagesRotation+=delta},requestPresentationMode(){this.pdfPresentationMode?.request()},triggerPrinting(){this.supportsPrinting&&window.print()},bindEvents(){const{eventBus:eventBus,_boundEvents:_boundEvents}=this;_boundEvents.beforePrint=this.beforePrint.bind(this),_boundEvents.afterPrint=this.afterPrint.bind(this),eventBus._on("resize",webViewerResize),eventBus._on("hashchange",webViewerHashchange),eventBus._on("beforeprint",_boundEvents.beforePrint),eventBus._on("afterprint",_boundEvents.afterPrint),eventBus._on("pagerendered",webViewerPageRendered),eventBus._on("updateviewarea",webViewerUpdateViewarea),eventBus._on("pagechanging",webViewerPageChanging),eventBus._on("scalechanging",webViewerScaleChanging),eventBus._on("rotationchanging",webViewerRotationChanging),eventBus._on("sidebarviewchanged",webViewerSidebarViewChanged),eventBus._on("pagemode",webViewerPageMode),eventBus._on("namedaction",webViewerNamedAction),eventBus._on("presentationmodechanged",webViewerPresentationModeChanged),eventBus._on("presentationmode",webViewerPresentationMode),eventBus._on("print",webViewerPrint),eventBus._on("download",webViewerDownload),eventBus._on("save",webViewerSave),eventBus._on("firstpage",webViewerFirstPage),eventBus._on("lastpage",webViewerLastPage),eventBus._on("nextpage",webViewerNextPage),eventBus._on("previouspage",webViewerPreviousPage),eventBus._on("zoomin",webViewerZoomIn),eventBus._on("zoomout",webViewerZoomOut),eventBus._on("zoomreset",webViewerZoomReset),eventBus._on("pagenumberchanged",webViewerPageNumberChanged),eventBus._on("scalechanged",webViewerScaleChanged),eventBus._on("rotatecw",webViewerRotateCw),eventBus._on("rotateccw",webViewerRotateCcw),eventBus._on("optionalcontentconfig",webViewerOptionalContentConfig),eventBus._on("switchscrollmode",webViewerSwitchScrollMode),eventBus._on("scrollmodechanged",webViewerScrollModeChanged),eventBus._on("switchspreadmode",webViewerSwitchSpreadMode),eventBus._on("spreadmodechanged",webViewerSpreadModeChanged),eventBus._on("documentproperties",webViewerDocumentProperties),eventBus._on("findfromurlhash",webViewerFindFromUrlHash),eventBus._on("updatefindmatchescount",webViewerUpdateFindMatchesCount),eventBus._on("updatefindcontrolstate",webViewerUpdateFindControlState),_app_options.AppOptions.get("pdfBug")&&(_boundEvents.reportPageStatsPDFBug=reportPageStatsPDFBug,eventBus._on("pagerendered",_boundEvents.reportPageStatsPDFBug),eventBus._on("pagechanging",_boundEvents.reportPageStatsPDFBug)),eventBus._on("fileinputchange",webViewerFileInputChange),eventBus._on("openfile",webViewerOpenFile)},bindWindowEvents(){const{eventBus:eventBus,_boundEvents:_boundEvents}=this;_boundEvents.windowResize=()=>{eventBus.dispatch("resize",{source:window})},_boundEvents.windowHashChange=()=>{eventBus.dispatch("hashchange",{source:window,hash:document.location.hash.substring(1)})},_boundEvents.windowBeforePrint=()=>{eventBus.dispatch("beforeprint",{source:window})},_boundEvents.windowAfterPrint=()=>{eventBus.dispatch("afterprint",{source:window})},_boundEvents.windowUpdateFromSandbox=event=>{eventBus.dispatch("updatefromsandbox",{source:window,detail:event.detail})},window.addEventListener("visibilitychange",webViewerVisibilityChange),window.addEventListener("wheel",webViewerWheel,{passive:!1}),window.addEventListener("touchstart",webViewerTouchStart,{passive:!1}),window.addEventListener("click",webViewerClick),window.addEventListener("keydown",webViewerKeyDown),window.addEventListener("resize",_boundEvents.windowResize),window.addEventListener("hashchange",_boundEvents.windowHashChange),window.addEventListener("beforeprint",_boundEvents.windowBeforePrint),window.addEventListener("afterprint",_boundEvents.windowAfterPrint),window.addEventListener("updatefromsandbox",_boundEvents.windowUpdateFromSandbox)},unbindEvents(){const{eventBus:eventBus,_boundEvents:_boundEvents}=this;eventBus._off("resize",webViewerResize),eventBus._off("hashchange",webViewerHashchange),eventBus._off("beforeprint",_boundEvents.beforePrint),eventBus._off("afterprint",_boundEvents.afterPrint),eventBus._off("pagerendered",webViewerPageRendered),eventBus._off("updateviewarea",webViewerUpdateViewarea),eventBus._off("pagechanging",webViewerPageChanging),eventBus._off("scalechanging",webViewerScaleChanging),eventBus._off("rotationchanging",webViewerRotationChanging),eventBus._off("sidebarviewchanged",webViewerSidebarViewChanged),eventBus._off("pagemode",webViewerPageMode),eventBus._off("namedaction",webViewerNamedAction),eventBus._off("presentationmodechanged",webViewerPresentationModeChanged),eventBus._off("presentationmode",webViewerPresentationMode),eventBus._off("print",webViewerPrint),eventBus._off("download",webViewerDownload),eventBus._off("save",webViewerSave),eventBus._off("firstpage",webViewerFirstPage),eventBus._off("lastpage",webViewerLastPage),eventBus._off("nextpage",webViewerNextPage),eventBus._off("previouspage",webViewerPreviousPage),eventBus._off("zoomin",webViewerZoomIn),eventBus._off("zoomout",webViewerZoomOut),eventBus._off("zoomreset",webViewerZoomReset),eventBus._off("pagenumberchanged",webViewerPageNumberChanged),eventBus._off("scalechanged",webViewerScaleChanged),eventBus._off("rotatecw",webViewerRotateCw),eventBus._off("rotateccw",webViewerRotateCcw),eventBus._off("optionalcontentconfig",webViewerOptionalContentConfig),eventBus._off("switchscrollmode",webViewerSwitchScrollMode),eventBus._off("scrollmodechanged",webViewerScrollModeChanged),eventBus._off("switchspreadmode",webViewerSwitchSpreadMode),eventBus._off("spreadmodechanged",webViewerSpreadModeChanged),eventBus._off("documentproperties",webViewerDocumentProperties),eventBus._off("findfromurlhash",webViewerFindFromUrlHash),eventBus._off("updatefindmatchescount",webViewerUpdateFindMatchesCount),eventBus._off("updatefindcontrolstate",webViewerUpdateFindControlState),_boundEvents.reportPageStatsPDFBug&&(eventBus._off("pagerendered",_boundEvents.reportPageStatsPDFBug),eventBus._off("pagechanging",_boundEvents.reportPageStatsPDFBug),_boundEvents.reportPageStatsPDFBug=null),eventBus._off("fileinputchange",webViewerFileInputChange),eventBus._off("openfile",webViewerOpenFile),_boundEvents.beforePrint=null,_boundEvents.afterPrint=null},unbindWindowEvents(){const{_boundEvents:_boundEvents}=this;window.removeEventListener("visibilitychange",webViewerVisibilityChange),window.removeEventListener("wheel",webViewerWheel,{passive:!1}),window.removeEventListener("touchstart",webViewerTouchStart,{passive:!1}),window.removeEventListener("click",webViewerClick),window.removeEventListener("keydown",webViewerKeyDown),window.removeEventListener("resize",_boundEvents.windowResize),window.removeEventListener("hashchange",_boundEvents.windowHashChange),window.removeEventListener("beforeprint",_boundEvents.windowBeforePrint),window.removeEventListener("afterprint",_boundEvents.windowAfterPrint),window.removeEventListener("updatefromsandbox",_boundEvents.windowUpdateFromSandbox),_boundEvents.windowResize=null,_boundEvents.windowHashChange=null,_boundEvents.windowBeforePrint=null,_boundEvents.windowAfterPrint=null,_boundEvents.windowUpdateFromSandbox=null},accumulateWheelTicks(ticks){(this._wheelUnusedTicks>0&&ticks<0||this._wheelUnusedTicks<0&&ticks>0)&&(this._wheelUnusedTicks=0),this._wheelUnusedTicks+=ticks;const wholeTicks=Math.sign(this._wheelUnusedTicks)*Math.floor(Math.abs(this._wheelUnusedTicks));return this._wheelUnusedTicks-=wholeTicks,wholeTicks},_unblockDocumentLoadEvent(){document.blockUnblockOnload&&document.blockUnblockOnload(!1),this._unblockDocumentLoadEvent=()=>{}},_reportDocumentStatsTelemetry(){const{stats:stats}=this.pdfDocument;stats!==this._docStats&&(this._docStats=stats,this.externalServices.reportTelemetry({type:"documentStats",stats:stats}))},get scriptingReady(){return this.pdfScriptingManager.ready}};let validateFileURL,webViewerFileInputChange,webViewerOpenFile;exports.PDFViewerApplication=PDFViewerApplication;{const HOSTED_VIEWER_ORIGINS=["null","http://mozilla.github.io","https://mozilla.github.io"];validateFileURL=function(file){if(void 0!==file)try{const viewerOrigin=new URL(window.location.href).origin||"null";if(HOSTED_VIEWER_ORIGINS.includes(viewerOrigin))return;if(new URL(file,window.location.href).origin!==viewerOrigin)throw new Error("file origin does not match viewer's")}catch(ex){throw PDFViewerApplication.l10n.get("loading_error").then((msg=>{PDFViewerApplication._documentError(msg,{message:ex?.message})})),ex}}}function reportPageStatsPDFBug({pageNumber:pageNumber}){if("undefined"==typeof Stats||!Stats.enabled)return;const pageStats=PDFViewerApplication.pdfViewer.getPageView(pageNumber-1)?.pdfPage?.stats;pageStats&&Stats.add(pageNumber,pageStats)}function webViewerInitialized(){const appConfig=PDFViewerApplication.appConfig;let file;const queryString=document.location.search.substring(1);file=(0,_ui_utils.parseQueryString)(queryString).get("file")??_app_options.AppOptions.get("defaultUrl"),validateFileURL(file);const fileInput=document.createElement("input");fileInput.id=appConfig.openFileInputName,fileInput.className="fileInput",fileInput.setAttribute("type","file"),fileInput.oncontextmenu=_ui_utils.noContextMenuHandler,document.body.appendChild(fileInput),window.File&&window.FileReader&&window.FileList&&window.Blob?fileInput.value=null:(appConfig.toolbar.openFile.hidden=!0,appConfig.secondaryToolbar.openFileButton.hidden=!0),fileInput.addEventListener("change",(function(evt){const files=evt.target.files;files&&0!==files.length&&PDFViewerApplication.eventBus.dispatch("fileinputchange",{source:this,fileInput:evt.target})})),appConfig.mainContainer.addEventListener("dragover",(function(evt){evt.preventDefault(),evt.dataTransfer.dropEffect="move"})),appConfig.mainContainer.addEventListener("drop",(function(evt){evt.preventDefault();const files=evt.dataTransfer.files;files&&0!==files.length&&PDFViewerApplication.eventBus.dispatch("fileinputchange",{source:this,fileInput:evt.dataTransfer})})),PDFViewerApplication.supportsDocumentFonts||(_app_options.AppOptions.set("disableFontFace",!0),PDFViewerApplication.l10n.get("web_fonts_disabled").then((msg=>{console.warn(msg)}))),PDFViewerApplication.supportsPrinting||(appConfig.toolbar.print.classList.add("hidden"),appConfig.secondaryToolbar.printButton.classList.add("hidden")),PDFViewerApplication.supportsFullscreen||(appConfig.toolbar.presentationModeButton.classList.add("hidden"),appConfig.secondaryToolbar.presentationModeButton.classList.add("hidden")),PDFViewerApplication.supportsIntegratedFind&&appConfig.toolbar.viewFind.classList.add("hidden"),appConfig.mainContainer.addEventListener("transitionend",(function(evt){evt.target===this&&PDFViewerApplication.eventBus.dispatch("resize",{source:this})}),!0);try{!function(file){file?PDFViewerApplication.open(file):PDFViewerApplication._hideViewBookmark()}(file)}catch(reason){PDFViewerApplication.l10n.get("loading_error").then((msg=>{PDFViewerApplication._documentError(msg,reason)}))}}function webViewerPageRendered({pageNumber:pageNumber,error:error}){if(pageNumber===PDFViewerApplication.page&&PDFViewerApplication.toolbar.updateLoadingIndicatorState(!1),PDFViewerApplication.pdfSidebar.isThumbnailViewVisible){const pageView=PDFViewerApplication.pdfViewer.getPageView(pageNumber-1),thumbnailView=PDFViewerApplication.pdfThumbnailViewer.getThumbnail(pageNumber-1);pageView&&thumbnailView&&thumbnailView.setImage(pageView)}error&&PDFViewerApplication.l10n.get("rendering_error").then((msg=>{PDFViewerApplication._otherError(msg,error)})),PDFViewerApplication._reportDocumentStatsTelemetry()}function webViewerPageMode({mode:mode}){let view;switch(mode){case"thumbs":view=_ui_utils.SidebarView.THUMBS;break;case"bookmarks":case"outline":view=_ui_utils.SidebarView.OUTLINE;break;case"attachments":view=_ui_utils.SidebarView.ATTACHMENTS;break;case"layers":view=_ui_utils.SidebarView.LAYERS;break;case"none":view=_ui_utils.SidebarView.NONE;break;default:return void console.error('Invalid "pagemode" hash parameter: '+mode)}PDFViewerApplication.pdfSidebar.switchView(view,!0)}function webViewerNamedAction(evt){switch(evt.action){case"GoToPage":PDFViewerApplication.appConfig.toolbar.pageNumber.select();break;case"Find":PDFViewerApplication.supportsIntegratedFind||PDFViewerApplication.findBar.toggle();break;case"Print":PDFViewerApplication.triggerPrinting();break;case"SaveAs":webViewerSave()}}function webViewerPresentationModeChanged(evt){PDFViewerApplication.pdfViewer.presentationModeState=evt.state}function webViewerSidebarViewChanged(evt){PDFViewerApplication.pdfRenderingQueue.isThumbnailViewEnabled=PDFViewerApplication.pdfSidebar.isThumbnailViewVisible,PDFViewerApplication.isInitialViewSet&&PDFViewerApplication.store?.set("sidebarView",evt.view).catch((()=>{}))}function webViewerUpdateViewarea(evt){const location=evt.location;PDFViewerApplication.isInitialViewSet&&PDFViewerApplication.store?.setMultiple({page:location.pageNumber,zoom:location.scale,scrollLeft:location.left,scrollTop:location.top,rotation:location.rotation}).catch((()=>{}));const href=PDFViewerApplication.pdfLinkService.getAnchorUrl(location.pdfOpenParams);PDFViewerApplication.appConfig.toolbar.viewBookmark.href=href,PDFViewerApplication.appConfig.secondaryToolbar.viewBookmarkButton.href=href;const loading=PDFViewerApplication.pdfViewer.getPageView(PDFViewerApplication.page-1)?.renderingState!==_ui_utils.RenderingStates.FINISHED;PDFViewerApplication.toolbar.updateLoadingIndicatorState(loading)}function webViewerScrollModeChanged(evt){PDFViewerApplication.isInitialViewSet&&PDFViewerApplication.store?.set("scrollMode",evt.mode).catch((()=>{}))}function webViewerSpreadModeChanged(evt){PDFViewerApplication.isInitialViewSet&&PDFViewerApplication.store?.set("spreadMode",evt.mode).catch((()=>{}))}function webViewerResize(){const{pdfDocument:pdfDocument,pdfViewer:pdfViewer}=PDFViewerApplication;if(!pdfDocument)return;const currentScaleValue=pdfViewer.currentScaleValue;"auto"!==currentScaleValue&&"page-fit"!==currentScaleValue&&"page-width"!==currentScaleValue||(pdfViewer.currentScaleValue=currentScaleValue),pdfViewer.update()}function webViewerHashchange(evt){const hash=evt.hash;hash&&(PDFViewerApplication.isInitialViewSet?PDFViewerApplication.pdfHistory?.popStateInProgress||PDFViewerApplication.pdfLinkService.setHash(hash):PDFViewerApplication.initialBookmark=hash)}function webViewerPresentationMode(){PDFViewerApplication.requestPresentationMode()}function webViewerPrint(){PDFViewerApplication.triggerPrinting()}function webViewerDownload(){PDFViewerApplication.downloadOrSave({sourceEventType:"download"})}function webViewerSave(){PDFViewerApplication.downloadOrSave({sourceEventType:"save"})}function webViewerFirstPage(){PDFViewerApplication.pdfDocument&&(PDFViewerApplication.page=1)}function webViewerLastPage(){PDFViewerApplication.pdfDocument&&(PDFViewerApplication.page=PDFViewerApplication.pagesCount)}function webViewerNextPage(){PDFViewerApplication.pdfViewer.nextPage()}function webViewerPreviousPage(){PDFViewerApplication.pdfViewer.previousPage()}function webViewerZoomIn(){PDFViewerApplication.zoomIn()}function webViewerZoomOut(){PDFViewerApplication.zoomOut()}function webViewerZoomReset(){PDFViewerApplication.zoomReset()}function webViewerPageNumberChanged(evt){const pdfViewer=PDFViewerApplication.pdfViewer;""!==evt.value&&PDFViewerApplication.pdfLinkService.goToPage(evt.value),evt.value!==pdfViewer.currentPageNumber.toString()&&evt.value!==pdfViewer.currentPageLabel&&PDFViewerApplication.toolbar.setPageNumber(pdfViewer.currentPageNumber,pdfViewer.currentPageLabel)}function webViewerScaleChanged(evt){PDFViewerApplication.pdfViewer.currentScaleValue=evt.value}function webViewerRotateCw(){PDFViewerApplication.rotatePages(90)}function webViewerRotateCcw(){PDFViewerApplication.rotatePages(-90)}function webViewerOptionalContentConfig(evt){PDFViewerApplication.pdfViewer.optionalContentConfigPromise=evt.promise}function webViewerSwitchScrollMode(evt){PDFViewerApplication.pdfViewer.scrollMode=evt.mode}function webViewerSwitchSpreadMode(evt){PDFViewerApplication.pdfViewer.spreadMode=evt.mode}function webViewerDocumentProperties(){PDFViewerApplication.pdfDocumentProperties.open()}function webViewerFindFromUrlHash(evt){PDFViewerApplication.eventBus.dispatch("find",{source:evt.source,type:"",query:evt.query,phraseSearch:evt.phraseSearch,caseSensitive:!1,entireWord:!1,highlightAll:!0,findPrevious:!1,matchDiacritics:!0})}function webViewerUpdateFindMatchesCount({matchesCount:matchesCount}){PDFViewerApplication.supportsIntegratedFind?PDFViewerApplication.externalServices.updateFindMatchesCount(matchesCount):PDFViewerApplication.findBar.updateResultsCount(matchesCount)}function webViewerUpdateFindControlState({state:state,previous:previous,matchesCount:matchesCount,rawQuery:rawQuery}){PDFViewerApplication.supportsIntegratedFind?PDFViewerApplication.externalServices.updateFindControlState({result:state,findPrevious:previous,matchesCount:matchesCount,rawQuery:rawQuery}):PDFViewerApplication.findBar.updateUIState(state,previous,matchesCount)}function webViewerScaleChanging(evt){PDFViewerApplication.toolbar.setPageScale(evt.presetValue,evt.scale),PDFViewerApplication.pdfViewer.update()}function webViewerRotationChanging(evt){PDFViewerApplication.pdfThumbnailViewer.pagesRotation=evt.pagesRotation,PDFViewerApplication.forceRendering(),PDFViewerApplication.pdfViewer.currentPageNumber=evt.pageNumber}function webViewerPageChanging({pageNumber:pageNumber,pageLabel:pageLabel}){PDFViewerApplication.toolbar.setPageNumber(pageNumber,pageLabel),PDFViewerApplication.secondaryToolbar.setPageNumber(pageNumber),PDFViewerApplication.pdfSidebar.isThumbnailViewVisible&&PDFViewerApplication.pdfThumbnailViewer.scrollThumbnailIntoView(pageNumber)}function webViewerVisibilityChange(evt){"visible"===document.visibilityState&&setZoomDisabledTimeout()}webViewerFileInputChange=function(evt){if(PDFViewerApplication.pdfViewer?.isInPresentationMode)return;const file=evt.fileInput.files[0];let url=URL.createObjectURL(file);file.name&&(url={url:url,originalUrl:file.name}),PDFViewerApplication.open(url)},webViewerOpenFile=function(evt){const openFileInputName=PDFViewerApplication.appConfig.openFileInputName;document.getElementById(openFileInputName).click()};let zoomDisabledTimeout=null;function setZoomDisabledTimeout(){zoomDisabledTimeout&&clearTimeout(zoomDisabledTimeout),zoomDisabledTimeout=setTimeout((function(){zoomDisabledTimeout=null}),1e3)}function webViewerWheel(evt){const{pdfViewer:pdfViewer,supportedMouseWheelZoomModifierKeys:supportedMouseWheelZoomModifierKeys}=PDFViewerApplication;if(!pdfViewer.isInPresentationMode)if(evt.ctrlKey&&supportedMouseWheelZoomModifierKeys.ctrlKey||evt.metaKey&&supportedMouseWheelZoomModifierKeys.metaKey){if(evt.preventDefault(),zoomDisabledTimeout||"hidden"===document.visibilityState)return;const deltaMode=evt.deltaMode,delta=(0,_ui_utils.normalizeWheelEventDirection)(evt),previousScale=pdfViewer.currentScale;let ticks=0;if(deltaMode===WheelEvent.DOM_DELTA_LINE||deltaMode===WheelEvent.DOM_DELTA_PAGE)ticks=Math.abs(delta)>=1?Math.sign(delta):PDFViewerApplication.accumulateWheelTicks(delta);else{const PIXELS_PER_LINE_SCALE=30;ticks=PDFViewerApplication.accumulateWheelTicks(delta/PIXELS_PER_LINE_SCALE)}ticks<0?PDFViewerApplication.zoomOut(-ticks):ticks>0&&PDFViewerApplication.zoomIn(ticks);const currentScale=pdfViewer.currentScale;if(previousScale!==currentScale){const scaleCorrectionFactor=currentScale/previousScale-1,rect=pdfViewer.container.getBoundingClientRect(),dx=evt.clientX-rect.left,dy=evt.clientY-rect.top;pdfViewer.container.scrollLeft+=dx*scaleCorrectionFactor,pdfViewer.container.scrollTop+=dy*scaleCorrectionFactor}}else setZoomDisabledTimeout()}function webViewerTouchStart(evt){evt.touches.length>1&&evt.preventDefault()}function webViewerClick(evt){if(!PDFViewerApplication.secondaryToolbar.isOpen)return;const appConfig=PDFViewerApplication.appConfig;(PDFViewerApplication.pdfViewer.containsElement(evt.target)||appConfig.toolbar.container.contains(evt.target)&&evt.target!==appConfig.secondaryToolbar.toggleButton)&&PDFViewerApplication.secondaryToolbar.close()}function webViewerKeyDown(evt){if(PDFViewerApplication.overlayManager.active)return;const{eventBus:eventBus,pdfViewer:pdfViewer}=PDFViewerApplication,isViewerInPresentationMode=pdfViewer.isInPresentationMode;let handled=!1,ensureViewerFocused=!1;const cmd=(evt.ctrlKey?1:0)|(evt.altKey?2:0)|(evt.shiftKey?4:0)|(evt.metaKey?8:0);if(1===cmd||8===cmd||5===cmd||12===cmd)switch(evt.keyCode){case 70:PDFViewerApplication.supportsIntegratedFind||evt.shiftKey||(PDFViewerApplication.findBar.open(),handled=!0);break;case 71:if(!PDFViewerApplication.supportsIntegratedFind){const{state:state}=PDFViewerApplication.findController;if(state){const eventState=Object.assign(Object.create(null),state,{source:window,type:"again",findPrevious:5===cmd||12===cmd});eventBus.dispatch("find",eventState)}handled=!0}break;case 61:case 107:case 187:case 171:isViewerInPresentationMode||PDFViewerApplication.zoomIn(),handled=!0;break;case 173:case 109:case 189:isViewerInPresentationMode||PDFViewerApplication.zoomOut(),handled=!0;break;case 48:case 96:isViewerInPresentationMode||(setTimeout((function(){PDFViewerApplication.zoomReset()})),handled=!1);break;case 38:(isViewerInPresentationMode||PDFViewerApplication.page>1)&&(PDFViewerApplication.page=1,handled=!0,ensureViewerFocused=!0);break;case 40:(isViewerInPresentationMode||PDFViewerApplication.page<PDFViewerApplication.pagesCount)&&(PDFViewerApplication.page=PDFViewerApplication.pagesCount,handled=!0,ensureViewerFocused=!0)}if(1===cmd||8===cmd)switch(evt.keyCode){case 83:eventBus.dispatch("download",{source:window}),handled=!0;break;case 79:eventBus.dispatch("openfile",{source:window}),handled=!0}if(3===cmd||10===cmd)switch(evt.keyCode){case 80:PDFViewerApplication.requestPresentationMode(),handled=!0;break;case 71:PDFViewerApplication.appConfig.toolbar.pageNumber.select(),handled=!0}if(handled)return ensureViewerFocused&&!isViewerInPresentationMode&&pdfViewer.focus(),void evt.preventDefault();const curElement=(0,_ui_utils.getActiveOrFocusedElement)(),curElementTagName=curElement?.tagName.toUpperCase();if("INPUT"!==curElementTagName&&"TEXTAREA"!==curElementTagName&&"SELECT"!==curElementTagName&&!curElement?.isContentEditable||27===evt.keyCode){if(0===cmd){let turnPage=0,turnOnlyIfPageFit=!1;switch(evt.keyCode){case 38:case 33:pdfViewer.isVerticalScrollbarEnabled&&(turnOnlyIfPageFit=!0),turnPage=-1;break;case 8:isViewerInPresentationMode||(turnOnlyIfPageFit=!0),turnPage=-1;break;case 37:pdfViewer.isHorizontalScrollbarEnabled&&(turnOnlyIfPageFit=!0);case 75:case 80:turnPage=-1;break;case 27:PDFViewerApplication.secondaryToolbar.isOpen&&(PDFViewerApplication.secondaryToolbar.close(),handled=!0),!PDFViewerApplication.supportsIntegratedFind&&PDFViewerApplication.findBar.opened&&(PDFViewerApplication.findBar.close(),handled=!0);break;case 40:case 34:pdfViewer.isVerticalScrollbarEnabled&&(turnOnlyIfPageFit=!0),turnPage=1;break;case 13:case 32:isViewerInPresentationMode||(turnOnlyIfPageFit=!0),turnPage=1;break;case 39:pdfViewer.isHorizontalScrollbarEnabled&&(turnOnlyIfPageFit=!0);case 74:case 78:turnPage=1;break;case 36:(isViewerInPresentationMode||PDFViewerApplication.page>1)&&(PDFViewerApplication.page=1,handled=!0,ensureViewerFocused=!0);break;case 35:(isViewerInPresentationMode||PDFViewerApplication.page<PDFViewerApplication.pagesCount)&&(PDFViewerApplication.page=PDFViewerApplication.pagesCount,handled=!0,ensureViewerFocused=!0);break;case 83:PDFViewerApplication.pdfCursorTools.switchTool(_pdf_cursor_tools.CursorTool.SELECT);break;case 72:PDFViewerApplication.pdfCursorTools.switchTool(_pdf_cursor_tools.CursorTool.HAND);break;case 82:PDFViewerApplication.rotatePages(90);break;case 115:PDFViewerApplication.pdfSidebar.toggle()}0===turnPage||turnOnlyIfPageFit&&"page-fit"!==pdfViewer.currentScaleValue||(turnPage>0?pdfViewer.nextPage():pdfViewer.previousPage(),handled=!0)}if(4===cmd)switch(evt.keyCode){case 13:case 32:if(!isViewerInPresentationMode&&"page-fit"!==pdfViewer.currentScaleValue)break;pdfViewer.previousPage(),handled=!0;break;case 82:PDFViewerApplication.rotatePages(-90)}handled||isViewerInPresentationMode||(evt.keyCode>=33&&evt.keyCode<=40||32===evt.keyCode&&"BUTTON"!==curElementTagName)&&(ensureViewerFocused=!0),ensureViewerFocused&&!pdfViewer.containsElement(curElement)&&pdfViewer.focus(),handled&&evt.preventDefault()}}function beforeUnload(evt){return evt.preventDefault(),evt.returnValue="",!1}const PDFPrintServiceFactory={instance:{supportsPrinting:!1,createPrintService(){throw new Error("Not implemented: createPrintService")}}};exports.PDFPrintServiceFactory=PDFPrintServiceFactory},(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.animationStarted=exports.VERTICAL_PADDING=exports.UNKNOWN_SCALE=exports.TextLayerMode=exports.SpreadMode=exports.SidebarView=exports.ScrollMode=exports.SCROLLBAR_PADDING=exports.RenderingStates=exports.RendererType=exports.ProgressBar=exports.PresentationModeState=exports.OutputScale=exports.MIN_SCALE=exports.MAX_SCALE=exports.MAX_AUTO_SCALE=exports.DEFAULT_SCALE_VALUE=exports.DEFAULT_SCALE_DELTA=exports.DEFAULT_SCALE=exports.AutoPrintRegExp=void 0,exports.apiPageLayoutToViewerModes=function(layout){let scrollMode=ScrollMode.VERTICAL,spreadMode=SpreadMode.NONE;switch(layout){case"SinglePage":scrollMode=ScrollMode.PAGE;break;case"OneColumn":break;case"TwoPageLeft":scrollMode=ScrollMode.PAGE;case"TwoColumnLeft":spreadMode=SpreadMode.ODD;break;case"TwoPageRight":scrollMode=ScrollMode.PAGE;case"TwoColumnRight":spreadMode=SpreadMode.EVEN}return{scrollMode:scrollMode,spreadMode:spreadMode}},exports.apiPageModeToSidebarView=function(mode){switch(mode){case"UseNone":return SidebarView.NONE;case"UseThumbs":return SidebarView.THUMBS;case"UseOutlines":return SidebarView.OUTLINE;case"UseAttachments":return SidebarView.ATTACHMENTS;case"UseOC":return SidebarView.LAYERS}return SidebarView.NONE},exports.approximateFraction=function(x){if(Math.floor(x)===x)return[x,1];const xinv=1/x;if(xinv>8)return[1,8];if(Math.floor(xinv)===xinv)return[1,xinv];const x_=x>1?xinv:x;let result,a=0,b=1,c=1,d=1;for(;;){const p=a+c,q=b+d;if(q>8)break;x_<=p/q?(c=p,d=q):(a=p,b=q)}result=x_-a/b<c/d-x_?x_===x?[a,b]:[b,a]:x_===x?[c,d]:[d,c];return result},exports.backtrackBeforeAllVisibleElements=backtrackBeforeAllVisibleElements,exports.binarySearchFirstItem=binarySearchFirstItem,exports.getActiveOrFocusedElement=function(){let curRoot=document,curActiveOrFocused=curRoot.activeElement||curRoot.querySelector(":focus");for(;curActiveOrFocused?.shadowRoot;)curRoot=curActiveOrFocused.shadowRoot,curActiveOrFocused=curRoot.activeElement||curRoot.querySelector(":focus");return curActiveOrFocused},exports.getPageSizeInches=function({view:view,userUnit:userUnit,rotate:rotate}){const[x1,y1,x2,y2]=view,changeOrientation=rotate%180!=0,width=(x2-x1)/72*userUnit,height=(y2-y1)/72*userUnit;return{width:changeOrientation?height:width,height:changeOrientation?width:height}},exports.getVisibleElements=function({scrollEl:scrollEl,views:views,sortByVisibility:sortByVisibility=!1,horizontal:horizontal=!1,rtl:rtl=!1}){const top=scrollEl.scrollTop,bottom=top+scrollEl.clientHeight,left=scrollEl.scrollLeft,right=left+scrollEl.clientWidth;const visible=[],ids=new Set,numViews=views.length;let firstVisibleElementInd=binarySearchFirstItem(views,horizontal?function(view){const element=view.div,elementLeft=element.offsetLeft+element.clientLeft,elementRight=elementLeft+element.clientWidth;return rtl?elementLeft<right:elementRight>left}:function(view){const element=view.div;return element.offsetTop+element.clientTop+element.clientHeight>top});firstVisibleElementInd>0&&firstVisibleElementInd<numViews&&!horizontal&&(firstVisibleElementInd=backtrackBeforeAllVisibleElements(firstVisibleElementInd,views,top));let lastEdge=horizontal?right:-1;for(let i=firstVisibleElementInd;i<numViews;i++){const view=views[i],element=view.div,currentWidth=element.offsetLeft+element.clientLeft,currentHeight=element.offsetTop+element.clientTop,viewWidth=element.clientWidth,viewHeight=element.clientHeight,viewRight=currentWidth+viewWidth,viewBottom=currentHeight+viewHeight;if(-1===lastEdge)viewBottom>=bottom&&(lastEdge=viewBottom);else if((horizontal?currentWidth:currentHeight)>lastEdge)break;if(viewBottom<=top||currentHeight>=bottom||viewRight<=left||currentWidth>=right)continue;const hiddenHeight=Math.max(0,top-currentHeight)+Math.max(0,viewBottom-bottom),hiddenWidth=Math.max(0,left-currentWidth)+Math.max(0,viewRight-right),fractionWidth=(viewWidth-hiddenWidth)/viewWidth,percent=(viewHeight-hiddenHeight)/viewHeight*fractionWidth*100|0;visible.push({id:view.id,x:currentWidth,y:currentHeight,view:view,percent:percent,widthPercent:100*fractionWidth|0}),ids.add(view.id)}const first=visible[0],last=visible[visible.length-1];sortByVisibility&&visible.sort((function(a,b){const pc=a.percent-b.percent;return Math.abs(pc)>.001?-pc:a.id-b.id}));return{first:first,last:last,views:visible,ids:ids}},exports.isPortraitOrientation=function(size){return size.width<=size.height},exports.isValidRotation=function(angle){return Number.isInteger(angle)&&angle%90==0},exports.isValidScrollMode=function(mode){return Number.isInteger(mode)&&Object.values(ScrollMode).includes(mode)&&mode!==ScrollMode.UNKNOWN},exports.isValidSpreadMode=function(mode){return Number.isInteger(mode)&&Object.values(SpreadMode).includes(mode)&&mode!==SpreadMode.UNKNOWN},exports.noContextMenuHandler=function(evt){evt.preventDefault()},exports.normalizeWheelEventDelta=function(evt){let delta=normalizeWheelEventDirection(evt);0===evt.deltaMode?delta/=900:1===evt.deltaMode&&(delta/=30);return delta},exports.normalizeWheelEventDirection=normalizeWheelEventDirection,exports.parseQueryString=function(query){const params=new Map;for(const[key,value]of new URLSearchParams(query))params.set(key.toLowerCase(),value);return params},exports.removeNullCharacters=function(str,replaceInvisible=!1){if("string"!=typeof str)return console.error("The argument must be a string."),str;replaceInvisible&&(str=str.replace(InvisibleCharactersRegExp," "));return str.replace(NullCharactersRegExp,"")},exports.roundToDivide=function(x,div){const r=x%div;return 0===r?x:Math.round(x-r+div)},exports.scrollIntoView=function(element,spot,scrollMatches=!1){let parent=element.offsetParent;if(!parent)return void console.error("offsetParent is not set -- cannot scroll");let offsetY=element.offsetTop+element.clientTop,offsetX=element.offsetLeft+element.clientLeft;for(;parent.clientHeight===parent.scrollHeight&&parent.clientWidth===parent.scrollWidth||scrollMatches&&(parent.classList.contains("markedContent")||"hidden"===getComputedStyle(parent).overflow);)if(offsetY+=parent.offsetTop,offsetX+=parent.offsetLeft,parent=parent.offsetParent,!parent)return;spot&&(void 0!==spot.top&&(offsetY+=spot.top),void 0!==spot.left&&(offsetX+=spot.left,parent.scrollLeft=offsetX));parent.scrollTop=offsetY},exports.watchScroll=function(viewAreaElement,callback){const debounceScroll=function(evt){rAF||(rAF=window.requestAnimationFrame((function(){rAF=null;const currentX=viewAreaElement.scrollLeft,lastX=state.lastX;currentX!==lastX&&(state.right=currentX>lastX),state.lastX=currentX;const currentY=viewAreaElement.scrollTop,lastY=state.lastY;currentY!==lastY&&(state.down=currentY>lastY),state.lastY=currentY,callback(state)})))},state={right:!0,down:!0,lastX:viewAreaElement.scrollLeft,lastY:viewAreaElement.scrollTop,_eventHandler:debounceScroll};let rAF=null;return viewAreaElement.addEventListener("scroll",debounceScroll,!0),state};exports.DEFAULT_SCALE_VALUE="auto";exports.DEFAULT_SCALE=1;exports.DEFAULT_SCALE_DELTA=1.1;exports.MIN_SCALE=.1;exports.MAX_SCALE=10;exports.UNKNOWN_SCALE=0;exports.MAX_AUTO_SCALE=1.25;exports.SCROLLBAR_PADDING=40;exports.VERTICAL_PADDING=5;exports.RenderingStates={INITIAL:0,RUNNING:1,PAUSED:2,FINISHED:3};exports.PresentationModeState={UNKNOWN:0,NORMAL:1,CHANGING:2,FULLSCREEN:3};const SidebarView={UNKNOWN:-1,NONE:0,THUMBS:1,OUTLINE:2,ATTACHMENTS:3,LAYERS:4};exports.SidebarView=SidebarView;exports.RendererType={CANVAS:"canvas",SVG:"svg"};exports.TextLayerMode={DISABLE:0,ENABLE:1,ENABLE_ENHANCE:2};const ScrollMode={UNKNOWN:-1,VERTICAL:0,HORIZONTAL:1,WRAPPED:2,PAGE:3};exports.ScrollMode=ScrollMode;const SpreadMode={UNKNOWN:-1,NONE:0,ODD:1,EVEN:2};exports.SpreadMode=SpreadMode;exports.AutoPrintRegExp=/\bprint\s*\(/;exports.OutputScale=class{constructor(){const pixelRatio=window.devicePixelRatio||1;this.sx=pixelRatio,this.sy=pixelRatio}get scaled(){return 1!==this.sx||1!==this.sy}};const NullCharactersRegExp=/\x00/g,InvisibleCharactersRegExp=/[\x01-\x1F]/g;function binarySearchFirstItem(items,condition,start=0){let minIndex=start,maxIndex=items.length-1;if(maxIndex<0||!condition(items[maxIndex]))return items.length;if(condition(items[minIndex]))return minIndex;for(;minIndex<maxIndex;){const currentIndex=minIndex+maxIndex>>1;condition(items[currentIndex])?maxIndex=currentIndex:minIndex=currentIndex+1}return minIndex}function backtrackBeforeAllVisibleElements(index,views,top){if(index<2)return index;let elt=views[index].div,pageTop=elt.offsetTop+elt.clientTop;pageTop>=top&&(elt=views[index-1].div,pageTop=elt.offsetTop+elt.clientTop);for(let i=index-2;i>=0&&(elt=views[i].div,!(elt.offsetTop+elt.clientTop+elt.clientHeight<=pageTop));--i)index=i;return index}function normalizeWheelEventDirection(evt){let delta=Math.hypot(evt.deltaX,evt.deltaY);const angle=Math.atan2(evt.deltaY,evt.deltaX);return-.25*Math.PI<angle&&angle<.75*Math.PI&&(delta=-delta),delta}const animationStarted=new Promise((function(resolve){window.requestAnimationFrame(resolve)}));exports.animationStarted=animationStarted;exports.ProgressBar=class{constructor(id,{height:height,width:width,units:units}={}){this.visible=!0,this.div=document.querySelector(id+" .progress"),this.bar=this.div.parentNode,this.height=height||100,this.width=width||100,this.units=units||"%",this.div.style.height=this.height+this.units,this.percent=0}_updateBar(){if(this._indeterminate)return this.div.classList.add("indeterminate"),void(this.div.style.width=this.width+this.units);this.div.classList.remove("indeterminate");const progressSize=this.width*this._percent/100;this.div.style.width=progressSize+this.units}get percent(){return this._percent}set percent(val){var v,min,max;this._indeterminate=isNaN(val),this._percent=(v=val,min=0,max=100,Math.min(Math.max(v,min),max)),this._updateBar()}setWidth(viewer){if(!viewer)return;const scrollbarWidth=viewer.parentNode.offsetWidth-viewer.offsetWidth;if(scrollbarWidth>0){document.documentElement.style.setProperty("--loadingBar-end-offset",`${scrollbarWidth}px`)}}hide(){this.visible&&(this.visible=!1,this.bar.classList.add("hidden"))}show(){this.visible||(this.visible=!0,this.bar.classList.remove("hidden"))}}},(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.WaitOnType=exports.EventBus=exports.AutomationEventBus=void 0,exports.waitOnEventOrTimeout=function({target:target,name:name,delay:delay=0}){return new Promise((function(resolve,reject){if("object"!=typeof target||!name||"string"!=typeof name||!(Number.isInteger(delay)&&delay>=0))throw new Error("waitOnEventOrTimeout - invalid parameters.");function handler(type){target instanceof EventBus?target._off(name,eventHandler):target.removeEventListener(name,eventHandler),timeout&&clearTimeout(timeout),resolve(type)}const eventHandler=handler.bind(null,WaitOnType.EVENT);target instanceof EventBus?target._on(name,eventHandler):target.addEventListener(name,eventHandler);const timeoutHandler=handler.bind(null,WaitOnType.TIMEOUT),timeout=setTimeout(timeoutHandler,delay)}))};const WaitOnType={EVENT:"event",TIMEOUT:"timeout"};exports.WaitOnType=WaitOnType;class EventBus{constructor(){this._listeners=Object.create(null)}on(eventName,listener,options=null){this._on(eventName,listener,{external:!0,once:options?.once})}off(eventName,listener,options=null){this._off(eventName,listener,{external:!0,once:options?.once})}dispatch(eventName,data){const eventListeners=this._listeners[eventName];if(!eventListeners||0===eventListeners.length)return;let externalListeners;for(const{listener:listener,external:external,once:once}of eventListeners.slice(0))once&&this._off(eventName,listener),external?(externalListeners||=[]).push(listener):listener(data);if(externalListeners){for(const listener of externalListeners)listener(data);externalListeners=null}}_on(eventName,listener,options=null){(this._listeners[eventName]||=[]).push({listener:listener,external:!0===options?.external,once:!0===options?.once})}_off(eventName,listener,options=null){const eventListeners=this._listeners[eventName];if(eventListeners)for(let i=0,ii=eventListeners.length;i<ii;i++)if(eventListeners[i].listener===listener)return void eventListeners.splice(i,1)}}exports.EventBus=EventBus;exports.AutomationEventBus=class extends EventBus{dispatch(eventName,data){throw new Error("Not implemented: AutomationEventBus.dispatch")}}},module=>{let pdfjsLib;pdfjsLib="undefined"!=typeof window&&window["pdfjs-dist/build/pdf"]?window["pdfjs-dist/build/pdf"]:require("../build/pdf.js"),module.exports=pdfjsLib},(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.PDFCursorTools=exports.CursorTool=void 0;var _grab_to_pan=__webpack_require__(7),_ui_utils=__webpack_require__(3);const CursorTool={SELECT:0,HAND:1,ZOOM:2};exports.CursorTool=CursorTool;exports.PDFCursorTools=class{constructor({container:container,eventBus:eventBus,cursorToolOnLoad:cursorToolOnLoad=CursorTool.SELECT}){this.container=container,this.eventBus=eventBus,this.active=CursorTool.SELECT,this.activeBeforePresentationMode=null,this.handTool=new _grab_to_pan.GrabToPan({element:this.container}),this._addEventListeners(),Promise.resolve().then((()=>{this.switchTool(cursorToolOnLoad)}))}get activeTool(){return this.active}switchTool(tool){if(null!==this.activeBeforePresentationMode)return;if(tool===this.active)return;const disableActiveTool=()=>{switch(this.active){case CursorTool.SELECT:break;case CursorTool.HAND:this.handTool.deactivate()}};switch(tool){case CursorTool.SELECT:disableActiveTool();break;case CursorTool.HAND:disableActiveTool(),this.handTool.activate();break;default:return void console.error(`switchTool: "${tool}" is an unsupported value.`)}this.active=tool,this._dispatchEvent()}_dispatchEvent(){this.eventBus.dispatch("cursortoolchanged",{source:this,tool:this.active})}_addEventListeners(){this.eventBus._on("switchcursortool",(evt=>{this.switchTool(evt.tool)})),this.eventBus._on("presentationmodechanged",(evt=>{switch(evt.state){case _ui_utils.PresentationModeState.FULLSCREEN:{const previouslyActive=this.active;this.switchTool(CursorTool.SELECT),this.activeBeforePresentationMode=previouslyActive;break}case _ui_utils.PresentationModeState.NORMAL:{const previouslyActive=this.activeBeforePresentationMode;this.activeBeforePresentationMode=null,this.switchTool(previouslyActive);break}}}))}}},(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.GrabToPan=void 0;exports.GrabToPan=class{constructor(options){this.element=options.element,this.document=options.element.ownerDocument,"function"==typeof options.ignoreTarget&&(this.ignoreTarget=options.ignoreTarget),this.onActiveChanged=options.onActiveChanged,this.activate=this.activate.bind(this),this.deactivate=this.deactivate.bind(this),this.toggle=this.toggle.bind(this),this._onMouseDown=this.#onMouseDown.bind(this),this._onMouseMove=this.#onMouseMove.bind(this),this._endPan=this.#endPan.bind(this);(this.overlay=document.createElement("div")).className="grab-to-pan-grabbing"}activate(){this.active||(this.active=!0,this.element.addEventListener("mousedown",this._onMouseDown,!0),this.element.classList.add("grab-to-pan-grab"),this.onActiveChanged?.(!0))}deactivate(){this.active&&(this.active=!1,this.element.removeEventListener("mousedown",this._onMouseDown,!0),this._endPan(),this.element.classList.remove("grab-to-pan-grab"),this.onActiveChanged?.(!1))}toggle(){this.active?this.deactivate():this.activate()}ignoreTarget(node){return node.matches("a[href], a[href] *, input, textarea, button, button *, select, option")}#onMouseDown(event){if(0!==event.button||this.ignoreTarget(event.target))return;if(event.originalTarget)try{event.originalTarget.tagName}catch(e){return}this.scrollLeftStart=this.element.scrollLeft,this.scrollTopStart=this.element.scrollTop,this.clientXStart=event.clientX,this.clientYStart=event.clientY,this.document.addEventListener("mousemove",this._onMouseMove,!0),this.document.addEventListener("mouseup",this._endPan,!0),this.element.addEventListener("scroll",this._endPan,!0),event.preventDefault(),event.stopPropagation();const focusedElement=document.activeElement;focusedElement&&!focusedElement.contains(event.target)&&focusedElement.blur()}#onMouseMove(event){if(this.element.removeEventListener("scroll",this._endPan,!0),!(1&event.buttons))return void this._endPan();const xDiff=event.clientX-this.clientXStart,yDiff=event.clientY-this.clientYStart,scrollTop=this.scrollTopStart-yDiff,scrollLeft=this.scrollLeftStart-xDiff;this.element.scrollTo?this.element.scrollTo({top:scrollTop,left:scrollLeft,behavior:"instant"}):(this.element.scrollTop=scrollTop,this.element.scrollLeft=scrollLeft),this.overlay.parentNode||document.body.appendChild(this.overlay)}#endPan(){this.element.removeEventListener("scroll",this._endPan,!0),this.document.removeEventListener("mousemove",this._onMouseMove,!0),this.document.removeEventListener("mouseup",this._endPan,!0),this.overlay.remove()}}},(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.SimpleLinkService=exports.PDFLinkService=exports.LinkTarget=void 0;var _ui_utils=__webpack_require__(3);const LinkTarget={NONE:0,SELF:1,BLANK:2,PARENT:3,TOP:4};function addLinkAttributes(link,{url:url,target:target,rel:rel,enabled:enabled=!0}={}){if(!url||"string"!=typeof url)throw new Error('A valid "url" parameter must provided.');const urlNullRemoved=(0,_ui_utils.removeNullCharacters)(url);enabled?link.href=link.title=urlNullRemoved:(link.href="",link.title=`Disabled: ${urlNullRemoved}`,link.onclick=()=>!1);let targetStr="";switch(target){case LinkTarget.NONE:break;case LinkTarget.SELF:targetStr="_self";break;case LinkTarget.BLANK:targetStr="_blank";break;case LinkTarget.PARENT:targetStr="_parent";break;case LinkTarget.TOP:targetStr="_top"}link.target=targetStr,link.rel="string"==typeof rel?rel:"noopener noreferrer nofollow"}exports.LinkTarget=LinkTarget;class PDFLinkService{#pagesRefCache=new Map;constructor({eventBus:eventBus,externalLinkTarget:externalLinkTarget=null,externalLinkRel:externalLinkRel=null,ignoreDestinationZoom:ignoreDestinationZoom=!1}={}){this.eventBus=eventBus,this.externalLinkTarget=externalLinkTarget,this.externalLinkRel=externalLinkRel,this.externalLinkEnabled=!0,this._ignoreDestinationZoom=ignoreDestinationZoom,this.baseUrl=null,this.pdfDocument=null,this.pdfViewer=null,this.pdfHistory=null}setDocument(pdfDocument,baseUrl=null){this.baseUrl=baseUrl,this.pdfDocument=pdfDocument,this.#pagesRefCache.clear()}setViewer(pdfViewer){this.pdfViewer=pdfViewer}setHistory(pdfHistory){this.pdfHistory=pdfHistory}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return this.pdfViewer.currentPageNumber}set page(value){this.pdfViewer.currentPageNumber=value}get rotation(){return this.pdfViewer.pagesRotation}set rotation(value){this.pdfViewer.pagesRotation=value}#goToDestinationHelper(rawDest,namedDest=null,explicitDest){const destRef=explicitDest[0];let pageNumber;if("object"==typeof destRef&&null!==destRef){if(pageNumber=this._cachedPageNumber(destRef),!pageNumber)return void this.pdfDocument.getPageIndex(destRef).then((pageIndex=>{this.cachePageRef(pageIndex+1,destRef),this.#goToDestinationHelper(rawDest,namedDest,explicitDest)})).catch((()=>{console.error(`PDFLinkService.#goToDestinationHelper: "${destRef}" is not a valid page reference, for dest="${rawDest}".`)}))}else{if(!Number.isInteger(destRef))return void console.error(`PDFLinkService.#goToDestinationHelper: "${destRef}" is not a valid destination reference, for dest="${rawDest}".`);pageNumber=destRef+1}!pageNumber||pageNumber<1||pageNumber>this.pagesCount?console.error(`PDFLinkService.#goToDestinationHelper: "${pageNumber}" is not a valid page number, for dest="${rawDest}".`):(this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.push({namedDest:namedDest,explicitDest:explicitDest,pageNumber:pageNumber})),this.pdfViewer.scrollPageIntoView({pageNumber:pageNumber,destArray:explicitDest,ignoreDestinationZoom:this._ignoreDestinationZoom}))}async goToDestination(dest){if(!this.pdfDocument)return;let namedDest,explicitDest;"string"==typeof dest?(namedDest=dest,explicitDest=await this.pdfDocument.getDestination(dest)):(namedDest=null,explicitDest=await dest),Array.isArray(explicitDest)?this.#goToDestinationHelper(dest,namedDest,explicitDest):console.error(`PDFLinkService.goToDestination: "${explicitDest}" is not a valid destination array, for dest="${dest}".`)}goToPage(val){if(!this.pdfDocument)return;const pageNumber="string"==typeof val&&this.pdfViewer.pageLabelToPageNumber(val)||0|val;Number.isInteger(pageNumber)&&pageNumber>0&&pageNumber<=this.pagesCount?(this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.pushPage(pageNumber)),this.pdfViewer.scrollPageIntoView({pageNumber:pageNumber})):console.error(`PDFLinkService.goToPage: "${val}" is not a valid page.`)}addLinkAttributes(link,url,newWindow=!1){addLinkAttributes(link,{url:url,target:newWindow?LinkTarget.BLANK:this.externalLinkTarget,rel:this.externalLinkRel,enabled:this.externalLinkEnabled})}getDestinationHash(dest){if("string"==typeof dest){if(dest.length>0)return this.getAnchorUrl("#"+escape(dest))}else if(Array.isArray(dest)){const str=JSON.stringify(dest);if(str.length>0)return this.getAnchorUrl("#"+escape(str))}return this.getAnchorUrl("")}getAnchorUrl(anchor){return(this.baseUrl||"")+anchor}setHash(hash){if(!this.pdfDocument)return;let pageNumber,dest;if(hash.includes("=")){const params=(0,_ui_utils.parseQueryString)(hash);if(params.has("search")&&this.eventBus.dispatch("findfromurlhash",{source:this,query:params.get("search").replace(/"/g,""),phraseSearch:"true"===params.get("phrase")}),params.has("page")&&(pageNumber=0|params.get("page")||1),params.has("zoom")){const zoomArgs=params.get("zoom").split(","),zoomArg=zoomArgs[0],zoomArgNumber=parseFloat(zoomArg);zoomArg.includes("Fit")?"Fit"===zoomArg||"FitB"===zoomArg?dest=[null,{name:zoomArg}]:"FitH"===zoomArg||"FitBH"===zoomArg||"FitV"===zoomArg||"FitBV"===zoomArg?dest=[null,{name:zoomArg},zoomArgs.length>1?0|zoomArgs[1]:null]:"FitR"===zoomArg?5!==zoomArgs.length?console.error('PDFLinkService.setHash: Not enough parameters for "FitR".'):dest=[null,{name:zoomArg},0|zoomArgs[1],0|zoomArgs[2],0|zoomArgs[3],0|zoomArgs[4]]:console.error(`PDFLinkService.setHash: "${zoomArg}" is not a valid zoom value.`):dest=[null,{name:"XYZ"},zoomArgs.length>1?0|zoomArgs[1]:null,zoomArgs.length>2?0|zoomArgs[2]:null,zoomArgNumber?zoomArgNumber/100:zoomArg]}dest?this.pdfViewer.scrollPageIntoView({pageNumber:pageNumber||this.page,destArray:dest,allowNegativeOffset:!0}):pageNumber&&(this.page=pageNumber),params.has("pagemode")&&this.eventBus.dispatch("pagemode",{source:this,mode:params.get("pagemode")}),params.has("nameddest")&&this.goToDestination(params.get("nameddest"))}else{dest=unescape(hash);try{dest=JSON.parse(dest),Array.isArray(dest)||(dest=dest.toString())}catch(ex){}if("string"==typeof dest||PDFLinkService.#isValidExplicitDestination(dest))return void this.goToDestination(dest);console.error(`PDFLinkService.setHash: "${unescape(hash)}" is not a valid destination.`)}}executeNamedAction(action){switch(action){case"GoBack":this.pdfHistory?.back();break;case"GoForward":this.pdfHistory?.forward();break;case"NextPage":this.pdfViewer.nextPage();break;case"PrevPage":this.pdfViewer.previousPage();break;case"LastPage":this.page=this.pagesCount;break;case"FirstPage":this.page=1}this.eventBus.dispatch("namedaction",{source:this,action:action})}cachePageRef(pageNum,pageRef){if(!pageRef)return;const refStr=0===pageRef.gen?`${pageRef.num}R`:`${pageRef.num}R${pageRef.gen}`;this.#pagesRefCache.set(refStr,pageNum)}_cachedPageNumber(pageRef){if(!pageRef)return null;const refStr=0===pageRef.gen?`${pageRef.num}R`:`${pageRef.num}R${pageRef.gen}`;return this.#pagesRefCache.get(refStr)||null}isPageVisible(pageNumber){return this.pdfViewer.isPageVisible(pageNumber)}isPageCached(pageNumber){return this.pdfViewer.isPageCached(pageNumber)}static#isValidExplicitDestination(dest){if(!Array.isArray(dest))return!1;const destLength=dest.length;if(destLength<2)return!1;const page=dest[0];if(!("object"==typeof page&&Number.isInteger(page.num)&&Number.isInteger(page.gen)||Number.isInteger(page)&&page>=0))return!1;const zoom=dest[1];if("object"!=typeof zoom||"string"!=typeof zoom.name)return!1;let allowNull=!0;switch(zoom.name){case"XYZ":if(5!==destLength)return!1;break;case"Fit":case"FitB":return 2===destLength;case"FitH":case"FitBH":case"FitV":case"FitBV":if(3!==destLength)return!1;break;case"FitR":if(6!==destLength)return!1;allowNull=!1;break;default:return!1}for(let i=2;i<destLength;i++){const param=dest[i];if(!("number"==typeof param||allowNull&&null===param))return!1}return!0}}exports.PDFLinkService=PDFLinkService;exports.SimpleLinkService=class{constructor(){this.externalLinkEnabled=!0}get pagesCount(){return 0}get page(){return 0}set page(value){}get rotation(){return 0}set rotation(value){}async goToDestination(dest){}goToPage(val){}addLinkAttributes(link,url,newWindow=!1){addLinkAttributes(link,{url:url,enabled:this.externalLinkEnabled})}getDestinationHash(dest){return"#"}getAnchorUrl(hash){return"#"}setHash(hash){}executeNamedAction(action){}cachePageRef(pageNum,pageRef){}isPageVisible(pageNumber){return!0}isPageCached(pageNumber){return!0}}},(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.OverlayManager=void 0;exports.OverlayManager=class{constructor(){this._overlays={},this._active=null,this._keyDownBound=this._keyDown.bind(this)}get active(){return this._active}async register(name,element,callerCloseMethod=null,canForceClose=!1){let container;if(!(name&&element&&(container=element.parentNode)))throw new Error("Not enough parameters.");if(this._overlays[name])throw new Error("The overlay is already registered.");this._overlays[name]={element:element,container:container,callerCloseMethod:callerCloseMethod,canForceClose:canForceClose}}async unregister(name){if(!this._overlays[name])throw new Error("The overlay does not exist.");if(this._active===name)throw new Error("The overlay cannot be removed while it is active.");delete this._overlays[name]}async open(name){if(!this._overlays[name])throw new Error("The overlay does not exist.");if(this._active){if(!this._overlays[name].canForceClose)throw this._active===name?new Error("The overlay is already active."):new Error("Another overlay is currently active.");this._closeThroughCaller()}this._active=name,this._overlays[this._active].element.classList.remove("hidden"),this._overlays[this._active].container.classList.remove("hidden"),window.addEventListener("keydown",this._keyDownBound)}async close(name){if(!this._overlays[name])throw new Error("The overlay does not exist.");if(!this._active)throw new Error("The overlay is currently not active.");if(this._active!==name)throw new Error("Another overlay is currently active.");this._overlays[this._active].container.classList.add("hidden"),this._overlays[this._active].element.classList.add("hidden"),this._active=null,window.removeEventListener("keydown",this._keyDownBound)}_keyDown(evt){this._active&&27===evt.keyCode&&(this._closeThroughCaller(),evt.preventDefault())}_closeThroughCaller(){this._overlays[this._active].callerCloseMethod&&this._overlays[this._active].callerCloseMethod(),this._active&&this.close(this._active)}}},(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.PasswordPrompt=void 0;var _pdfjsLib=__webpack_require__(5);exports.PasswordPrompt=class{constructor(options,overlayManager,l10n,isViewerEmbedded=!1){this.overlayName=options.overlayName,this.container=options.container,this.label=options.label,this.input=options.input,this.submitButton=options.submitButton,this.cancelButton=options.cancelButton,this.overlayManager=overlayManager,this.l10n=l10n,this._isViewerEmbedded=isViewerEmbedded,this.updateCallback=null,this.reason=null,this.submitButton.addEventListener("click",this.#verify.bind(this)),this.cancelButton.addEventListener("click",this.#cancel.bind(this)),this.input.addEventListener("keydown",(e=>{13===e.keyCode&&this.#verify()})),this.overlayManager.register(this.overlayName,this.container,this.#cancel.bind(this),!0)}async open(){await this.overlayManager.open(this.overlayName);const passwordIncorrect=this.reason===_pdfjsLib.PasswordResponses.INCORRECT_PASSWORD;this._isViewerEmbedded&&!passwordIncorrect||this.input.focus(),this.label.textContent=await this.l10n.get("password_"+(passwordIncorrect?"invalid":"label"))}async close(){await this.overlayManager.close(this.overlayName),this.input.value=""}#verify(){const password=this.input.value;password?.length>0&&(this.close(),this.updateCallback(password))}#cancel(){this.close(),this.updateCallback(new Error("PasswordPrompt cancelled."))}setUpdateCallback(updateCallback,reason){this.updateCallback=updateCallback,this.reason=reason}}},(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.PDFAttachmentViewer=void 0;var _pdfjsLib=__webpack_require__(5),_base_tree_viewer=__webpack_require__(12);class PDFAttachmentViewer extends _base_tree_viewer.BaseTreeViewer{constructor(options){super(options),this.downloadManager=options.downloadManager,this.eventBus._on("fileattachmentannotation",this._appendAttachment.bind(this))}reset(keepRenderedCapability=!1){super.reset(),this._attachments=null,keepRenderedCapability||(this._renderedCapability=(0,_pdfjsLib.createPromiseCapability)()),this._pendingDispatchEvent&&clearTimeout(this._pendingDispatchEvent),this._pendingDispatchEvent=null}_dispatchEvent(attachmentsCount){this._renderedCapability.resolve(),this._pendingDispatchEvent&&(clearTimeout(this._pendingDispatchEvent),this._pendingDispatchEvent=null),0!==attachmentsCount?this.eventBus.dispatch("attachmentsloaded",{source:this,attachmentsCount:attachmentsCount}):this._pendingDispatchEvent=setTimeout((()=>{this.eventBus.dispatch("attachmentsloaded",{source:this,attachmentsCount:0}),this._pendingDispatchEvent=null}))}_bindLink(element,{content:content,filename:filename}){element.onclick=()=>(this.downloadManager.openOrDownloadData(element,content,filename),!1)}render({attachments:attachments,keepRenderedCapability:keepRenderedCapability=!1}){if(this._attachments&&this.reset(keepRenderedCapability),this._attachments=attachments||null,!attachments)return void this._dispatchEvent(0);const names=Object.keys(attachments).sort((function(a,b){return a.toLowerCase().localeCompare(b.toLowerCase())})),fragment=document.createDocumentFragment();let attachmentsCount=0;for(const name of names){const item=attachments[name],content=item.content,filename=(0,_pdfjsLib.getFilenameFromUrl)(item.filename),div=document.createElement("div");div.className="treeItem";const element=document.createElement("a");this._bindLink(element,{content:content,filename:filename}),element.textContent=this._normalizeTextContent(filename),div.appendChild(element),fragment.appendChild(div),attachmentsCount++}this._finishRendering(fragment,attachmentsCount)}_appendAttachment({id:id,filename:filename,content:content}){const renderedPromise=this._renderedCapability.promise;renderedPromise.then((()=>{if(renderedPromise!==this._renderedCapability.promise)return;let attachments=this._attachments;if(attachments){for(const name in attachments)if(id===name)return}else attachments=Object.create(null);attachments[id]={filename:filename,content:content},this.render({attachments:attachments,keepRenderedCapability:!0})}))}}exports.PDFAttachmentViewer=PDFAttachmentViewer},(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.BaseTreeViewer=void 0;var _ui_utils=__webpack_require__(3);class BaseTreeViewer{constructor(options){if(this.constructor===BaseTreeViewer)throw new Error("Cannot initialize BaseTreeViewer.");this.container=options.container,this.eventBus=options.eventBus,this.reset()}reset(){this._pdfDocument=null,this._lastToggleIsShow=!0,this._currentTreeItem=null,this.container.textContent="",this.container.classList.remove("treeWithDeepNesting")}_dispatchEvent(count){throw new Error("Not implemented: _dispatchEvent")}_bindLink(element,params){throw new Error("Not implemented: _bindLink")}_normalizeTextContent(str){return(0,_ui_utils.removeNullCharacters)(str,!0)||"–"}_addToggleButton(div,hidden=!1){const toggler=document.createElement("div");toggler.className="treeItemToggler",hidden&&toggler.classList.add("treeItemsHidden"),toggler.onclick=evt=>{if(evt.stopPropagation(),toggler.classList.toggle("treeItemsHidden"),evt.shiftKey){const shouldShowAll=!toggler.classList.contains("treeItemsHidden");this._toggleTreeItem(div,shouldShowAll)}},div.insertBefore(toggler,div.firstChild)}_toggleTreeItem(root,show=!1){this._lastToggleIsShow=show;for(const toggler of root.querySelectorAll(".treeItemToggler"))toggler.classList.toggle("treeItemsHidden",!show)}_toggleAllTreeItems(){this._toggleTreeItem(this.container,!this._lastToggleIsShow)}_finishRendering(fragment,count,hasAnyNesting=!1){hasAnyNesting&&(this.container.classList.add("treeWithDeepNesting"),this._lastToggleIsShow=!fragment.querySelector(".treeItemsHidden")),this.container.appendChild(fragment),this._dispatchEvent(count)}render(params){throw new Error("Not implemented: render")}_updateCurrentTreeItem(treeItem=null){this._currentTreeItem&&(this._currentTreeItem.classList.remove("selected"),this._currentTreeItem=null),treeItem&&(treeItem.classList.add("selected"),this._currentTreeItem=treeItem)}_scrollToCurrentTreeItem(treeItem){if(!treeItem)return;let currentNode=treeItem.parentNode;for(;currentNode&&currentNode!==this.container;){if(currentNode.classList.contains("treeItem")){currentNode.firstElementChild?.classList.remove("treeItemsHidden")}currentNode=currentNode.parentNode}this._updateCurrentTreeItem(treeItem),this.container.scrollTo(treeItem.offsetLeft,treeItem.offsetTop+-100)}}exports.BaseTreeViewer=BaseTreeViewer},(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.PDFDocumentProperties=void 0;var _pdfjsLib=__webpack_require__(5),_ui_utils=__webpack_require__(3);const NON_METRIC_LOCALES=["en-us","en-lr","my"],US_PAGE_NAMES={"8.5x11":"Letter","8.5x14":"Legal"},METRIC_PAGE_NAMES={"297x420":"A3","210x297":"A4"};function getPageName(size,isPortrait,pageNames){return pageNames[`${isPortrait?size.width:size.height}x${isPortrait?size.height:size.width}`]}exports.PDFDocumentProperties=class{constructor({overlayName:overlayName,fields:fields,container:container,closeButton:closeButton},overlayManager,eventBus,l10n){this.overlayName=overlayName,this.fields=fields,this.container=container,this.overlayManager=overlayManager,this.l10n=l10n,this._reset(),closeButton.addEventListener("click",this.close.bind(this)),this.overlayManager.register(this.overlayName,this.container,this.close.bind(this)),eventBus._on("pagechanging",(evt=>{this._currentPageNumber=evt.pageNumber})),eventBus._on("rotationchanging",(evt=>{this._pagesRotation=evt.pagesRotation})),this._isNonMetricLocale=!0,l10n.getLanguage().then((locale=>{this._isNonMetricLocale=NON_METRIC_LOCALES.includes(locale)}))}async open(){const freezeFieldData=data=>{Object.defineProperty(this,"fieldData",{value:Object.freeze(data),writable:!1,enumerable:!0,configurable:!0})};await Promise.all([this.overlayManager.open(this.overlayName),this._dataAvailableCapability.promise]);const currentPageNumber=this._currentPageNumber,pagesRotation=this._pagesRotation;if(this.fieldData&&currentPageNumber===this.fieldData._currentPageNumber&&pagesRotation===this.fieldData._pagesRotation)return void this._updateUI();const{info:info,contentDispositionFilename:contentDispositionFilename,contentLength:contentLength}=await this.pdfDocument.getMetadata(),[fileName,fileSize,creationDate,modificationDate,pageSize,isLinearized]=await Promise.all([contentDispositionFilename||(0,_pdfjsLib.getPdfFilenameFromUrl)(this.url),this._parseFileSize(contentLength),this._parseDate(info.CreationDate),this._parseDate(info.ModDate),this.pdfDocument.getPage(currentPageNumber).then((pdfPage=>this._parsePageSize((0,_ui_utils.getPageSizeInches)(pdfPage),pagesRotation))),this._parseLinearization(info.IsLinearized)]);freezeFieldData({fileName:fileName,fileSize:fileSize,title:info.Title,author:info.Author,subject:info.Subject,keywords:info.Keywords,creationDate:creationDate,modificationDate:modificationDate,creator:info.Creator,producer:info.Producer,version:info.PDFFormatVersion,pageCount:this.pdfDocument.numPages,pageSize:pageSize,linearized:isLinearized,_currentPageNumber:currentPageNumber,_pagesRotation:pagesRotation}),this._updateUI();const{length:length}=await this.pdfDocument.getDownloadInfo();if(contentLength===length)return;const data=Object.assign(Object.create(null),this.fieldData);data.fileSize=await this._parseFileSize(length),freezeFieldData(data),this._updateUI()}close(){this.overlayManager.close(this.overlayName)}setDocument(pdfDocument,url=null){this.pdfDocument&&(this._reset(),this._updateUI(!0)),pdfDocument&&(this.pdfDocument=pdfDocument,this.url=url,this._dataAvailableCapability.resolve())}_reset(){this.pdfDocument=null,this.url=null,delete this.fieldData,this._dataAvailableCapability=(0,_pdfjsLib.createPromiseCapability)(),this._currentPageNumber=1,this._pagesRotation=0}_updateUI(reset=!1){if(!reset&&this.fieldData){if(this.overlayManager.active===this.overlayName)for(const id in this.fields){const content=this.fieldData[id];this.fields[id].textContent=content||0===content?content:"-"}}else for(const id in this.fields)this.fields[id].textContent="-"}async _parseFileSize(fileSize=0){const kb=fileSize/1024,mb=kb/1024;if(kb)return this.l10n.get("document_properties_"+(mb>=1?"mb":"kb"),{size_mb:mb>=1&&(+mb.toPrecision(3)).toLocaleString(),size_kb:mb<1&&(+kb.toPrecision(3)).toLocaleString(),size_b:fileSize.toLocaleString()})}async _parsePageSize(pageSizeInches,pagesRotation){if(!pageSizeInches)return;pagesRotation%180!=0&&(pageSizeInches={width:pageSizeInches.height,height:pageSizeInches.width});const isPortrait=(0,_ui_utils.isPortraitOrientation)(pageSizeInches);let sizeInches={width:Math.round(100*pageSizeInches.width)/100,height:Math.round(100*pageSizeInches.height)/100},sizeMillimeters={width:Math.round(25.4*pageSizeInches.width*10)/10,height:Math.round(25.4*pageSizeInches.height*10)/10},rawName=getPageName(sizeInches,isPortrait,US_PAGE_NAMES)||getPageName(sizeMillimeters,isPortrait,METRIC_PAGE_NAMES);if(!(rawName||Number.isInteger(sizeMillimeters.width)&&Number.isInteger(sizeMillimeters.height))){const exactMillimeters={width:25.4*pageSizeInches.width,height:25.4*pageSizeInches.height},intMillimeters={width:Math.round(sizeMillimeters.width),height:Math.round(sizeMillimeters.height)};Math.abs(exactMillimeters.width-intMillimeters.width)<.1&&Math.abs(exactMillimeters.height-intMillimeters.height)<.1&&(rawName=getPageName(intMillimeters,isPortrait,METRIC_PAGE_NAMES),rawName&&(sizeInches={width:Math.round(intMillimeters.width/25.4*100)/100,height:Math.round(intMillimeters.height/25.4*100)/100},sizeMillimeters=intMillimeters))}const[{width:width,height:height},unit,name,orientation]=await Promise.all([this._isNonMetricLocale?sizeInches:sizeMillimeters,this.l10n.get("document_properties_page_size_unit_"+(this._isNonMetricLocale?"inches":"millimeters")),rawName&&this.l10n.get(`document_properties_page_size_name_${rawName.toLowerCase()}`),this.l10n.get("document_properties_page_size_orientation_"+(isPortrait?"portrait":"landscape"))]);return this.l10n.get(`document_properties_page_size_dimension_${name?"name_":""}string`,{width:width.toLocaleString(),height:height.toLocaleString(),unit:unit,name:name,orientation:orientation})}async _parseDate(inputDate){const dateObject=_pdfjsLib.PDFDateString.toDateObject(inputDate);if(dateObject)return this.l10n.get("document_properties_date_string",{date:dateObject.toLocaleDateString(),time:dateObject.toLocaleTimeString()})}_parseLinearization(isLinearized){return this.l10n.get("document_properties_linearized_"+(isLinearized?"yes":"no"))}}},(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.PDFFindBar=void 0;var _pdf_find_controller=__webpack_require__(15);exports.PDFFindBar=class{constructor(options,eventBus,l10n){this.opened=!1,this.bar=options.bar,this.toggleButton=options.toggleButton,this.findField=options.findField,this.highlightAll=options.highlightAllCheckbox,this.caseSensitive=options.caseSensitiveCheckbox,this.matchDiacritics=options.matchDiacriticsCheckbox,this.entireWord=options.entireWordCheckbox,this.findMsg=options.findMsg,this.findResultsCount=options.findResultsCount,this.findPreviousButton=options.findPreviousButton,this.findNextButton=options.findNextButton,this.eventBus=eventBus,this.l10n=l10n,this.toggleButton.addEventListener("click",(()=>{this.toggle()})),this.findField.addEventListener("input",(()=>{this.dispatchEvent("")})),this.bar.addEventListener("keydown",(e=>{switch(e.keyCode){case 13:e.target===this.findField&&this.dispatchEvent("again",e.shiftKey);break;case 27:this.close()}})),this.findPreviousButton.addEventListener("click",(()=>{this.dispatchEvent("again",!0)})),this.findNextButton.addEventListener("click",(()=>{this.dispatchEvent("again",!1)})),this.highlightAll.addEventListener("click",(()=>{this.dispatchEvent("highlightallchange")})),this.caseSensitive.addEventListener("click",(()=>{this.dispatchEvent("casesensitivitychange")})),this.entireWord.addEventListener("click",(()=>{this.dispatchEvent("entirewordchange")})),this.matchDiacritics.addEventListener("click",(()=>{this.dispatchEvent("diacriticmatchingchange")})),this.eventBus._on("resize",this._adjustWidth.bind(this))}reset(){this.updateUIState()}dispatchEvent(type,findPrev=!1){this.eventBus.dispatch("find",{source:this,type:type,query:this.findField.value,phraseSearch:!0,caseSensitive:this.caseSensitive.checked,entireWord:this.entireWord.checked,highlightAll:this.highlightAll.checked,findPrevious:findPrev,matchDiacritics:this.matchDiacritics.checked})}updateUIState(state,previous,matchesCount){let findMsg=Promise.resolve(""),status="";switch(state){case _pdf_find_controller.FindState.FOUND:break;case _pdf_find_controller.FindState.PENDING:status="pending";break;case _pdf_find_controller.FindState.NOT_FOUND:findMsg=this.l10n.get("find_not_found"),status="notFound";break;case _pdf_find_controller.FindState.WRAPPED:findMsg=this.l10n.get("find_reached_"+(previous?"top":"bottom"))}this.findField.setAttribute("data-status",status),findMsg.then((msg=>{this.findMsg.textContent=msg,this._adjustWidth()})),this.updateResultsCount(matchesCount)}updateResultsCount({current:current=0,total:total=0}={}){let matchCountMsg=Promise.resolve("");if(total>0)if(total>1e3){let key="find_match_count_limit";matchCountMsg=this.l10n.get(key,{limit:1e3})}else{let key="find_match_count";matchCountMsg=this.l10n.get(key,{current:current,total:total})}matchCountMsg.then((msg=>{this.findResultsCount.textContent=msg,this._adjustWidth()}))}open(){this.opened||(this.opened=!0,this.toggleButton.classList.add("toggled"),this.toggleButton.setAttribute("aria-expanded","true"),this.bar.classList.remove("hidden")),this.findField.select(),this.findField.focus(),this._adjustWidth()}close(){this.opened&&(this.opened=!1,this.toggleButton.classList.remove("toggled"),this.toggleButton.setAttribute("aria-expanded","false"),this.bar.classList.add("hidden"),this.eventBus.dispatch("findbarclose",{source:this}))}toggle(){this.opened?this.close():this.open()}_adjustWidth(){if(!this.opened)return;this.bar.classList.remove("wrapContainers");this.bar.clientHeight>this.bar.firstElementChild.clientHeight&&this.bar.classList.add("wrapContainers")}}},(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.PDFFindController=exports.FindState=void 0;var _ui_utils=__webpack_require__(3),_pdfjsLib=__webpack_require__(5),_pdf_find_utils=__webpack_require__(16);const FindState={FOUND:0,NOT_FOUND:1,WRAPPED:2,PENDING:3};exports.FindState=FindState;const CHARACTERS_TO_NORMALIZE={"‐":"-","‘":"'","’":"'","‚":"'","‛":"'","“":'"',"”":'"',"„":'"',"‟":'"',"¼":"1/4","½":"1/2","¾":"3/4"},DIACRITICS_EXCEPTION=new Set([12441,12442,2381,2509,2637,2765,2893,3021,3149,3277,3387,3388,3405,3530,3642,3770,3972,4153,4154,5908,5940,6098,6752,6980,7082,7083,7154,7155,11647,43014,43052,43204,43347,43456,43766,44013,3158,3953,3954,3962,3963,3964,3965,3968,3956]),DIACRITICS_EXCEPTION_STR=[...DIACRITICS_EXCEPTION.values()].map((x=>String.fromCharCode(x))).join(""),DIACRITICS_REG_EXP=/\p{M}+/gu,SPECIAL_CHARS_REG_EXP=/([.*+?^${}()|[\]\\])|(\p{P})|(\s+)|(\p{M})|(\p{L})/gu,NOT_DIACRITIC_FROM_END_REG_EXP=/([^\p{M}])\p{M}*$/u,NOT_DIACRITIC_FROM_START_REG_EXP=/^\p{M}*([^\p{M}])/u;let normalizationRegex=null;function normalize(text){if(!normalizationRegex){const replace=Object.keys(CHARACTERS_TO_NORMALIZE).join("");normalizationRegex=new RegExp(`([${replace}])|(\\p{M}+(?:-\\n)?)|(\\S-\\n)|(\\n)`,"gum")}const rawDiacriticsPositions=[];let m;for(;null!==(m=DIACRITICS_REG_EXP.exec(text));)rawDiacriticsPositions.push([m[0].length,m.index]);let normalized=text.normalize("NFD");const positions=[[0,0]];let k=0,shift=0,shiftOrigin=0,eol=0,hasDiacritics=!1;return normalized=normalized.replace(normalizationRegex,((match,p1,p2,p3,p4,i)=>{if(i-=shiftOrigin,p1){const replacement=CHARACTERS_TO_NORMALIZE[match],jj=replacement.length;for(let j=1;j<jj;j++)positions.push([i-shift+j,shift-j]);return shift-=jj-1,replacement}if(p2){const hasTrailingDashEOL=p2.endsWith("\n"),len=hasTrailingDashEOL?p2.length-2:p2.length;hasDiacritics=!0;let jj=len;i+eol===rawDiacriticsPositions[k]?.[1]&&(jj-=rawDiacriticsPositions[k][0],++k);for(let j=1;j<jj+1;j++)positions.push([i-1-shift+j,shift-j]);return shift-=jj,shiftOrigin+=jj,hasTrailingDashEOL?(i+=len-1,positions.push([i-shift+1,1+shift]),shift+=1,shiftOrigin+=1,eol+=1,p2.slice(0,len)):p2}return p3?(positions.push([i-shift+1,1+shift]),shift+=1,shiftOrigin+=1,eol+=1,p3.charAt(0)):(positions.push([i-shift+1,shift-1]),shift-=1,shiftOrigin+=1,eol+=1," ")})),positions.push([normalized.length,shift]),[normalized,positions,hasDiacritics]}function getOriginalIndex(diffs,pos,len){if(!diffs)return[pos,len];const start=pos,end=pos+len;let i=(0,_ui_utils.binarySearchFirstItem)(diffs,(x=>x[0]>=start));diffs[i][0]>start&&--i;let j=(0,_ui_utils.binarySearchFirstItem)(diffs,(x=>x[0]>=end),i);return diffs[j][0]>end&&--j,[start+diffs[i][1],len+diffs[j][1]-diffs[i][1]]}exports.PDFFindController=class{constructor({linkService:linkService,eventBus:eventBus}){this._linkService=linkService,this._eventBus=eventBus,this._reset(),eventBus._on("find",this._onFind.bind(this)),eventBus._on("findbarclose",this._onFindBarClose.bind(this)),this.executeCommand=(cmd,state)=>{console.error('Deprecated method `PDFFindController.executeCommand` called, please dispatch a "find"-event using the EventBus instead.');const eventState=Object.assign(Object.create(null),state,{type:cmd.substring("find".length)});this._onFind(eventState)}}get highlightMatches(){return this._highlightMatches}get pageMatches(){return this._pageMatches}get pageMatchesLength(){return this._pageMatchesLength}get selected(){return this._selected}get state(){return this._state}setDocument(pdfDocument){this._pdfDocument&&this._reset(),pdfDocument&&(this._pdfDocument=pdfDocument,this._firstPageCapability.resolve())}_onFind(state){if(!state)return;const pdfDocument=this._pdfDocument,{type:type}=state;(null===this._state||this._shouldDirtyMatch(state))&&(this._dirtyMatch=!0),this._state=state,"highlightallchange"!==type&&this._updateUIState(FindState.PENDING),this._firstPageCapability.promise.then((()=>{if(!this._pdfDocument||pdfDocument&&this._pdfDocument!==pdfDocument)return;this._extractText();const findbarClosed=!this._highlightMatches,pendingTimeout=!!this._findTimeout;this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),type?this._dirtyMatch?this._nextMatch():"again"===type?(this._nextMatch(),findbarClosed&&this._state.highlightAll&&this._updateAllPages()):"highlightallchange"===type?(pendingTimeout?this._nextMatch():this._highlightMatches=!0,this._updateAllPages()):this._nextMatch():this._findTimeout=setTimeout((()=>{this._nextMatch(),this._findTimeout=null}),250)}))}scrollMatchIntoView({element:element=null,selectedLeft:selectedLeft=0,pageIndex:pageIndex=-1,matchIndex:matchIndex=-1}){if(!this._scrollMatches||!element)return;if(-1===matchIndex||matchIndex!==this._selected.matchIdx)return;if(-1===pageIndex||pageIndex!==this._selected.pageIdx)return;this._scrollMatches=!1;const spot={top:-50,left:selectedLeft+-400};(0,_ui_utils.scrollIntoView)(element,spot,!0)}_reset(){this._highlightMatches=!1,this._scrollMatches=!1,this._pdfDocument=null,this._pageMatches=[],this._pageMatchesLength=[],this._state=null,this._selected={pageIdx:-1,matchIdx:-1},this._offset={pageIdx:null,matchIdx:null,wrapped:!1},this._extractTextPromises=[],this._pageContents=[],this._pageDiffs=[],this._hasDiacritics=[],this._matchesCountTotal=0,this._pagesToSearch=null,this._pendingFindMatches=new Set,this._resumePageIdx=null,this._dirtyMatch=!1,clearTimeout(this._findTimeout),this._findTimeout=null,this._firstPageCapability=(0,_pdfjsLib.createPromiseCapability)()}get _query(){return this._state.query!==this._rawQuery&&(this._rawQuery=this._state.query,[this._normalizedQuery]=normalize(this._state.query)),this._normalizedQuery}_shouldDirtyMatch(state){if(state.query!==this._state.query)return!0;switch(state.type){case"again":const pageNumber=this._selected.pageIdx+1,linkService=this._linkService;return pageNumber>=1&&pageNumber<=linkService.pagesCount&&pageNumber!==linkService.page&&!linkService.isPageVisible(pageNumber);case"highlightallchange":return!1}return!0}_isEntireWord(content,startIdx,length){let match=content.slice(0,startIdx).match(NOT_DIACRITIC_FROM_END_REG_EXP);if(match){const first=content.charCodeAt(startIdx),limit=match[1].charCodeAt(0);if((0,_pdf_find_utils.getCharacterType)(first)===(0,_pdf_find_utils.getCharacterType)(limit))return!1}if(match=content.slice(startIdx+length).match(NOT_DIACRITIC_FROM_START_REG_EXP),match){const last=content.charCodeAt(startIdx+length-1),limit=match[1].charCodeAt(0);if((0,_pdf_find_utils.getCharacterType)(last)===(0,_pdf_find_utils.getCharacterType)(limit))return!1}return!0}_calculateRegExpMatch(query,entireWord,pageIndex,pageContent){const matches=[],matchesLength=[],diffs=this._pageDiffs[pageIndex];let match;for(;null!==(match=query.exec(pageContent));){if(entireWord&&!this._isEntireWord(pageContent,match.index,match[0].length))continue;const[matchPos,matchLen]=getOriginalIndex(diffs,match.index,match[0].length);matchLen&&(matches.push(matchPos),matchesLength.push(matchLen))}this._pageMatches[pageIndex]=matches,this._pageMatchesLength[pageIndex]=matchesLength}_convertToRegExpString(query,hasDiacritics){const{matchDiacritics:matchDiacritics}=this._state;let isUnicode=!1;return(query=query.replace(SPECIAL_CHARS_REG_EXP,((match,p1,p2,p3,p4,p5)=>p1?`[ ]*\\${p1}[ ]*`:p2?`[ ]*${p2}[ ]*`:p3?"[ ]+":matchDiacritics?p4||p5:p4?DIACRITICS_EXCEPTION.has(p4.charCodeAt(0))?p4:"":hasDiacritics?(isUnicode=!0,`${p5}\\p{M}*`):p5))).endsWith("[ ]*")&&(query=query.slice(0,query.length-"[ ]*".length)),matchDiacritics&&hasDiacritics&&(isUnicode=!0,query=`${query}(?=[${DIACRITICS_EXCEPTION_STR}]|[^\\p{M}]|$)`),[isUnicode,query]}_calculateMatch(pageIndex){let query=this._query;if(0===query.length)return;const{caseSensitive:caseSensitive,entireWord:entireWord,phraseSearch:phraseSearch}=this._state,pageContent=this._pageContents[pageIndex],hasDiacritics=this._hasDiacritics[pageIndex];let isUnicode=!1;if(phraseSearch)[isUnicode,query]=this._convertToRegExpString(query,hasDiacritics);else{const match=query.match(/\S+/g);match&&(query=match.sort().reverse().map((q=>{const[isUnicodePart,queryPart]=this._convertToRegExpString(q,hasDiacritics);return isUnicode||=isUnicodePart,`(${queryPart})`})).join("|"))}query=new RegExp(query,`g${isUnicode?"u":""}${caseSensitive?"":"i"}`),this._calculateRegExpMatch(query,entireWord,pageIndex,pageContent),this._state.highlightAll&&this._updatePage(pageIndex),this._resumePageIdx===pageIndex&&(this._resumePageIdx=null,this._nextPageMatch());const pageMatchesCount=this._pageMatches[pageIndex].length;pageMatchesCount>0&&(this._matchesCountTotal+=pageMatchesCount,this._updateUIResultsCount())}_extractText(){if(this._extractTextPromises.length>0)return;let promise=Promise.resolve();for(let i=0,ii=this._linkService.pagesCount;i<ii;i++){const extractTextCapability=(0,_pdfjsLib.createPromiseCapability)();this._extractTextPromises[i]=extractTextCapability.promise,promise=promise.then((()=>this._pdfDocument.getPage(i+1).then((pdfPage=>pdfPage.getTextContent())).then((textContent=>{const textItems=textContent.items,strBuf=[];for(let j=0,jj=textItems.length;j<jj;j++)strBuf.push(textItems[j].str),textItems[j].hasEOL&&strBuf.push("\n");[this._pageContents[i],this._pageDiffs[i],this._hasDiacritics[i]]=normalize(strBuf.join("")),extractTextCapability.resolve(i)}),(reason=>{console.error(`Unable to get text content for page ${i+1}`,reason),this._pageContents[i]="",this._pageDiffs[i]=null,this._hasDiacritics[i]=!1,extractTextCapability.resolve(i)}))))}}_updatePage(index){this._scrollMatches&&this._selected.pageIdx===index&&(this._linkService.page=index+1),this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:index})}_updateAllPages(){this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:-1})}_nextMatch(){const previous=this._state.findPrevious,currentPageIndex=this._linkService.page-1,numPages=this._linkService.pagesCount;if(this._highlightMatches=!0,this._dirtyMatch){this._dirtyMatch=!1,this._selected.pageIdx=this._selected.matchIdx=-1,this._offset.pageIdx=currentPageIndex,this._offset.matchIdx=null,this._offset.wrapped=!1,this._resumePageIdx=null,this._pageMatches.length=0,this._pageMatchesLength.length=0,this._matchesCountTotal=0,this._updateAllPages();for(let i=0;i<numPages;i++)this._pendingFindMatches.has(i)||(this._pendingFindMatches.add(i),this._extractTextPromises[i].then((pageIdx=>{this._pendingFindMatches.delete(pageIdx),this._calculateMatch(pageIdx)})))}if(""===this._query)return void this._updateUIState(FindState.FOUND);if(this._resumePageIdx)return;const offset=this._offset;if(this._pagesToSearch=numPages,null!==offset.matchIdx){const numPageMatches=this._pageMatches[offset.pageIdx].length;if(!previous&&offset.matchIdx+1<numPageMatches||previous&&offset.matchIdx>0)return offset.matchIdx=previous?offset.matchIdx-1:offset.matchIdx+1,void this._updateMatch(!0);this._advanceOffsetPage(previous)}this._nextPageMatch()}_matchesReady(matches){const offset=this._offset,numMatches=matches.length,previous=this._state.findPrevious;return numMatches?(offset.matchIdx=previous?numMatches-1:0,this._updateMatch(!0),!0):(this._advanceOffsetPage(previous),!!(offset.wrapped&&(offset.matchIdx=null,this._pagesToSearch<0))&&(this._updateMatch(!1),!0))}_nextPageMatch(){null!==this._resumePageIdx&&console.error("There can only be one pending page.");let matches=null;do{const pageIdx=this._offset.pageIdx;if(matches=this._pageMatches[pageIdx],!matches){this._resumePageIdx=pageIdx;break}}while(!this._matchesReady(matches))}_advanceOffsetPage(previous){const offset=this._offset,numPages=this._linkService.pagesCount;offset.pageIdx=previous?offset.pageIdx-1:offset.pageIdx+1,offset.matchIdx=null,this._pagesToSearch--,(offset.pageIdx>=numPages||offset.pageIdx<0)&&(offset.pageIdx=previous?numPages-1:0,offset.wrapped=!0)}_updateMatch(found=!1){let state=FindState.NOT_FOUND;const wrapped=this._offset.wrapped;if(this._offset.wrapped=!1,found){const previousPage=this._selected.pageIdx;this._selected.pageIdx=this._offset.pageIdx,this._selected.matchIdx=this._offset.matchIdx,state=wrapped?FindState.WRAPPED:FindState.FOUND,-1!==previousPage&&previousPage!==this._selected.pageIdx&&this._updatePage(previousPage)}this._updateUIState(state,this._state.findPrevious),-1!==this._selected.pageIdx&&(this._scrollMatches=!0,this._updatePage(this._selected.pageIdx))}_onFindBarClose(evt){const pdfDocument=this._pdfDocument;this._firstPageCapability.promise.then((()=>{!this._pdfDocument||pdfDocument&&this._pdfDocument!==pdfDocument||(this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),this._resumePageIdx&&(this._resumePageIdx=null,this._dirtyMatch=!0),this._updateUIState(FindState.FOUND),this._highlightMatches=!1,this._updateAllPages())}))}_requestMatchesCount(){const{pageIdx:pageIdx,matchIdx:matchIdx}=this._selected;let current=0,total=this._matchesCountTotal;if(-1!==matchIdx){for(let i=0;i<pageIdx;i++)current+=this._pageMatches[i]?.length||0;current+=matchIdx+1}return(current<1||current>total)&&(current=total=0),{current:current,total:total}}_updateUIResultsCount(){this._eventBus.dispatch("updatefindmatchescount",{source:this,matchesCount:this._requestMatchesCount()})}_updateUIState(state,previous=!1){this._eventBus.dispatch("updatefindcontrolstate",{source:this,state:state,previous:previous,matchesCount:this._requestMatchesCount(),rawQuery:this._state?.query??null})}}},(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.CharacterType=void 0,exports.getCharacterType=function(charCode){if(function(charCode){return charCode<11904}(charCode))return function(charCode){return 0==(65408&charCode)}(charCode)?function(charCode){return 32===charCode||9===charCode||13===charCode||10===charCode}(charCode)?CharacterType.SPACE:function(charCode){return charCode>=97&&charCode<=122||charCode>=65&&charCode<=90}(charCode)||function(charCode){return charCode>=48&&charCode<=57}(charCode)||95===charCode?CharacterType.ALPHA_LETTER:CharacterType.PUNCT:function(charCode){return 3584==(65408&charCode)}(charCode)?CharacterType.THAI_LETTER:160===charCode?CharacterType.SPACE:CharacterType.ALPHA_LETTER;if(function(charCode){return charCode>=13312&&charCode<=40959||charCode>=63744&&charCode<=64255}(charCode))return CharacterType.HAN_LETTER;if(function(charCode){return charCode>=12448&&charCode<=12543}(charCode))return CharacterType.KATAKANA_LETTER;if(function(charCode){return charCode>=12352&&charCode<=12447}(charCode))return CharacterType.HIRAGANA_LETTER;if(function(charCode){return charCode>=65376&&charCode<=65439}(charCode))return CharacterType.HALFWIDTH_KATAKANA_LETTER;return CharacterType.ALPHA_LETTER};const CharacterType={SPACE:0,ALPHA_LETTER:1,PUNCT:2,HAN_LETTER:3,KATAKANA_LETTER:4,HIRAGANA_LETTER:5,HALFWIDTH_KATAKANA_LETTER:6,THAI_LETTER:7};exports.CharacterType=CharacterType},(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.PDFHistory=void 0,exports.isDestArraysEqual=isDestArraysEqual,exports.isDestHashesEqual=isDestHashesEqual;var _ui_utils=__webpack_require__(3),_event_utils=__webpack_require__(4);function getCurrentHash(){return document.location.hash}function isDestHashesEqual(destHash,pushHash){if("string"!=typeof destHash||"string"!=typeof pushHash)return!1;if(destHash===pushHash)return!0;return(0,_ui_utils.parseQueryString)(destHash).get("nameddest")===pushHash}function isDestArraysEqual(firstDest,secondDest){function isEntryEqual(first,second){if(typeof first!=typeof second)return!1;if(Array.isArray(first)||Array.isArray(second))return!1;if(null!==first&&"object"==typeof first&&null!==second){if(Object.keys(first).length!==Object.keys(second).length)return!1;for(const key in first)if(!isEntryEqual(first[key],second[key]))return!1;return!0}return first===second||Number.isNaN(first)&&Number.isNaN(second)}if(!Array.isArray(firstDest)||!Array.isArray(secondDest))return!1;if(firstDest.length!==secondDest.length)return!1;for(let i=0,ii=firstDest.length;i<ii;i++)if(!isEntryEqual(firstDest[i],secondDest[i]))return!1;return!0}exports.PDFHistory=class{constructor({linkService:linkService,eventBus:eventBus}){this.linkService=linkService,this.eventBus=eventBus,this._initialized=!1,this._fingerprint="",this.reset(),this._boundEvents=null,this._isViewerInPresentationMode=!1,this.eventBus._on("presentationmodechanged",(evt=>{this._isViewerInPresentationMode=evt.state!==_ui_utils.PresentationModeState.NORMAL})),this.eventBus._on("pagesinit",(()=>{this._isPagesLoaded=!1,this.eventBus._on("pagesloaded",(evt=>{this._isPagesLoaded=!!evt.pagesCount}),{once:!0})}))}initialize({fingerprint:fingerprint,resetHistory:resetHistory=!1,updateUrl:updateUrl=!1}){if(!fingerprint||"string"!=typeof fingerprint)return void console.error('PDFHistory.initialize: The "fingerprint" must be a non-empty string.');this._initialized&&this.reset();const reInitialized=""!==this._fingerprint&&this._fingerprint!==fingerprint;this._fingerprint=fingerprint,this._updateUrl=!0===updateUrl,this._initialized=!0,this._bindEvents();const state=window.history.state;if(this._popStateInProgress=!1,this._blockHashChange=0,this._currentHash=getCurrentHash(),this._numPositionUpdates=0,this._uid=this._maxUid=0,this._destination=null,this._position=null,!this._isValidState(state,!0)||resetHistory){const{hash:hash,page:page,rotation:rotation}=this._parseCurrentHash(!0);return!hash||reInitialized||resetHistory?void this._pushOrReplaceState(null,!0):void this._pushOrReplaceState({hash:hash,page:page,rotation:rotation},!0)}const destination=state.destination;this._updateInternalState(destination,state.uid,!0),void 0!==destination.rotation&&(this._initialRotation=destination.rotation),destination.dest?(this._initialBookmark=JSON.stringify(destination.dest),this._destination.page=null):destination.hash?this._initialBookmark=destination.hash:destination.page&&(this._initialBookmark=`page=${destination.page}`)}reset(){this._initialized&&(this._pageHide(),this._initialized=!1,this._unbindEvents()),this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._initialBookmark=null,this._initialRotation=null}push({namedDest:namedDest=null,explicitDest:explicitDest,pageNumber:pageNumber}){if(!this._initialized)return;if(namedDest&&"string"!=typeof namedDest)return void console.error(`PDFHistory.push: "${namedDest}" is not a valid namedDest parameter.`);if(!Array.isArray(explicitDest))return void console.error(`PDFHistory.push: "${explicitDest}" is not a valid explicitDest parameter.`);if(!this._isValidPage(pageNumber)&&(null!==pageNumber||this._destination))return void console.error(`PDFHistory.push: "${pageNumber}" is not a valid pageNumber parameter.`);const hash=namedDest||JSON.stringify(explicitDest);if(!hash)return;let forceReplace=!1;if(this._destination&&(isDestHashesEqual(this._destination.hash,hash)||isDestArraysEqual(this._destination.dest,explicitDest))){if(this._destination.page)return;forceReplace=!0}this._popStateInProgress&&!forceReplace||(this._pushOrReplaceState({dest:explicitDest,hash:hash,page:pageNumber,rotation:this.linkService.rotation},forceReplace),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then((()=>{this._popStateInProgress=!1}))))}pushPage(pageNumber){this._initialized&&(this._isValidPage(pageNumber)?this._destination?.page!==pageNumber&&(this._popStateInProgress||(this._pushOrReplaceState({dest:null,hash:`page=${pageNumber}`,page:pageNumber,rotation:this.linkService.rotation}),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then((()=>{this._popStateInProgress=!1}))))):console.error(`PDFHistory.pushPage: "${pageNumber}" is not a valid page number.`))}pushCurrentPosition(){this._initialized&&!this._popStateInProgress&&this._tryPushCurrentPosition()}back(){if(!this._initialized||this._popStateInProgress)return;const state=window.history.state;this._isValidState(state)&&state.uid>0&&window.history.back()}forward(){if(!this._initialized||this._popStateInProgress)return;const state=window.history.state;this._isValidState(state)&&state.uid<this._maxUid&&window.history.forward()}get popStateInProgress(){return this._initialized&&(this._popStateInProgress||this._blockHashChange>0)}get initialBookmark(){return this._initialized?this._initialBookmark:null}get initialRotation(){return this._initialized?this._initialRotation:null}_pushOrReplaceState(destination,forceReplace=!1){const shouldReplace=forceReplace||!this._destination,newState={fingerprint:this._fingerprint,uid:shouldReplace?this._uid:this._uid+1,destination:destination};let newUrl;if(this._updateInternalState(destination,newState.uid),this._updateUrl&&destination?.hash){const baseUrl=document.location.href.split("#")[0];baseUrl.startsWith("file://")||(newUrl=`${baseUrl}#${destination.hash}`)}shouldReplace?window.history.replaceState(newState,"",newUrl):window.history.pushState(newState,"",newUrl)}_tryPushCurrentPosition(temporary=!1){if(!this._position)return;let position=this._position;if(temporary&&(position=Object.assign(Object.create(null),this._position),position.temporary=!0),!this._destination)return void this._pushOrReplaceState(position);if(this._destination.temporary)return void this._pushOrReplaceState(position,!0);if(this._destination.hash===position.hash)return;if(!this._destination.page&&this._numPositionUpdates<=50)return;let forceReplace=!1;if(this._destination.page>=position.first&&this._destination.page<=position.page){if(void 0!==this._destination.dest||!this._destination.first)return;forceReplace=!0}this._pushOrReplaceState(position,forceReplace)}_isValidPage(val){return Number.isInteger(val)&&val>0&&val<=this.linkService.pagesCount}_isValidState(state,checkReload=!1){if(!state)return!1;if(state.fingerprint!==this._fingerprint){if(!checkReload)return!1;{if("string"!=typeof state.fingerprint||state.fingerprint.length!==this._fingerprint.length)return!1;const[perfEntry]=performance.getEntriesByType("navigation");if("reload"!==perfEntry?.type)return!1}}return!(!Number.isInteger(state.uid)||state.uid<0)&&(null!==state.destination&&"object"==typeof state.destination)}_updateInternalState(destination,uid,removeTemporary=!1){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),removeTemporary&&destination?.temporary&&delete destination.temporary,this._destination=destination,this._uid=uid,this._maxUid=Math.max(this._maxUid,uid),this._numPositionUpdates=0}_parseCurrentHash(checkNameddest=!1){const hash=unescape(getCurrentHash()).substring(1),params=(0,_ui_utils.parseQueryString)(hash),nameddest=params.get("nameddest")||"";let page=0|params.get("page");return(!this._isValidPage(page)||checkNameddest&&nameddest.length>0)&&(page=null),{hash:hash,page:page,rotation:this.linkService.rotation}}_updateViewarea({location:location}){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._position={hash:this._isViewerInPresentationMode?`page=${location.pageNumber}`:location.pdfOpenParams.substring(1),page:this.linkService.page,first:location.pageNumber,rotation:location.rotation},this._popStateInProgress||(this._isPagesLoaded&&this._destination&&!this._destination.page&&this._numPositionUpdates++,this._updateViewareaTimeout=setTimeout((()=>{this._popStateInProgress||this._tryPushCurrentPosition(!0),this._updateViewareaTimeout=null}),1e3))}_popState({state:state}){const newHash=getCurrentHash(),hashChanged=this._currentHash!==newHash;if(this._currentHash=newHash,!state){this._uid++;const{hash:hash,page:page,rotation:rotation}=this._parseCurrentHash();return void this._pushOrReplaceState({hash:hash,page:page,rotation:rotation},!0)}if(!this._isValidState(state))return;this._popStateInProgress=!0,hashChanged&&(this._blockHashChange++,(0,_event_utils.waitOnEventOrTimeout)({target:window,name:"hashchange",delay:1e3}).then((()=>{this._blockHashChange--})));const destination=state.destination;this._updateInternalState(destination,state.uid,!0),(0,_ui_utils.isValidRotation)(destination.rotation)&&(this.linkService.rotation=destination.rotation),destination.dest?this.linkService.goToDestination(destination.dest):destination.hash?this.linkService.setHash(destination.hash):destination.page&&(this.linkService.page=destination.page),Promise.resolve().then((()=>{this._popStateInProgress=!1}))}_pageHide(){this._destination&&!this._destination.temporary||this._tryPushCurrentPosition()}_bindEvents(){this._boundEvents||(this._boundEvents={updateViewarea:this._updateViewarea.bind(this),popState:this._popState.bind(this),pageHide:this._pageHide.bind(this)},this.eventBus._on("updateviewarea",this._boundEvents.updateViewarea),window.addEventListener("popstate",this._boundEvents.popState),window.addEventListener("pagehide",this._boundEvents.pageHide))}_unbindEvents(){this._boundEvents&&(this.eventBus._off("updateviewarea",this._boundEvents.updateViewarea),window.removeEventListener("popstate",this._boundEvents.popState),window.removeEventListener("pagehide",this._boundEvents.pageHide),this._boundEvents=null)}}},(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.PDFLayerViewer=void 0;var _base_tree_viewer=__webpack_require__(12);class PDFLayerViewer extends _base_tree_viewer.BaseTreeViewer{constructor(options){super(options),this.l10n=options.l10n,this.eventBus._on("resetlayers",this._resetLayers.bind(this)),this.eventBus._on("togglelayerstree",this._toggleAllTreeItems.bind(this))}reset(){super.reset(),this._optionalContentConfig=null}_dispatchEvent(layersCount){this.eventBus.dispatch("layersloaded",{source:this,layersCount:layersCount})}_bindLink(element,{groupId:groupId,input:input}){const setVisibility=()=>{this._optionalContentConfig.setVisibility(groupId,input.checked),this.eventBus.dispatch("optionalcontentconfig",{source:this,promise:Promise.resolve(this._optionalContentConfig)})};element.onclick=evt=>evt.target===input?(setVisibility(),!0):evt.target!==element||(input.checked=!input.checked,setVisibility(),!1)}async _setNestedName(element,{name:name=null}){"string"!=typeof name?(element.textContent=await this.l10n.get("additional_layers"),element.style.fontStyle="italic"):element.textContent=this._normalizeTextContent(name)}_addToggleButton(div,{name:name=null}){super._addToggleButton(div,null===name)}_toggleAllTreeItems(){this._optionalContentConfig&&super._toggleAllTreeItems()}render({optionalContentConfig:optionalContentConfig,pdfDocument:pdfDocument}){this._optionalContentConfig&&this.reset(),this._optionalContentConfig=optionalContentConfig||null,this._pdfDocument=pdfDocument||null;const groups=optionalContentConfig?.getOrder();if(!groups)return void this._dispatchEvent(0);const fragment=document.createDocumentFragment(),queue=[{parent:fragment,groups:groups}];let layersCount=0,hasAnyNesting=!1;for(;queue.length>0;){const levelData=queue.shift();for(const groupId of levelData.groups){const div=document.createElement("div");div.className="treeItem";const element=document.createElement("a");if(div.appendChild(element),"object"==typeof groupId){hasAnyNesting=!0,this._addToggleButton(div,groupId),this._setNestedName(element,groupId);const itemsDiv=document.createElement("div");itemsDiv.className="treeItems",div.appendChild(itemsDiv),queue.push({parent:itemsDiv,groups:groupId.order})}else{const group=optionalContentConfig.getGroup(groupId),input=document.createElement("input");this._bindLink(element,{groupId:groupId,input:input}),input.type="checkbox",input.id=groupId,input.checked=group.visible;const label=document.createElement("label");label.setAttribute("for",groupId),label.textContent=this._normalizeTextContent(group.name),element.appendChild(input),element.appendChild(label),layersCount++}levelData.parent.appendChild(div)}}this._finishRendering(fragment,layersCount,hasAnyNesting)}async _resetLayers(){if(!this._optionalContentConfig)return;const optionalContentConfig=await this._pdfDocument.getOptionalContentConfig();this.eventBus.dispatch("optionalcontentconfig",{source:this,promise:Promise.resolve(optionalContentConfig)}),this.render({optionalContentConfig:optionalContentConfig,pdfDocument:this._pdfDocument})}}exports.PDFLayerViewer=PDFLayerViewer},(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.PDFOutlineViewer=void 0;var _base_tree_viewer=__webpack_require__(12),_pdfjsLib=__webpack_require__(5),_ui_utils=__webpack_require__(3);class PDFOutlineViewer extends _base_tree_viewer.BaseTreeViewer{constructor(options){super(options),this.linkService=options.linkService,this.eventBus._on("toggleoutlinetree",this._toggleAllTreeItems.bind(this)),this.eventBus._on("currentoutlineitem",this._currentOutlineItem.bind(this)),this.eventBus._on("pagechanging",(evt=>{this._currentPageNumber=evt.pageNumber})),this.eventBus._on("pagesloaded",(evt=>{this._isPagesLoaded=!!evt.pagesCount,this._currentOutlineItemCapability&&!this._currentOutlineItemCapability.settled&&this._currentOutlineItemCapability.resolve(this._isPagesLoaded)})),this.eventBus._on("sidebarviewchanged",(evt=>{this._sidebarView=evt.view}))}reset(){super.reset(),this._outline=null,this._pageNumberToDestHashCapability=null,this._currentPageNumber=1,this._isPagesLoaded=null,this._currentOutlineItemCapability&&!this._currentOutlineItemCapability.settled&&this._currentOutlineItemCapability.resolve(!1),this._currentOutlineItemCapability=null}_dispatchEvent(outlineCount){this._currentOutlineItemCapability=(0,_pdfjsLib.createPromiseCapability)(),0===outlineCount||this._pdfDocument?.loadingParams.disableAutoFetch?this._currentOutlineItemCapability.resolve(!1):null!==this._isPagesLoaded&&this._currentOutlineItemCapability.resolve(this._isPagesLoaded),this.eventBus.dispatch("outlineloaded",{source:this,outlineCount:outlineCount,currentOutlineItemPromise:this._currentOutlineItemCapability.promise})}_bindLink(element,{url:url,newWindow:newWindow,dest:dest}){const{linkService:linkService}=this;url?linkService.addLinkAttributes(element,url,newWindow):(element.href=linkService.getDestinationHash(dest),element.onclick=evt=>(this._updateCurrentTreeItem(evt.target.parentNode),dest&&linkService.goToDestination(dest),!1))}_setStyles(element,{bold:bold,italic:italic}){bold&&(element.style.fontWeight="bold"),italic&&(element.style.fontStyle="italic")}_addToggleButton(div,{count:count,items:items}){let hidden=!1;if(count<0){let totalCount=items.length;if(totalCount>0){const queue=[...items];for(;queue.length>0;){const{count:nestedCount,items:nestedItems}=queue.shift();nestedCount>0&&nestedItems.length>0&&(totalCount+=nestedItems.length,queue.push(...nestedItems))}}Math.abs(count)===totalCount&&(hidden=!0)}super._addToggleButton(div,hidden)}_toggleAllTreeItems(){this._outline&&super._toggleAllTreeItems()}render({outline:outline,pdfDocument:pdfDocument}){if(this._outline&&this.reset(),this._outline=outline||null,this._pdfDocument=pdfDocument||null,!outline)return void this._dispatchEvent(0);const fragment=document.createDocumentFragment(),queue=[{parent:fragment,items:outline}];let outlineCount=0,hasAnyNesting=!1;for(;queue.length>0;){const levelData=queue.shift();for(const item of levelData.items){const div=document.createElement("div");div.className="treeItem";const element=document.createElement("a");if(this._bindLink(element,item),this._setStyles(element,item),element.textContent=this._normalizeTextContent(item.title),div.appendChild(element),item.items.length>0){hasAnyNesting=!0,this._addToggleButton(div,item);const itemsDiv=document.createElement("div");itemsDiv.className="treeItems",div.appendChild(itemsDiv),queue.push({parent:itemsDiv,items:item.items})}levelData.parent.appendChild(div),outlineCount++}}this._finishRendering(fragment,outlineCount,hasAnyNesting)}async _currentOutlineItem(){if(!this._isPagesLoaded)throw new Error("_currentOutlineItem: All pages have not been loaded.");if(!this._outline||!this._pdfDocument)return;const pageNumberToDestHash=await this._getPageNumberToDestHash(this._pdfDocument);if(pageNumberToDestHash&&(this._updateCurrentTreeItem(null),this._sidebarView===_ui_utils.SidebarView.OUTLINE))for(let i=this._currentPageNumber;i>0;i--){const destHash=pageNumberToDestHash.get(i);if(!destHash)continue;const linkElement=this.container.querySelector(`a[href="${destHash}"]`);if(linkElement){this._scrollToCurrentTreeItem(linkElement.parentNode);break}}}async _getPageNumberToDestHash(pdfDocument){if(this._pageNumberToDestHashCapability)return this._pageNumberToDestHashCapability.promise;this._pageNumberToDestHashCapability=(0,_pdfjsLib.createPromiseCapability)();const pageNumberToDestHash=new Map,pageNumberNesting=new Map,queue=[{nesting:0,items:this._outline}];for(;queue.length>0;){const levelData=queue.shift(),currentNesting=levelData.nesting;for(const{dest:dest,items:items}of levelData.items){let explicitDest,pageNumber;if("string"==typeof dest){if(explicitDest=await pdfDocument.getDestination(dest),pdfDocument!==this._pdfDocument)return null}else explicitDest=dest;if(Array.isArray(explicitDest)){const[destRef]=explicitDest;if("object"==typeof destRef&&null!==destRef){if(pageNumber=this.linkService._cachedPageNumber(destRef),!pageNumber)try{if(pageNumber=await pdfDocument.getPageIndex(destRef)+1,pdfDocument!==this._pdfDocument)return null;this.linkService.cachePageRef(pageNumber,destRef)}catch(ex){}}else Number.isInteger(destRef)&&(pageNumber=destRef+1);if(Number.isInteger(pageNumber)&&(!pageNumberToDestHash.has(pageNumber)||currentNesting>pageNumberNesting.get(pageNumber))){const destHash=this.linkService.getDestinationHash(dest);pageNumberToDestHash.set(pageNumber,destHash),pageNumberNesting.set(pageNumber,currentNesting)}}items.length>0&&queue.push({nesting:currentNesting+1,items:items})}}return this._pageNumberToDestHashCapability.resolve(pageNumberToDestHash.size>0?pageNumberToDestHash:null),this._pageNumberToDestHashCapability.promise}}exports.PDFOutlineViewer=PDFOutlineViewer},(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.PDFPresentationMode=void 0;var _ui_utils=__webpack_require__(3);const SWIPE_ANGLE_THRESHOLD=Math.PI/6;exports.PDFPresentationMode=class{constructor({container:container,pdfViewer:pdfViewer,eventBus:eventBus}){this.container=container,this.pdfViewer=pdfViewer,this.eventBus=eventBus,this.active=!1,this.args=null,this.contextMenuOpen=!1,this.mouseScrollTimeStamp=0,this.mouseScrollDelta=0,this.touchSwipeState=null}request(){return!(this.switchInProgress||this.active||!this.pdfViewer.pagesCount||!this.container.requestFullscreen)&&(this.#addFullscreenChangeListeners(),this.#setSwitchInProgress(),this.#notifyStateChange(),this.container.requestFullscreen(),this.args={pageNumber:this.pdfViewer.currentPageNumber,scaleValue:this.pdfViewer.currentScaleValue,scrollMode:this.pdfViewer.scrollMode,spreadMode:this.pdfViewer.spreadMode},!0)}#mouseWheel(evt){if(!this.active)return;evt.preventDefault();const delta=(0,_ui_utils.normalizeWheelEventDelta)(evt),currentTime=Date.now(),storedTime=this.mouseScrollTimeStamp;if(!(currentTime>storedTime&&currentTime-storedTime<50)&&((this.mouseScrollDelta>0&&delta<0||this.mouseScrollDelta<0&&delta>0)&&this.#resetMouseScrollState(),this.mouseScrollDelta+=delta,Math.abs(this.mouseScrollDelta)>=.1)){const totalDelta=this.mouseScrollDelta;this.#resetMouseScrollState();(totalDelta>0?this.pdfViewer.previousPage():this.pdfViewer.nextPage())&&(this.mouseScrollTimeStamp=currentTime)}}#notifyStateChange(){let state=_ui_utils.PresentationModeState.NORMAL;this.switchInProgress?state=_ui_utils.PresentationModeState.CHANGING:this.active&&(state=_ui_utils.PresentationModeState.FULLSCREEN),this.eventBus.dispatch("presentationmodechanged",{source:this,state:state})}#setSwitchInProgress(){this.switchInProgress&&clearTimeout(this.switchInProgress),this.switchInProgress=setTimeout((()=>{this.#removeFullscreenChangeListeners(),delete this.switchInProgress,this.#notifyStateChange()}),1500)}#resetSwitchInProgress(){this.switchInProgress&&(clearTimeout(this.switchInProgress),delete this.switchInProgress)}#enter(){this.active=!0,this.#resetSwitchInProgress(),this.#notifyStateChange(),this.container.classList.add("pdfPresentationMode"),setTimeout((()=>{this.pdfViewer.scrollMode=_ui_utils.ScrollMode.PAGE,this.pdfViewer.spreadMode=_ui_utils.SpreadMode.NONE,this.pdfViewer.currentPageNumber=this.args.pageNumber,this.pdfViewer.currentScaleValue="page-fit"}),0),this.#addWindowListeners(),this.#showControls(),this.contextMenuOpen=!1,window.getSelection().removeAllRanges()}#exit(){const pageNumber=this.pdfViewer.currentPageNumber;this.container.classList.remove("pdfPresentationMode"),setTimeout((()=>{this.active=!1,this.#removeFullscreenChangeListeners(),this.#notifyStateChange(),this.pdfViewer.scrollMode=this.args.scrollMode,this.pdfViewer.spreadMode=this.args.spreadMode,this.pdfViewer.currentScaleValue=this.args.scaleValue,this.pdfViewer.currentPageNumber=pageNumber,this.args=null}),0),this.#removeWindowListeners(),this.#hideControls(),this.#resetMouseScrollState(),this.contextMenuOpen=!1}#mouseDown(evt){if(this.contextMenuOpen)return this.contextMenuOpen=!1,void evt.preventDefault();if(0===evt.button){evt.target.href&&evt.target.classList.contains("internalLink")||(evt.preventDefault(),evt.shiftKey?this.pdfViewer.previousPage():this.pdfViewer.nextPage())}}#contextMenu(){this.contextMenuOpen=!0}#showControls(){this.controlsTimeout?clearTimeout(this.controlsTimeout):this.container.classList.add("pdfPresentationModeControls"),this.controlsTimeout=setTimeout((()=>{this.container.classList.remove("pdfPresentationModeControls"),delete this.controlsTimeout}),3e3)}#hideControls(){this.controlsTimeout&&(clearTimeout(this.controlsTimeout),this.container.classList.remove("pdfPresentationModeControls"),delete this.controlsTimeout)}#resetMouseScrollState(){this.mouseScrollTimeStamp=0,this.mouseScrollDelta=0}#touchSwipe(evt){if(this.active)if(evt.touches.length>1)this.touchSwipeState=null;else switch(evt.type){case"touchstart":this.touchSwipeState={startX:evt.touches[0].pageX,startY:evt.touches[0].pageY,endX:evt.touches[0].pageX,endY:evt.touches[0].pageY};break;case"touchmove":if(null===this.touchSwipeState)return;this.touchSwipeState.endX=evt.touches[0].pageX,this.touchSwipeState.endY=evt.touches[0].pageY,evt.preventDefault();break;case"touchend":if(null===this.touchSwipeState)return;let delta=0;const dx=this.touchSwipeState.endX-this.touchSwipeState.startX,dy=this.touchSwipeState.endY-this.touchSwipeState.startY,absAngle=Math.abs(Math.atan2(dy,dx));Math.abs(dx)>50&&(absAngle<=SWIPE_ANGLE_THRESHOLD||absAngle>=Math.PI-SWIPE_ANGLE_THRESHOLD)?delta=dx:Math.abs(dy)>50&&Math.abs(absAngle-Math.PI/2)<=SWIPE_ANGLE_THRESHOLD&&(delta=dy),delta>0?this.pdfViewer.previousPage():delta<0&&this.pdfViewer.nextPage()}}#addWindowListeners(){this.showControlsBind=this.#showControls.bind(this),this.mouseDownBind=this.#mouseDown.bind(this),this.mouseWheelBind=this.#mouseWheel.bind(this),this.resetMouseScrollStateBind=this.#resetMouseScrollState.bind(this),this.contextMenuBind=this.#contextMenu.bind(this),this.touchSwipeBind=this.#touchSwipe.bind(this),window.addEventListener("mousemove",this.showControlsBind),window.addEventListener("mousedown",this.mouseDownBind),window.addEventListener("wheel",this.mouseWheelBind,{passive:!1}),window.addEventListener("keydown",this.resetMouseScrollStateBind),window.addEventListener("contextmenu",this.contextMenuBind),window.addEventListener("touchstart",this.touchSwipeBind),window.addEventListener("touchmove",this.touchSwipeBind),window.addEventListener("touchend",this.touchSwipeBind)}#removeWindowListeners(){window.removeEventListener("mousemove",this.showControlsBind),window.removeEventListener("mousedown",this.mouseDownBind),window.removeEventListener("wheel",this.mouseWheelBind,{passive:!1}),window.removeEventListener("keydown",this.resetMouseScrollStateBind),window.removeEventListener("contextmenu",this.contextMenuBind),window.removeEventListener("touchstart",this.touchSwipeBind),window.removeEventListener("touchmove",this.touchSwipeBind),window.removeEventListener("touchend",this.touchSwipeBind),delete this.showControlsBind,delete this.mouseDownBind,delete this.mouseWheelBind,delete this.resetMouseScrollStateBind,delete this.contextMenuBind,delete this.touchSwipeBind}#fullscreenChange(){document.fullscreenElement?this.#enter():this.#exit()}#addFullscreenChangeListeners(){this.fullscreenChangeBind=this.#fullscreenChange.bind(this),window.addEventListener("fullscreenchange",this.fullscreenChangeBind)}#removeFullscreenChangeListeners(){window.removeEventListener("fullscreenchange",this.fullscreenChangeBind),delete this.fullscreenChangeBind}}},(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.PDFRenderingQueue=void 0;var _pdfjsLib=__webpack_require__(5),_ui_utils=__webpack_require__(3);exports.PDFRenderingQueue=class{constructor(){this.pdfViewer=null,this.pdfThumbnailViewer=null,this.onIdle=null,this.highestPriorityPage=null,this.idleTimeout=null,this.printing=!1,this.isThumbnailViewEnabled=!1}setViewer(pdfViewer){this.pdfViewer=pdfViewer}setThumbnailViewer(pdfThumbnailViewer){this.pdfThumbnailViewer=pdfThumbnailViewer}isHighestPriority(view){return this.highestPriorityPage===view.renderingId}hasViewer(){return!!this.pdfViewer}renderHighestPriority(currentlyVisiblePages){this.idleTimeout&&(clearTimeout(this.idleTimeout),this.idleTimeout=null),this.pdfViewer.forceRendering(currentlyVisiblePages)||this.isThumbnailViewEnabled&&this.pdfThumbnailViewer?.forceRendering()||this.printing||this.onIdle&&(this.idleTimeout=setTimeout(this.onIdle.bind(this),3e4))}getHighestPriority(visible,views,scrolledDown,preRenderExtra=!1){const visibleViews=visible.views,numVisible=visibleViews.length;if(0===numVisible)return null;for(let i=0;i<numVisible;i++){const view=visibleViews[i].view;if(!this.isViewFinished(view))return view}const firstId=visible.first.id,lastId=visible.last.id;if(lastId-firstId+1>numVisible){const visibleIds=visible.ids;for(let i=1,ii=lastId-firstId;i<ii;i++){const holeId=scrolledDown?firstId+i:lastId-i;if(visibleIds.has(holeId))continue;const holeView=views[holeId-1];if(!this.isViewFinished(holeView))return holeView}}let preRenderIndex=scrolledDown?lastId:firstId-2,preRenderView=views[preRenderIndex];return preRenderView&&!this.isViewFinished(preRenderView)||preRenderExtra&&(preRenderIndex+=scrolledDown?1:-1,preRenderView=views[preRenderIndex],preRenderView&&!this.isViewFinished(preRenderView))?preRenderView:null}isViewFinished(view){return view.renderingState===_ui_utils.RenderingStates.FINISHED}renderView(view){switch(view.renderingState){case _ui_utils.RenderingStates.FINISHED:return!1;case _ui_utils.RenderingStates.PAUSED:this.highestPriorityPage=view.renderingId,view.resume();break;case _ui_utils.RenderingStates.RUNNING:this.highestPriorityPage=view.renderingId;break;case _ui_utils.RenderingStates.INITIAL:this.highestPriorityPage=view.renderingId,view.draw().finally((()=>{this.renderHighestPriority()})).catch((reason=>{reason instanceof _pdfjsLib.RenderingCancelledException||console.error(`renderView: "${reason}"`)}))}return!0}}},(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.PDFScriptingManager=void 0;var _ui_utils=__webpack_require__(3),_pdfjsLib=__webpack_require__(5);exports.PDFScriptingManager=class{constructor({eventBus:eventBus,sandboxBundleSrc:sandboxBundleSrc=null,scriptingFactory:scriptingFactory=null,docPropertiesLookup:docPropertiesLookup=null}){this._pdfDocument=null,this._pdfViewer=null,this._closeCapability=null,this._destroyCapability=null,this._scripting=null,this._mouseState=Object.create(null),this._ready=!1,this._eventBus=eventBus,this._sandboxBundleSrc=sandboxBundleSrc,this._scriptingFactory=scriptingFactory,this._docPropertiesLookup=docPropertiesLookup}setViewer(pdfViewer){this._pdfViewer=pdfViewer}async setDocument(pdfDocument){if(this._pdfDocument&&await this._destroyScripting(),this._pdfDocument=pdfDocument,!pdfDocument)return;const[objects,calculationOrder,docActions]=await Promise.all([pdfDocument.getFieldObjects(),pdfDocument.getCalculationOrderIds(),pdfDocument.getJSActions()]);if(objects||docActions){if(pdfDocument===this._pdfDocument){try{this._scripting=this._createScripting()}catch(error){return console.error(`PDFScriptingManager.setDocument: "${error?.message}".`),void await this._destroyScripting()}this._internalEvents.set("updatefromsandbox",(event=>{event?.source===window&&this._updateFromSandbox(event.detail)})),this._internalEvents.set("dispatcheventinsandbox",(event=>{this._scripting?.dispatchEventInSandbox(event.detail)})),this._internalEvents.set("pagechanging",(({pageNumber:pageNumber,previous:previous})=>{pageNumber!==previous&&(this._dispatchPageClose(previous),this._dispatchPageOpen(pageNumber))})),this._internalEvents.set("pagerendered",(({pageNumber:pageNumber})=>{this._pageOpenPending.has(pageNumber)&&pageNumber===this._pdfViewer.currentPageNumber&&this._dispatchPageOpen(pageNumber)})),this._internalEvents.set("pagesdestroy",(async event=>{await this._dispatchPageClose(this._pdfViewer.currentPageNumber),await(this._scripting?.dispatchEventInSandbox({id:"doc",name:"WillClose"})),this._closeCapability?.resolve()})),this._domEvents.set("mousedown",(event=>{this._mouseState.isDown=!0})),this._domEvents.set("mouseup",(event=>{this._mouseState.isDown=!1}));for(const[name,listener]of this._internalEvents)this._eventBus._on(name,listener);for(const[name,listener]of this._domEvents)window.addEventListener(name,listener);try{const docProperties=await this._getDocProperties();if(pdfDocument!==this._pdfDocument)return;await this._scripting.createSandbox({objects:objects,calculationOrder:calculationOrder,appInfo:{platform:navigator.platform,language:navigator.language},docInfo:{...docProperties,actions:docActions}}),this._eventBus.dispatch("sandboxcreated",{source:this})}catch(error){return console.error(`PDFScriptingManager.setDocument: "${error?.message}".`),void await this._destroyScripting()}await(this._scripting?.dispatchEventInSandbox({id:"doc",name:"Open"})),await this._dispatchPageOpen(this._pdfViewer.currentPageNumber,!0),Promise.resolve().then((()=>{pdfDocument===this._pdfDocument&&(this._ready=!0)}))}}else await this._destroyScripting()}async dispatchWillSave(detail){return this._scripting?.dispatchEventInSandbox({id:"doc",name:"WillSave"})}async dispatchDidSave(detail){return this._scripting?.dispatchEventInSandbox({id:"doc",name:"DidSave"})}async dispatchWillPrint(detail){return this._scripting?.dispatchEventInSandbox({id:"doc",name:"WillPrint"})}async dispatchDidPrint(detail){return this._scripting?.dispatchEventInSandbox({id:"doc",name:"DidPrint"})}get mouseState(){return this._mouseState}get destroyPromise(){return this._destroyCapability?.promise||null}get ready(){return this._ready}get _internalEvents(){return(0,_pdfjsLib.shadow)(this,"_internalEvents",new Map)}get _domEvents(){return(0,_pdfjsLib.shadow)(this,"_domEvents",new Map)}get _pageOpenPending(){return(0,_pdfjsLib.shadow)(this,"_pageOpenPending",new Set)}get _visitedPages(){return(0,_pdfjsLib.shadow)(this,"_visitedPages",new Map)}async _updateFromSandbox(detail){const isInPresentationMode=this._pdfViewer.isInPresentationMode||this._pdfViewer.isChangingPresentationMode,{id:id,siblings:siblings,command:command,value:value}=detail;if(!id){switch(command){case"clear":console.clear();break;case"error":console.error(value);break;case"layout":if(isInPresentationMode)return;const modes=(0,_ui_utils.apiPageLayoutToViewerModes)(value);this._pdfViewer.spreadMode=modes.spreadMode;break;case"page-num":this._pdfViewer.currentPageNumber=value+1;break;case"print":await this._pdfViewer.pagesPromise,this._eventBus.dispatch("print",{source:this});break;case"println":console.log(value);break;case"zoom":if(isInPresentationMode)return;this._pdfViewer.currentScaleValue=value;break;case"SaveAs":this._eventBus.dispatch("save",{source:this});break;case"FirstPage":this._pdfViewer.currentPageNumber=1;break;case"LastPage":this._pdfViewer.currentPageNumber=this._pdfViewer.pagesCount;break;case"NextPage":this._pdfViewer.nextPage();break;case"PrevPage":this._pdfViewer.previousPage();break;case"ZoomViewIn":if(isInPresentationMode)return;this._pdfViewer.increaseScale();break;case"ZoomViewOut":if(isInPresentationMode)return;this._pdfViewer.decreaseScale()}return}if(isInPresentationMode&&detail.focus)return;delete detail.id,delete detail.siblings;const ids=siblings?[id,...siblings]:[id];for(const elementId of ids){const element=document.getElementById(elementId);element?element.dispatchEvent(new CustomEvent("updatefromsandbox",{detail:detail})):this._pdfDocument?.annotationStorage.setValue(elementId,detail)}}async _dispatchPageOpen(pageNumber,initialize=!1){const pdfDocument=this._pdfDocument,visitedPages=this._visitedPages;if(initialize&&(this._closeCapability=(0,_pdfjsLib.createPromiseCapability)()),!this._closeCapability)return;const pageView=this._pdfViewer.getPageView(pageNumber-1);if(pageView?.renderingState!==_ui_utils.RenderingStates.FINISHED)return void this._pageOpenPending.add(pageNumber);this._pageOpenPending.delete(pageNumber);const actionsPromise=(async()=>{const actions=await(visitedPages.has(pageNumber)?null:pageView.pdfPage?.getJSActions());pdfDocument===this._pdfDocument&&await(this._scripting?.dispatchEventInSandbox({id:"page",name:"PageOpen",pageNumber:pageNumber,actions:actions}))})();visitedPages.set(pageNumber,actionsPromise)}async _dispatchPageClose(pageNumber){const pdfDocument=this._pdfDocument,visitedPages=this._visitedPages;if(!this._closeCapability)return;if(this._pageOpenPending.has(pageNumber))return;const actionsPromise=visitedPages.get(pageNumber);actionsPromise&&(visitedPages.set(pageNumber,null),await actionsPromise,pdfDocument===this._pdfDocument&&await(this._scripting?.dispatchEventInSandbox({id:"page",name:"PageClose",pageNumber:pageNumber})))}async _getDocProperties(){if(this._docPropertiesLookup)return this._docPropertiesLookup(this._pdfDocument);throw new Error("_getDocProperties: Unable to lookup properties.")}_createScripting(){if(this._destroyCapability=(0,_pdfjsLib.createPromiseCapability)(),this._scripting)throw new Error("_createScripting: Scripting already exists.");if(this._scriptingFactory)return this._scriptingFactory.createScripting({sandboxBundleSrc:this._sandboxBundleSrc});throw new Error("_createScripting: Cannot create scripting.")}async _destroyScripting(){if(!this._scripting)return this._pdfDocument=null,void this._destroyCapability?.resolve();this._closeCapability&&(await Promise.race([this._closeCapability.promise,new Promise((resolve=>{setTimeout(resolve,1e3)}))]).catch((reason=>{})),this._closeCapability=null),this._pdfDocument=null;try{await this._scripting.destroySandbox()}catch(ex){}for(const[name,listener]of this._internalEvents)this._eventBus._off(name,listener);this._internalEvents.clear();for(const[name,listener]of this._domEvents)window.removeEventListener(name,listener);this._domEvents.clear(),this._pageOpenPending.clear(),this._visitedPages.clear(),this._scripting=null,delete this._mouseState.isDown,this._ready=!1,this._destroyCapability?.resolve()}}},(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.PDFSidebar=void 0;var _ui_utils=__webpack_require__(3);exports.PDFSidebar=class{constructor({elements:elements,pdfViewer:pdfViewer,pdfThumbnailViewer:pdfThumbnailViewer,eventBus:eventBus,l10n:l10n}){this.isOpen=!1,this.active=_ui_utils.SidebarView.THUMBS,this.isInitialViewSet=!1,this.onToggled=null,this.pdfViewer=pdfViewer,this.pdfThumbnailViewer=pdfThumbnailViewer,this.outerContainer=elements.outerContainer,this.viewerContainer=elements.viewerContainer,this.toggleButton=elements.toggleButton,this.thumbnailButton=elements.thumbnailButton,this.outlineButton=elements.outlineButton,this.attachmentsButton=elements.attachmentsButton,this.layersButton=elements.layersButton,this.thumbnailView=elements.thumbnailView,this.outlineView=elements.outlineView,this.attachmentsView=elements.attachmentsView,this.layersView=elements.layersView,this._outlineOptionsContainer=elements.outlineOptionsContainer,this._currentOutlineItemButton=elements.currentOutlineItemButton,this.eventBus=eventBus,this.l10n=l10n,this._addEventListeners()}reset(){this.isInitialViewSet=!1,this._hideUINotification(!0),this.switchView(_ui_utils.SidebarView.THUMBS),this.outlineButton.disabled=!1,this.attachmentsButton.disabled=!1,this.layersButton.disabled=!1,this._currentOutlineItemButton.disabled=!0}get visibleView(){return this.isOpen?this.active:_ui_utils.SidebarView.NONE}get isThumbnailViewVisible(){return this.isOpen&&this.active===_ui_utils.SidebarView.THUMBS}get isOutlineViewVisible(){return this.isOpen&&this.active===_ui_utils.SidebarView.OUTLINE}get isAttachmentsViewVisible(){return this.isOpen&&this.active===_ui_utils.SidebarView.ATTACHMENTS}get isLayersViewVisible(){return this.isOpen&&this.active===_ui_utils.SidebarView.LAYERS}setInitialView(view=_ui_utils.SidebarView.NONE){this.isInitialViewSet||(this.isInitialViewSet=!0,view!==_ui_utils.SidebarView.NONE&&view!==_ui_utils.SidebarView.UNKNOWN&&this._switchView(view,!0)||this._dispatchEvent())}switchView(view,forceOpen=!1){this._switchView(view,forceOpen)}_switchView(view,forceOpen=!1){const isViewChanged=view!==this.active;let shouldForceRendering=!1;switch(view){case _ui_utils.SidebarView.NONE:return!!this.isOpen&&(this.close(),!0);case _ui_utils.SidebarView.THUMBS:this.isOpen&&isViewChanged&&(shouldForceRendering=!0);break;case _ui_utils.SidebarView.OUTLINE:if(this.outlineButton.disabled)return!1;break;case _ui_utils.SidebarView.ATTACHMENTS:if(this.attachmentsButton.disabled)return!1;break;case _ui_utils.SidebarView.LAYERS:if(this.layersButton.disabled)return!1;break;default:return console.error(`PDFSidebar._switchView: "${view}" is not a valid view.`),!1}return this.active=view,this.thumbnailButton.classList.toggle("toggled",view===_ui_utils.SidebarView.THUMBS),this.outlineButton.classList.toggle("toggled",view===_ui_utils.SidebarView.OUTLINE),this.attachmentsButton.classList.toggle("toggled",view===_ui_utils.SidebarView.ATTACHMENTS),this.layersButton.classList.toggle("toggled",view===_ui_utils.SidebarView.LAYERS),this.thumbnailView.classList.toggle("hidden",view!==_ui_utils.SidebarView.THUMBS),this.outlineView.classList.toggle("hidden",view!==_ui_utils.SidebarView.OUTLINE),this.attachmentsView.classList.toggle("hidden",view!==_ui_utils.SidebarView.ATTACHMENTS),this.layersView.classList.toggle("hidden",view!==_ui_utils.SidebarView.LAYERS),this._outlineOptionsContainer.classList.toggle("hidden",view!==_ui_utils.SidebarView.OUTLINE),forceOpen&&!this.isOpen?(this.open(),!0):(shouldForceRendering&&(this._updateThumbnailViewer(),this._forceRendering()),isViewChanged&&this._dispatchEvent(),isViewChanged)}open(){this.isOpen||(this.isOpen=!0,this.toggleButton.classList.add("toggled"),this.toggleButton.setAttribute("aria-expanded","true"),this.outerContainer.classList.add("sidebarMoving","sidebarOpen"),this.active===_ui_utils.SidebarView.THUMBS&&this._updateThumbnailViewer(),this._forceRendering(),this._dispatchEvent(),this._hideUINotification())}close(){this.isOpen&&(this.isOpen=!1,this.toggleButton.classList.remove("toggled"),this.toggleButton.setAttribute("aria-expanded","false"),this.outerContainer.classList.add("sidebarMoving"),this.outerContainer.classList.remove("sidebarOpen"),this._forceRendering(),this._dispatchEvent())}toggle(){this.isOpen?this.close():this.open()}_dispatchEvent(){this.eventBus.dispatch("sidebarviewchanged",{source:this,view:this.visibleView})}_forceRendering(){this.onToggled?this.onToggled():(this.pdfViewer.forceRendering(),this.pdfThumbnailViewer.forceRendering())}_updateThumbnailViewer(){const{pdfViewer:pdfViewer,pdfThumbnailViewer:pdfThumbnailViewer}=this,pagesCount=pdfViewer.pagesCount;for(let pageIndex=0;pageIndex<pagesCount;pageIndex++){const pageView=pdfViewer.getPageView(pageIndex);if(pageView?.renderingState===_ui_utils.RenderingStates.FINISHED){pdfThumbnailViewer.getThumbnail(pageIndex).setImage(pageView)}}pdfThumbnailViewer.scrollThumbnailIntoView(pdfViewer.currentPageNumber)}_showUINotification(){this.l10n.get("toggle_sidebar_notification2.title").then((msg=>{this.toggleButton.title=msg})),this.isOpen||this.toggleButton.classList.add("pdfSidebarNotification")}_hideUINotification(reset=!1){(this.isOpen||reset)&&this.toggleButton.classList.remove("pdfSidebarNotification"),reset&&this.l10n.get("toggle_sidebar.title").then((msg=>{this.toggleButton.title=msg}))}_addEventListeners(){this.viewerContainer.addEventListener("transitionend",(evt=>{evt.target===this.viewerContainer&&this.outerContainer.classList.remove("sidebarMoving")})),this.toggleButton.addEventListener("click",(()=>{this.toggle()})),this.thumbnailButton.addEventListener("click",(()=>{this.switchView(_ui_utils.SidebarView.THUMBS)})),this.outlineButton.addEventListener("click",(()=>{this.switchView(_ui_utils.SidebarView.OUTLINE)})),this.outlineButton.addEventListener("dblclick",(()=>{this.eventBus.dispatch("toggleoutlinetree",{source:this})})),this.attachmentsButton.addEventListener("click",(()=>{this.switchView(_ui_utils.SidebarView.ATTACHMENTS)})),this.layersButton.addEventListener("click",(()=>{this.switchView(_ui_utils.SidebarView.LAYERS)})),this.layersButton.addEventListener("dblclick",(()=>{this.eventBus.dispatch("resetlayers",{source:this})})),this._currentOutlineItemButton.addEventListener("click",(()=>{this.eventBus.dispatch("currentoutlineitem",{source:this})}));const onTreeLoaded=(count,button,view)=>{button.disabled=!count,count?this._showUINotification():this.active===view&&this.switchView(_ui_utils.SidebarView.THUMBS)};this.eventBus._on("outlineloaded",(evt=>{onTreeLoaded(evt.outlineCount,this.outlineButton,_ui_utils.SidebarView.OUTLINE),evt.currentOutlineItemPromise.then((enabled=>{this.isInitialViewSet&&(this._currentOutlineItemButton.disabled=!enabled)}))})),this.eventBus._on("attachmentsloaded",(evt=>{onTreeLoaded(evt.attachmentsCount,this.attachmentsButton,_ui_utils.SidebarView.ATTACHMENTS)})),this.eventBus._on("layersloaded",(evt=>{onTreeLoaded(evt.layersCount,this.layersButton,_ui_utils.SidebarView.LAYERS)})),this.eventBus._on("presentationmodechanged",(evt=>{evt.state===_ui_utils.PresentationModeState.NORMAL&&this.isThumbnailViewVisible&&this._updateThumbnailViewer()}))}}},(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.PDFSidebarResizer=void 0;exports.PDFSidebarResizer=class{constructor(options,eventBus,l10n){this.isRTL=!1,this.sidebarOpen=!1,this.doc=document.documentElement,this._width=null,this._outerContainerWidth=null,this._boundEvents=Object.create(null),this.outerContainer=options.outerContainer,this.resizer=options.resizer,this.eventBus=eventBus,l10n.getDirection().then((dir=>{this.isRTL="rtl"===dir})),this._addEventListeners()}get outerContainerWidth(){return this._outerContainerWidth||=this.outerContainer.clientWidth}_updateWidth(width=0){const maxWidth=Math.floor(this.outerContainerWidth/2);return width>maxWidth&&(width=maxWidth),width<200&&(width=200),width!==this._width&&(this._width=width,this.doc.style.setProperty("--sidebar-width",`${width}px`),!0)}_mouseMove(evt){let width=evt.clientX;this.isRTL&&(width=this.outerContainerWidth-width),this._updateWidth(width)}_mouseUp(evt){this.outerContainer.classList.remove("sidebarResizing"),this.eventBus.dispatch("resize",{source:this});const _boundEvents=this._boundEvents;window.removeEventListener("mousemove",_boundEvents.mouseMove),window.removeEventListener("mouseup",_boundEvents.mouseUp)}_addEventListeners(){const _boundEvents=this._boundEvents;_boundEvents.mouseMove=this._mouseMove.bind(this),_boundEvents.mouseUp=this._mouseUp.bind(this),this.resizer.addEventListener("mousedown",(evt=>{0===evt.button&&(this.outerContainer.classList.add("sidebarResizing"),window.addEventListener("mousemove",_boundEvents.mouseMove),window.addEventListener("mouseup",_boundEvents.mouseUp))})),this.eventBus._on("sidebarviewchanged",(evt=>{this.sidebarOpen=!!evt?.view})),this.eventBus._on("resize",(evt=>{if(evt?.source!==window)return;if(this._outerContainerWidth=null,!this._width)return;if(!this.sidebarOpen)return void this._updateWidth(this._width);this.outerContainer.classList.add("sidebarResizing");const updated=this._updateWidth(this._width);Promise.resolve().then((()=>{this.outerContainer.classList.remove("sidebarResizing"),updated&&this.eventBus.dispatch("resize",{source:this})}))}))}}},(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.PDFThumbnailViewer=void 0;var _ui_utils=__webpack_require__(3),_pdf_thumbnail_view=__webpack_require__(26);exports.PDFThumbnailViewer=class{constructor({container:container,eventBus:eventBus,linkService:linkService,renderingQueue:renderingQueue,l10n:l10n}){this.container=container,this.linkService=linkService,this.renderingQueue=renderingQueue,this.l10n=l10n,this.scroll=(0,_ui_utils.watchScroll)(this.container,this._scrollUpdated.bind(this)),this._resetView(),eventBus._on("optionalcontentconfigchanged",(()=>{this._setImageDisabled=!0}))}_scrollUpdated(){this.renderingQueue.renderHighestPriority()}getThumbnail(index){return this._thumbnails[index]}_getVisibleThumbs(){return(0,_ui_utils.getVisibleElements)({scrollEl:this.container,views:this._thumbnails})}scrollThumbnailIntoView(pageNumber){if(!this.pdfDocument)return;const thumbnailView=this._thumbnails[pageNumber-1];if(!thumbnailView)return void console.error('scrollThumbnailIntoView: Invalid "pageNumber" parameter.');if(pageNumber!==this._currentPageNumber){this._thumbnails[this._currentPageNumber-1].div.classList.remove("selected"),thumbnailView.div.classList.add("selected")}const{first:first,last:last,views:views}=this._getVisibleThumbs();if(views.length>0){let shouldScroll=!1;if(pageNumber<=first.id||pageNumber>=last.id)shouldScroll=!0;else for(const{id:id,percent:percent}of views)if(id===pageNumber){shouldScroll=percent<100;break}shouldScroll&&(0,_ui_utils.scrollIntoView)(thumbnailView.div,{top:-19})}this._currentPageNumber=pageNumber}get pagesRotation(){return this._pagesRotation}set pagesRotation(rotation){if(!(0,_ui_utils.isValidRotation)(rotation))throw new Error("Invalid thumbnails rotation angle.");if(!this.pdfDocument)return;if(this._pagesRotation===rotation)return;this._pagesRotation=rotation;const updateArgs={rotation:rotation};for(const thumbnail of this._thumbnails)thumbnail.update(updateArgs)}cleanup(){for(let i=0,ii=this._thumbnails.length;i<ii;i++)this._thumbnails[i]&&this._thumbnails[i].renderingState!==_ui_utils.RenderingStates.FINISHED&&this._thumbnails[i].reset();_pdf_thumbnail_view.TempImageFactory.destroyCanvas()}_resetView(){this._thumbnails=[],this._currentPageNumber=1,this._pageLabels=null,this._pagesRotation=0,this._optionalContentConfigPromise=null,this._setImageDisabled=!1,this.container.textContent=""}setDocument(pdfDocument){if(this.pdfDocument&&(this._cancelRendering(),this._resetView()),this.pdfDocument=pdfDocument,!pdfDocument)return;const firstPagePromise=pdfDocument.getPage(1),optionalContentConfigPromise=pdfDocument.getOptionalContentConfig();firstPagePromise.then((firstPdfPage=>{this._optionalContentConfigPromise=optionalContentConfigPromise;const pagesCount=pdfDocument.numPages,viewport=firstPdfPage.getViewport({scale:1}),checkSetImageDisabled=()=>this._setImageDisabled;for(let pageNum=1;pageNum<=pagesCount;++pageNum){const thumbnail=new _pdf_thumbnail_view.PDFThumbnailView({container:this.container,id:pageNum,defaultViewport:viewport.clone(),optionalContentConfigPromise:optionalContentConfigPromise,linkService:this.linkService,renderingQueue:this.renderingQueue,checkSetImageDisabled:checkSetImageDisabled,l10n:this.l10n});this._thumbnails.push(thumbnail)}const firstThumbnailView=this._thumbnails[0];firstThumbnailView&&firstThumbnailView.setPdfPage(firstPdfPage);this._thumbnails[this._currentPageNumber-1].div.classList.add("selected")})).catch((reason=>{console.error("Unable to initialize thumbnail viewer",reason)}))}_cancelRendering(){for(let i=0,ii=this._thumbnails.length;i<ii;i++)this._thumbnails[i]&&this._thumbnails[i].cancelRendering()}setPageLabels(labels){if(this.pdfDocument){labels?Array.isArray(labels)&&this.pdfDocument.numPages===labels.length?this._pageLabels=labels:(this._pageLabels=null,console.error("PDFThumbnailViewer_setPageLabels: Invalid page labels.")):this._pageLabels=null;for(let i=0,ii=this._thumbnails.length;i<ii;i++)this._thumbnails[i].setPageLabel(this._pageLabels?.[i]??null)}}async#ensurePdfPageLoaded(thumbView){if(thumbView.pdfPage)return thumbView.pdfPage;try{const pdfPage=await this.pdfDocument.getPage(thumbView.id);return thumbView.pdfPage||thumbView.setPdfPage(pdfPage),pdfPage}catch(reason){return console.error("Unable to get page for thumb view",reason),null}}#getScrollAhead(visible){return 1===visible.first?.id||visible.last?.id!==this._thumbnails.length&&this.scroll.down}forceRendering(){const visibleThumbs=this._getVisibleThumbs(),scrollAhead=this.#getScrollAhead(visibleThumbs),thumbView=this.renderingQueue.getHighestPriority(visibleThumbs,this._thumbnails,scrollAhead);return!!thumbView&&(this.#ensurePdfPageLoaded(thumbView).then((()=>{this.renderingQueue.renderView(thumbView)})),!0)}}},(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.TempImageFactory=exports.PDFThumbnailView=void 0;var _ui_utils=__webpack_require__(3),_pdfjsLib=__webpack_require__(5);class TempImageFactory{static#tempCanvas=null;static getCanvas(width,height){const tempCanvas=this.#tempCanvas||=document.createElement("canvas");tempCanvas.width=width,tempCanvas.height=height,tempCanvas.mozOpaque=!0;const ctx=tempCanvas.getContext("2d",{alpha:!1});return ctx.save(),ctx.fillStyle="rgb(255, 255, 255)",ctx.fillRect(0,0,width,height),ctx.restore(),[tempCanvas,tempCanvas.getContext("2d")]}static destroyCanvas(){const tempCanvas=this.#tempCanvas;tempCanvas&&(tempCanvas.width=0,tempCanvas.height=0),this.#tempCanvas=null}}exports.TempImageFactory=TempImageFactory;exports.PDFThumbnailView=class{constructor({container:container,id:id,defaultViewport:defaultViewport,optionalContentConfigPromise:optionalContentConfigPromise,linkService:linkService,renderingQueue:renderingQueue,checkSetImageDisabled:checkSetImageDisabled,l10n:l10n}){this.id=id,this.renderingId="thumbnail"+id,this.pageLabel=null,this.pdfPage=null,this.rotation=0,this.viewport=defaultViewport,this.pdfPageRotate=defaultViewport.rotation,this._optionalContentConfigPromise=optionalContentConfigPromise||null,this.linkService=linkService,this.renderingQueue=renderingQueue,this.renderTask=null,this.renderingState=_ui_utils.RenderingStates.INITIAL,this.resume=null,this._checkSetImageDisabled=checkSetImageDisabled||function(){return!1};const pageWidth=this.viewport.width,pageRatio=pageWidth/this.viewport.height;this.canvasWidth=98,this.canvasHeight=this.canvasWidth/pageRatio|0,this.scale=this.canvasWidth/pageWidth,this.l10n=l10n;const anchor=document.createElement("a");anchor.href=linkService.getAnchorUrl("#page="+id),this._thumbPageTitle.then((msg=>{anchor.title=msg})),anchor.onclick=function(){return linkService.goToPage(id),!1},this.anchor=anchor;const div=document.createElement("div");div.className="thumbnail",div.setAttribute("data-page-number",this.id),this.div=div;const ring=document.createElement("div");ring.className="thumbnailSelectionRing";ring.style.width=this.canvasWidth+2+"px",ring.style.height=this.canvasHeight+2+"px",this.ring=ring,div.appendChild(ring),anchor.appendChild(div),container.appendChild(anchor)}setPdfPage(pdfPage){this.pdfPage=pdfPage,this.pdfPageRotate=pdfPage.rotate;const totalRotation=(this.rotation+this.pdfPageRotate)%360;this.viewport=pdfPage.getViewport({scale:1,rotation:totalRotation}),this.reset()}reset(){this.cancelRendering(),this.renderingState=_ui_utils.RenderingStates.INITIAL;const pageWidth=this.viewport.width,pageRatio=pageWidth/this.viewport.height;this.canvasHeight=this.canvasWidth/pageRatio|0,this.scale=this.canvasWidth/pageWidth,this.div.removeAttribute("data-loaded");const ring=this.ring;ring.textContent="";ring.style.width=this.canvasWidth+2+"px",ring.style.height=this.canvasHeight+2+"px",this.canvas&&(this.canvas.width=0,this.canvas.height=0,delete this.canvas),this.image&&(this.image.removeAttribute("src"),delete this.image)}update({rotation:rotation=null}){"number"==typeof rotation&&(this.rotation=rotation);const totalRotation=(this.rotation+this.pdfPageRotate)%360;this.viewport=this.viewport.clone({scale:1,rotation:totalRotation}),this.reset()}cancelRendering(){this.renderTask&&(this.renderTask.cancel(),this.renderTask=null),this.resume=null}_getPageDrawContext(upscaleFactor=1){const canvas=document.createElement("canvas");canvas.mozOpaque=!0;const ctx=canvas.getContext("2d",{alpha:!1}),outputScale=new _ui_utils.OutputScale;canvas.width=upscaleFactor*this.canvasWidth*outputScale.sx|0,canvas.height=upscaleFactor*this.canvasHeight*outputScale.sy|0;return{ctx:ctx,canvas:canvas,transform:outputScale.scaled?[outputScale.sx,0,0,outputScale.sy,0,0]:null}}_convertCanvasToImage(canvas){if(this.renderingState!==_ui_utils.RenderingStates.FINISHED)throw new Error("_convertCanvasToImage: Rendering has not finished.");const reducedCanvas=this._reduceImage(canvas),image=document.createElement("img");image.className="thumbnailImage",this._thumbPageCanvas.then((msg=>{image.setAttribute("aria-label",msg)})),image.style.width=this.canvasWidth+"px",image.style.height=this.canvasHeight+"px",image.src=reducedCanvas.toDataURL(),this.image=image,this.div.setAttribute("data-loaded",!0),this.ring.appendChild(image),reducedCanvas.width=0,reducedCanvas.height=0}draw(){if(this.renderingState!==_ui_utils.RenderingStates.INITIAL)return console.error("Must be in new state before drawing"),Promise.resolve();const{pdfPage:pdfPage}=this;if(!pdfPage)return this.renderingState=_ui_utils.RenderingStates.FINISHED,Promise.reject(new Error("pdfPage is not loaded"));this.renderingState=_ui_utils.RenderingStates.RUNNING;const finishRenderTask=async(error=null)=>{if(renderTask===this.renderTask&&(this.renderTask=null),!(error instanceof _pdfjsLib.RenderingCancelledException)&&(this.renderingState=_ui_utils.RenderingStates.FINISHED,this._convertCanvasToImage(canvas),error))throw error},{ctx:ctx,canvas:canvas,transform:transform}=this._getPageDrawContext(2),renderContext={canvasContext:ctx,transform:transform,viewport:this.viewport.clone({scale:2*this.scale}),optionalContentConfigPromise:this._optionalContentConfigPromise},renderTask=this.renderTask=pdfPage.render(renderContext);renderTask.onContinue=cont=>{if(!this.renderingQueue.isHighestPriority(this))return this.renderingState=_ui_utils.RenderingStates.PAUSED,void(this.resume=()=>{this.renderingState=_ui_utils.RenderingStates.RUNNING,cont()});cont()};const resultPromise=renderTask.promise.then((function(){return finishRenderTask(null)}),(function(error){return finishRenderTask(error)}));return resultPromise.finally((()=>{canvas.width=0,canvas.height=0;this.linkService.isPageCached(this.id)||this.pdfPage?.cleanup()})),resultPromise}setImage(pageView){if(this._checkSetImageDisabled())return;if(this.renderingState!==_ui_utils.RenderingStates.INITIAL)return;const{canvas:canvas,pdfPage:pdfPage}=pageView;canvas&&(this.pdfPage||this.setPdfPage(pdfPage),this.renderingState=_ui_utils.RenderingStates.FINISHED,this._convertCanvasToImage(canvas))}_reduceImage(img){const{ctx:ctx,canvas:canvas}=this._getPageDrawContext();if(img.width<=2*canvas.width)return ctx.drawImage(img,0,0,img.width,img.height,0,0,canvas.width,canvas.height),canvas;let reducedWidth=canvas.width<<3,reducedHeight=canvas.height<<3;const[reducedImage,reducedImageCtx]=TempImageFactory.getCanvas(reducedWidth,reducedHeight);for(;reducedWidth>img.width||reducedHeight>img.height;)reducedWidth>>=1,reducedHeight>>=1;for(reducedImageCtx.drawImage(img,0,0,img.width,img.height,0,0,reducedWidth,reducedHeight);reducedWidth>2*canvas.width;)reducedImageCtx.drawImage(reducedImage,0,0,reducedWidth,reducedHeight,0,0,reducedWidth>>1,reducedHeight>>1),reducedWidth>>=1,reducedHeight>>=1;return ctx.drawImage(reducedImage,0,0,reducedWidth,reducedHeight,0,0,canvas.width,canvas.height),canvas}get _thumbPageTitle(){return this.l10n.get("thumb_page_title",{page:this.pageLabel??this.id})}get _thumbPageCanvas(){return this.l10n.get("thumb_page_canvas",{page:this.pageLabel??this.id})}setPageLabel(label){this.pageLabel="string"==typeof label?label:null,this._thumbPageTitle.then((msg=>{this.anchor.title=msg})),this.renderingState===_ui_utils.RenderingStates.FINISHED&&this._thumbPageCanvas.then((msg=>{this.image?.setAttribute("aria-label",msg)}))}}},(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.PDFViewer=exports.PDFSinglePageViewer=void 0;var _ui_utils=__webpack_require__(3),_base_viewer=__webpack_require__(28);class PDFViewer extends _base_viewer.BaseViewer{}exports.PDFViewer=PDFViewer;class PDFSinglePageViewer extends _base_viewer.BaseViewer{_resetView(){super._resetView(),this._scrollMode=_ui_utils.ScrollMode.PAGE,this._spreadMode=_ui_utils.SpreadMode.NONE}set scrollMode(mode){}_updateScrollMode(){}set spreadMode(mode){}_updateSpreadMode(){}}exports.PDFSinglePageViewer=PDFSinglePageViewer},(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.PagesCountLimit=exports.PDFPageViewBuffer=exports.BaseViewer=void 0;var _pdfjsLib=__webpack_require__(5),_ui_utils=__webpack_require__(3),_annotation_layer_builder=__webpack_require__(29),_l10n_utils=__webpack_require__(30),_pdf_page_view=__webpack_require__(31),_pdf_rendering_queue=__webpack_require__(21),_pdf_link_service=__webpack_require__(8),_struct_tree_layer_builder=__webpack_require__(32),_text_highlighter=__webpack_require__(33),_text_layer_builder=__webpack_require__(34),_xfa_layer_builder=__webpack_require__(35);const PagesCountLimit={FORCE_SCROLL_MODE_PAGE:15e3,FORCE_LAZY_PAGE_INIT:7500,PAUSE_EAGER_PAGE_INIT:250};exports.PagesCountLimit=PagesCountLimit;class PDFPageViewBuffer{#buf=new Set;#size=0;constructor(size){this.#size=size}push(view){const buf=this.#buf;buf.has(view)&&buf.delete(view),buf.add(view),buf.size>this.#size&&this.#destroyFirstView()}resize(newSize,idsToKeep=null){this.#size=newSize;const buf=this.#buf;if(idsToKeep){const ii=buf.size;let i=1;for(const view of buf)if(idsToKeep.has(view.id)&&(buf.delete(view),buf.add(view)),++i>ii)break}for(;buf.size>this.#size;)this.#destroyFirstView()}has(view){return this.#buf.has(view)}[Symbol.iterator](){return this.#buf.keys()}#destroyFirstView(){const firstView=this.#buf.keys().next().value;firstView?.destroy(),this.#buf.delete(firstView)}}exports.PDFPageViewBuffer=PDFPageViewBuffer;class BaseViewer{#buffer=null;#annotationMode=_pdfjsLib.AnnotationMode.ENABLE_FORMS;#previousAnnotationMode=null;#enablePermissions=!1;#previousContainerHeight=0;#scrollModePageState=null;#onVisibilityChange=null;constructor(options){if(this.constructor===BaseViewer)throw new Error("Cannot initialize BaseViewer.");if("2.13.216"!==_pdfjsLib.version)throw new Error(`The API version "${_pdfjsLib.version}" does not match the Viewer version "2.13.216".`);if(this.container=options.container,this.viewer=options.viewer||options.container.firstElementChild,"DIV"!==this.container?.tagName.toUpperCase()||"DIV"!==this.viewer?.tagName.toUpperCase())throw new Error("Invalid `container` and/or `viewer` option.");if(this.container.offsetParent&&"absolute"!==getComputedStyle(this.container).position)throw new Error("The `container` must be absolutely positioned.");this.eventBus=options.eventBus,this.linkService=options.linkService||new _pdf_link_service.SimpleLinkService,this.downloadManager=options.downloadManager||null,this.findController=options.findController||null,this._scriptingManager=options.scriptingManager||null,this.removePageBorders=options.removePageBorders||!1,this.textLayerMode=options.textLayerMode??_ui_utils.TextLayerMode.ENABLE,this.#annotationMode=options.annotationMode??_pdfjsLib.AnnotationMode.ENABLE_FORMS,this.imageResourcesPath=options.imageResourcesPath||"",this.enablePrintAutoRotate=options.enablePrintAutoRotate||!1,this.renderer=options.renderer||_ui_utils.RendererType.CANVAS,this.useOnlyCssZoom=options.useOnlyCssZoom||!1,this.maxCanvasPixels=options.maxCanvasPixels,this.l10n=options.l10n||_l10n_utils.NullL10n,this.#enablePermissions=options.enablePermissions||!1,this.defaultRenderingQueue=!options.renderingQueue,this.defaultRenderingQueue?(this.renderingQueue=new _pdf_rendering_queue.PDFRenderingQueue,this.renderingQueue.setViewer(this)):this.renderingQueue=options.renderingQueue,this._doc=document.documentElement,this.scroll=(0,_ui_utils.watchScroll)(this.container,this._scrollUpdate.bind(this)),this.presentationModeState=_ui_utils.PresentationModeState.UNKNOWN,this._onBeforeDraw=this._onAfterDraw=null,this._resetView(),this.removePageBorders&&this.viewer.classList.add("removePageBorders"),Promise.resolve().then((()=>{this.eventBus.dispatch("baseviewerinit",{source:this})}))}get pagesCount(){return this._pages.length}getPageView(index){return this._pages[index]}get pageViewsReady(){return!!this._pagesCapability.settled&&this._pages.every((function(pageView){return pageView?.pdfPage}))}get renderForms(){return this.#annotationMode===_pdfjsLib.AnnotationMode.ENABLE_FORMS}get enableScripting(){return!!this._scriptingManager}get currentPageNumber(){return this._currentPageNumber}set currentPageNumber(val){if(!Number.isInteger(val))throw new Error("Invalid page number.");this.pdfDocument&&(this._setCurrentPageNumber(val,!0)||console.error(`currentPageNumber: "${val}" is not a valid page.`))}_setCurrentPageNumber(val,resetCurrentPageView=!1){if(this._currentPageNumber===val)return resetCurrentPageView&&this._resetCurrentPageView(),!0;if(!(0<val&&val<=this.pagesCount))return!1;const previous=this._currentPageNumber;return this._currentPageNumber=val,this.eventBus.dispatch("pagechanging",{source:this,pageNumber:val,pageLabel:this._pageLabels?.[val-1]??null,previous:previous}),resetCurrentPageView&&this._resetCurrentPageView(),!0}get currentPageLabel(){return this._pageLabels?.[this._currentPageNumber-1]??null}set currentPageLabel(val){if(!this.pdfDocument)return;let page=0|val;if(this._pageLabels){const i=this._pageLabels.indexOf(val);i>=0&&(page=i+1)}this._setCurrentPageNumber(page,!0)||console.error(`currentPageLabel: "${val}" is not a valid page.`)}get currentScale(){return this._currentScale!==_ui_utils.UNKNOWN_SCALE?this._currentScale:_ui_utils.DEFAULT_SCALE}set currentScale(val){if(isNaN(val))throw new Error("Invalid numeric scale.");this.pdfDocument&&this._setScale(val,!1)}get currentScaleValue(){return this._currentScaleValue}set currentScaleValue(val){this.pdfDocument&&this._setScale(val,!1)}get pagesRotation(){return this._pagesRotation}set pagesRotation(rotation){if(!(0,_ui_utils.isValidRotation)(rotation))throw new Error("Invalid pages rotation angle.");if(!this.pdfDocument)return;if((rotation%=360)<0&&(rotation+=360),this._pagesRotation===rotation)return;this._pagesRotation=rotation;const pageNumber=this._currentPageNumber,updateArgs={rotation:rotation};for(const pageView of this._pages)pageView.update(updateArgs);this._currentScaleValue&&this._setScale(this._currentScaleValue,!0),this.eventBus.dispatch("rotationchanging",{source:this,pagesRotation:rotation,pageNumber:pageNumber}),this.defaultRenderingQueue&&this.update()}get firstPagePromise(){return this.pdfDocument?this._firstPageCapability.promise:null}get onePageRendered(){return this.pdfDocument?this._onePageRenderedCapability.promise:null}get pagesPromise(){return this.pdfDocument?this._pagesCapability.promise:null}#initializePermissions(permissions){permissions&&(permissions.includes(_pdfjsLib.PermissionFlag.COPY)||this.viewer.classList.add("enablePermissions"),permissions.includes(_pdfjsLib.PermissionFlag.MODIFY_ANNOTATIONS)||permissions.includes(_pdfjsLib.PermissionFlag.FILL_INTERACTIVE_FORMS)||this.#annotationMode===_pdfjsLib.AnnotationMode.ENABLE_FORMS&&(this.#previousAnnotationMode=this.#annotationMode,this.#annotationMode=_pdfjsLib.AnnotationMode.ENABLE))}#onePageRenderedOrForceFetch(){if("hidden"===document.visibilityState||!this.container.offsetParent||0===this._getVisiblePages().views.length)return Promise.resolve();const visibilityChangePromise=new Promise((resolve=>{this.#onVisibilityChange=()=>{"hidden"===document.visibilityState&&(resolve(),document.removeEventListener("visibilitychange",this.#onVisibilityChange),this.#onVisibilityChange=null)},document.addEventListener("visibilitychange",this.#onVisibilityChange)}));return Promise.race([this._onePageRenderedCapability.promise,visibilityChangePromise])}setDocument(pdfDocument){if(this.pdfDocument&&(this.eventBus.dispatch("pagesdestroy",{source:this}),this._cancelRendering(),this._resetView(),this.findController&&this.findController.setDocument(null),this._scriptingManager&&this._scriptingManager.setDocument(null)),this.pdfDocument=pdfDocument,!pdfDocument)return;const isPureXfa=pdfDocument.isPureXfa,pagesCount=pdfDocument.numPages,firstPagePromise=pdfDocument.getPage(1),optionalContentConfigPromise=pdfDocument.getOptionalContentConfig(),permissionsPromise=this.#enablePermissions?pdfDocument.getPermissions():Promise.resolve();if(pagesCount>PagesCountLimit.FORCE_SCROLL_MODE_PAGE){console.warn("Forcing PAGE-scrolling for performance reasons, given the length of the document.");const mode=this._scrollMode=_ui_utils.ScrollMode.PAGE;this.eventBus.dispatch("scrollmodechanged",{source:this,mode:mode})}this._pagesCapability.promise.then((()=>{this.eventBus.dispatch("pagesloaded",{source:this,pagesCount:pagesCount})}),(()=>{})),this._onBeforeDraw=evt=>{const pageView=this._pages[evt.pageNumber-1];pageView&&this.#buffer.push(pageView)},this.eventBus._on("pagerender",this._onBeforeDraw),this._onAfterDraw=evt=>{evt.cssTransform||this._onePageRenderedCapability.settled||(this._onePageRenderedCapability.resolve({timestamp:evt.timestamp}),this.eventBus._off("pagerendered",this._onAfterDraw),this._onAfterDraw=null,this.#onVisibilityChange&&(document.removeEventListener("visibilitychange",this.#onVisibilityChange),this.#onVisibilityChange=null))},this.eventBus._on("pagerendered",this._onAfterDraw),Promise.all([firstPagePromise,permissionsPromise]).then((([firstPdfPage,permissions])=>{if(pdfDocument!==this.pdfDocument)return;this._firstPageCapability.resolve(firstPdfPage),this._optionalContentConfigPromise=optionalContentConfigPromise,this.#initializePermissions(permissions);const viewerElement=this._scrollMode===_ui_utils.ScrollMode.PAGE?null:this.viewer,scale=this.currentScale,viewport=firstPdfPage.getViewport({scale:scale*_pdfjsLib.PixelsPerInch.PDF_TO_CSS_UNITS}),textLayerFactory=this.textLayerMode===_ui_utils.TextLayerMode.DISABLE||isPureXfa?null:this,annotationLayerFactory=this.#annotationMode!==_pdfjsLib.AnnotationMode.DISABLE?this:null,xfaLayerFactory=isPureXfa?this:null;for(let pageNum=1;pageNum<=pagesCount;++pageNum){const pageView=new _pdf_page_view.PDFPageView({container:viewerElement,eventBus:this.eventBus,id:pageNum,scale:scale,defaultViewport:viewport.clone(),optionalContentConfigPromise:optionalContentConfigPromise,renderingQueue:this.renderingQueue,textLayerFactory:textLayerFactory,textLayerMode:this.textLayerMode,annotationLayerFactory:annotationLayerFactory,annotationMode:this.#annotationMode,xfaLayerFactory:xfaLayerFactory,textHighlighterFactory:this,structTreeLayerFactory:this,imageResourcesPath:this.imageResourcesPath,renderer:this.renderer,useOnlyCssZoom:this.useOnlyCssZoom,maxCanvasPixels:this.maxCanvasPixels,l10n:this.l10n});this._pages.push(pageView)}const firstPageView=this._pages[0];firstPageView&&(firstPageView.setPdfPage(firstPdfPage),this.linkService.cachePageRef(1,firstPdfPage.ref)),this._scrollMode===_ui_utils.ScrollMode.PAGE?this.#ensurePageViewVisible():this._spreadMode!==_ui_utils.SpreadMode.NONE&&this._updateSpreadMode(),this.#onePageRenderedOrForceFetch().then((async()=>{if(this.findController&&this.findController.setDocument(pdfDocument),this._scriptingManager&&this._scriptingManager.setDocument(pdfDocument),pdfDocument.loadingParams.disableAutoFetch||pagesCount>PagesCountLimit.FORCE_LAZY_PAGE_INIT)return void this._pagesCapability.resolve();let getPagesLeft=pagesCount-1;if(getPagesLeft<=0)this._pagesCapability.resolve();else for(let pageNum=2;pageNum<=pagesCount;++pageNum){const promise=pdfDocument.getPage(pageNum).then((pdfPage=>{const pageView=this._pages[pageNum-1];pageView.pdfPage||pageView.setPdfPage(pdfPage),this.linkService.cachePageRef(pageNum,pdfPage.ref),0==--getPagesLeft&&this._pagesCapability.resolve()}),(reason=>{console.error(`Unable to get page ${pageNum} to initialize viewer`,reason),0==--getPagesLeft&&this._pagesCapability.resolve()}));pageNum%PagesCountLimit.PAUSE_EAGER_PAGE_INIT==0&&await promise}})),this.eventBus.dispatch("pagesinit",{source:this}),pdfDocument.getMetadata().then((({info:info})=>{pdfDocument===this.pdfDocument&&info.Language&&(this.viewer.lang=info.Language)})),this.defaultRenderingQueue&&this.update()})).catch((reason=>{console.error("Unable to initialize viewer",reason),this._pagesCapability.reject(reason)}))}setPageLabels(labels){if(this.pdfDocument){labels?Array.isArray(labels)&&this.pdfDocument.numPages===labels.length?this._pageLabels=labels:(this._pageLabels=null,console.error("setPageLabels: Invalid page labels.")):this._pageLabels=null;for(let i=0,ii=this._pages.length;i<ii;i++)this._pages[i].setPageLabel(this._pageLabels?.[i]??null)}}_resetView(){this._pages=[],this._currentPageNumber=1,this._currentScale=_ui_utils.UNKNOWN_SCALE,this._currentScaleValue=null,this._pageLabels=null,this.#buffer=new PDFPageViewBuffer(10),this._location=null,this._pagesRotation=0,this._optionalContentConfigPromise=null,this._firstPageCapability=(0,_pdfjsLib.createPromiseCapability)(),this._onePageRenderedCapability=(0,_pdfjsLib.createPromiseCapability)(),this._pagesCapability=(0,_pdfjsLib.createPromiseCapability)(),this._scrollMode=_ui_utils.ScrollMode.VERTICAL,this._previousScrollMode=_ui_utils.ScrollMode.UNKNOWN,this._spreadMode=_ui_utils.SpreadMode.NONE,this.#scrollModePageState={previousPageNumber:1,scrollDown:!0,pages:[]},this._onBeforeDraw&&(this.eventBus._off("pagerender",this._onBeforeDraw),this._onBeforeDraw=null),this._onAfterDraw&&(this.eventBus._off("pagerendered",this._onAfterDraw),this._onAfterDraw=null),this.#onVisibilityChange&&(document.removeEventListener("visibilitychange",this.#onVisibilityChange),this.#onVisibilityChange=null),this.viewer.textContent="",this._updateScrollMode(),this.viewer.removeAttribute("lang"),this.viewer.classList.remove("enablePermissions"),null!==this.#previousAnnotationMode&&(this.#annotationMode=this.#previousAnnotationMode,this.#previousAnnotationMode=null)}#ensurePageViewVisible(){if(this._scrollMode!==_ui_utils.ScrollMode.PAGE)throw new Error("#ensurePageViewVisible: Invalid scrollMode value.");const pageNumber=this._currentPageNumber,state=this.#scrollModePageState,viewer=this.viewer;if(viewer.textContent="",state.pages.length=0,this._spreadMode===_ui_utils.SpreadMode.NONE){const pageView=this._pages[pageNumber-1];if(this.isInPresentationMode){const spread=document.createElement("div");spread.className="spread";const dummyPage=document.createElement("div");dummyPage.className="dummyPage",dummyPage.style.height=`${this.container.clientHeight}px`,spread.appendChild(dummyPage),spread.appendChild(pageView.div),viewer.appendChild(spread)}else viewer.appendChild(pageView.div);state.pages.push(pageView)}else{const pageIndexSet=new Set,parity=this._spreadMode-1;pageNumber%2!==parity?(pageIndexSet.add(pageNumber-1),pageIndexSet.add(pageNumber)):(pageIndexSet.add(pageNumber-2),pageIndexSet.add(pageNumber-1));let spread=null;for(const i of pageIndexSet){const pageView=this._pages[i];pageView&&(null===spread?(spread=document.createElement("div"),spread.className="spread",viewer.appendChild(spread)):i%2===parity&&(spread=spread.cloneNode(!1),viewer.appendChild(spread)),spread.appendChild(pageView.div),state.pages.push(pageView))}}state.scrollDown=pageNumber>=state.previousPageNumber,state.previousPageNumber=pageNumber}_scrollUpdate(){0!==this.pagesCount&&this.update()}_scrollIntoView({pageDiv:pageDiv,pageSpot:pageSpot=null,pageNumber:pageNumber=null}){if(this._scrollMode===_ui_utils.ScrollMode.PAGE&&(pageNumber&&this._setCurrentPageNumber(pageNumber),this.#ensurePageViewVisible(),this.update()),!pageSpot&&!this.isInPresentationMode){const left=pageDiv.offsetLeft+pageDiv.clientLeft,right=left+pageDiv.clientWidth,{scrollLeft:scrollLeft,clientWidth:clientWidth}=this.container;(this._scrollMode===_ui_utils.ScrollMode.HORIZONTAL||left<scrollLeft||right>scrollLeft+clientWidth)&&(pageSpot={left:0,top:0})}(0,_ui_utils.scrollIntoView)(pageDiv,pageSpot)}#isSameScale(newScale){return(!this.isInPresentationMode||this.container.clientHeight===this.#previousContainerHeight)&&(newScale===this._currentScale||Math.abs(newScale-this._currentScale)<1e-15)}_setScaleUpdatePages(newScale,newValue,noScroll=!1,preset=!1){if(this._currentScaleValue=newValue.toString(),this.#isSameScale(newScale))return void(preset&&this.eventBus.dispatch("scalechanging",{source:this,scale:newScale,presetValue:newValue}));this._doc.style.setProperty("--zoom-factor",newScale),this._doc.style.setProperty("--viewport-scale-factor",newScale*_pdfjsLib.PixelsPerInch.PDF_TO_CSS_UNITS);const updateArgs={scale:newScale};for(const pageView of this._pages)pageView.update(updateArgs);if(this._currentScale=newScale,!noScroll){let dest,page=this._currentPageNumber;!this._location||this.isInPresentationMode||this.isChangingPresentationMode||(page=this._location.pageNumber,dest=[null,{name:"XYZ"},this._location.left,this._location.top,null]),this.scrollPageIntoView({pageNumber:page,destArray:dest,allowNegativeOffset:!0})}this.eventBus.dispatch("scalechanging",{source:this,scale:newScale,presetValue:preset?newValue:void 0}),this.defaultRenderingQueue&&this.update(),this.#previousContainerHeight=this.container.clientHeight}get _pageWidthScaleFactor(){return this._spreadMode!==_ui_utils.SpreadMode.NONE&&this._scrollMode!==_ui_utils.ScrollMode.HORIZONTAL?2:1}_setScale(value,noScroll=!1){let scale=parseFloat(value);if(scale>0)this._setScaleUpdatePages(scale,value,noScroll,!1);else{const currentPage=this._pages[this._currentPageNumber-1];if(!currentPage)return;let hPadding=_ui_utils.SCROLLBAR_PADDING,vPadding=_ui_utils.VERTICAL_PADDING;this.isInPresentationMode?hPadding=vPadding=4:this.removePageBorders&&(hPadding=vPadding=0),this._scrollMode===_ui_utils.ScrollMode.HORIZONTAL&&([hPadding,vPadding]=[vPadding,hPadding]);const pageWidthScale=(this.container.clientWidth-hPadding)/currentPage.width*currentPage.scale/this._pageWidthScaleFactor,pageHeightScale=(this.container.clientHeight-vPadding)/currentPage.height*currentPage.scale;switch(value){case"page-actual":scale=1;break;case"page-width":scale=pageWidthScale;break;case"page-height":scale=pageHeightScale;break;case"page-fit":scale=Math.min(pageWidthScale,pageHeightScale);break;case"auto":const horizontalScale=(0,_ui_utils.isPortraitOrientation)(currentPage)?pageWidthScale:Math.min(pageHeightScale,pageWidthScale);scale=Math.min(_ui_utils.MAX_AUTO_SCALE,horizontalScale);break;default:return void console.error(`_setScale: "${value}" is an unknown zoom value.`)}this._setScaleUpdatePages(scale,value,noScroll,!0)}}_resetCurrentPageView(){this.isInPresentationMode&&this._setScale(this._currentScaleValue,!0);const pageView=this._pages[this._currentPageNumber-1];this._scrollIntoView({pageDiv:pageView.div})}pageLabelToPageNumber(label){if(!this._pageLabels)return null;const i=this._pageLabels.indexOf(label);return i<0?null:i+1}scrollPageIntoView({pageNumber:pageNumber,destArray:destArray=null,allowNegativeOffset:allowNegativeOffset=!1,ignoreDestinationZoom:ignoreDestinationZoom=!1}){if(!this.pdfDocument)return;const pageView=Number.isInteger(pageNumber)&&this._pages[pageNumber-1];if(!pageView)return void console.error(`scrollPageIntoView: "${pageNumber}" is not a valid pageNumber parameter.`);if(this.isInPresentationMode||!destArray)return void this._setCurrentPageNumber(pageNumber,!0);let widthScale,heightScale,x=0,y=0,width=0,height=0;const changeOrientation=pageView.rotation%180!=0,pageWidth=(changeOrientation?pageView.height:pageView.width)/pageView.scale/_pdfjsLib.PixelsPerInch.PDF_TO_CSS_UNITS,pageHeight=(changeOrientation?pageView.width:pageView.height)/pageView.scale/_pdfjsLib.PixelsPerInch.PDF_TO_CSS_UNITS;let scale=0;switch(destArray[1].name){case"XYZ":x=destArray[2],y=destArray[3],scale=destArray[4],x=null!==x?x:0,y=null!==y?y:pageHeight;break;case"Fit":case"FitB":scale="page-fit";break;case"FitH":case"FitBH":y=destArray[2],scale="page-width",null===y&&this._location?(x=this._location.left,y=this._location.top):("number"!=typeof y||y<0)&&(y=pageHeight);break;case"FitV":case"FitBV":x=destArray[2],width=pageWidth,height=pageHeight,scale="page-height";break;case"FitR":x=destArray[2],y=destArray[3],width=destArray[4]-x,height=destArray[5]-y;const hPadding=this.removePageBorders?0:_ui_utils.SCROLLBAR_PADDING,vPadding=this.removePageBorders?0:_ui_utils.VERTICAL_PADDING;widthScale=(this.container.clientWidth-hPadding)/width/_pdfjsLib.PixelsPerInch.PDF_TO_CSS_UNITS,heightScale=(this.container.clientHeight-vPadding)/height/_pdfjsLib.PixelsPerInch.PDF_TO_CSS_UNITS,scale=Math.min(Math.abs(widthScale),Math.abs(heightScale));break;default:return void console.error(`scrollPageIntoView: "${destArray[1].name}" is not a valid destination type.`)}if(ignoreDestinationZoom||(scale&&scale!==this._currentScale?this.currentScaleValue=scale:this._currentScale===_ui_utils.UNKNOWN_SCALE&&(this.currentScaleValue=_ui_utils.DEFAULT_SCALE_VALUE)),"page-fit"===scale&&!destArray[4])return void this._scrollIntoView({pageDiv:pageView.div,pageNumber:pageNumber});const boundingRect=[pageView.viewport.convertToViewportPoint(x,y),pageView.viewport.convertToViewportPoint(x+width,y+height)];let left=Math.min(boundingRect[0][0],boundingRect[1][0]),top=Math.min(boundingRect[0][1],boundingRect[1][1]);allowNegativeOffset||(left=Math.max(left,0),top=Math.max(top,0)),this._scrollIntoView({pageDiv:pageView.div,pageSpot:{left:left,top:top},pageNumber:pageNumber})}_updateLocation(firstPage){const currentScale=this._currentScale,currentScaleValue=this._currentScaleValue,normalizedScaleValue=parseFloat(currentScaleValue)===currentScale?Math.round(1e4*currentScale)/100:currentScaleValue,pageNumber=firstPage.id;let pdfOpenParams="#page="+pageNumber;pdfOpenParams+="&zoom="+normalizedScaleValue;const currentPageView=this._pages[pageNumber-1],container=this.container,topLeft=currentPageView.getPagePoint(container.scrollLeft-firstPage.x,container.scrollTop-firstPage.y),intLeft=Math.round(topLeft[0]),intTop=Math.round(topLeft[1]);pdfOpenParams+=","+intLeft+","+intTop,this._location={pageNumber:pageNumber,scale:normalizedScaleValue,top:intTop,left:intLeft,rotation:this._pagesRotation,pdfOpenParams:pdfOpenParams}}update(){const visible=this._getVisiblePages(),visiblePages=visible.views,numVisiblePages=visiblePages.length;if(0===numVisiblePages)return;const newCacheSize=Math.max(10,2*numVisiblePages+1);if(this.#buffer.resize(newCacheSize,visible.ids),this.renderingQueue.renderHighestPriority(visible),!this.isInPresentationMode){const isSimpleLayout=this._spreadMode===_ui_utils.SpreadMode.NONE&&(this._scrollMode===_ui_utils.ScrollMode.PAGE||this._scrollMode===_ui_utils.ScrollMode.VERTICAL);let currentId=this._currentPageNumber,stillFullyVisible=!1;for(const page of visiblePages){if(page.percent<100)break;if(page.id===currentId&&isSimpleLayout){stillFullyVisible=!0;break}}stillFullyVisible||(currentId=visiblePages[0].id),this._setCurrentPageNumber(currentId)}this._updateLocation(visible.first),this.eventBus.dispatch("updateviewarea",{source:this,location:this._location})}containsElement(element){return this.container.contains(element)}focus(){this.container.focus()}get _isContainerRtl(){return"rtl"===getComputedStyle(this.container).direction}get isInPresentationMode(){return this.presentationModeState===_ui_utils.PresentationModeState.FULLSCREEN}get isChangingPresentationMode(){return this.presentationModeState===_ui_utils.PresentationModeState.CHANGING}get isHorizontalScrollbarEnabled(){return!this.isInPresentationMode&&this.container.scrollWidth>this.container.clientWidth}get isVerticalScrollbarEnabled(){return!this.isInPresentationMode&&this.container.scrollHeight>this.container.clientHeight}_getCurrentVisiblePage(){if(!this.pagesCount)return{views:[]};const pageView=this._pages[this._currentPageNumber-1],element=pageView.div,view={id:pageView.id,x:element.offsetLeft+element.clientLeft,y:element.offsetTop+element.clientTop,view:pageView};return{first:view,last:view,views:[view],ids:new Set([pageView.id])}}_getVisiblePages(){if(this.isInPresentationMode)return this._getCurrentVisiblePage();const views=this._scrollMode===_ui_utils.ScrollMode.PAGE?this.#scrollModePageState.pages:this._pages,horizontal=this._scrollMode===_ui_utils.ScrollMode.HORIZONTAL,rtl=horizontal&&this._isContainerRtl;return(0,_ui_utils.getVisibleElements)({scrollEl:this.container,views:views,sortByVisibility:!0,horizontal:horizontal,rtl:rtl})}isPageVisible(pageNumber){return!!this.pdfDocument&&(Number.isInteger(pageNumber)&&pageNumber>0&&pageNumber<=this.pagesCount?this._getVisiblePages().ids.has(pageNumber):(console.error(`isPageVisible: "${pageNumber}" is not a valid page.`),!1))}isPageCached(pageNumber){if(!this.pdfDocument)return!1;if(!(Number.isInteger(pageNumber)&&pageNumber>0&&pageNumber<=this.pagesCount))return console.error(`isPageCached: "${pageNumber}" is not a valid page.`),!1;const pageView=this._pages[pageNumber-1];return this.#buffer.has(pageView)}cleanup(){for(let i=0,ii=this._pages.length;i<ii;i++)this._pages[i]&&this._pages[i].renderingState!==_ui_utils.RenderingStates.FINISHED&&this._pages[i].reset()}_cancelRendering(){for(let i=0,ii=this._pages.length;i<ii;i++)this._pages[i]&&this._pages[i].cancelRendering()}async#ensurePdfPageLoaded(pageView){if(pageView.pdfPage)return pageView.pdfPage;try{const pdfPage=await this.pdfDocument.getPage(pageView.id);return pageView.pdfPage||pageView.setPdfPage(pdfPage),this.linkService._cachedPageNumber?.(pdfPage.ref)||this.linkService.cachePageRef(pageView.id,pdfPage.ref),pdfPage}catch(reason){return console.error("Unable to get page for page view",reason),null}}#getScrollAhead(visible){if(1===visible.first?.id)return!0;if(visible.last?.id===this.pagesCount)return!1;switch(this._scrollMode){case _ui_utils.ScrollMode.PAGE:return this.#scrollModePageState.scrollDown;case _ui_utils.ScrollMode.HORIZONTAL:return this.scroll.right}return this.scroll.down}#toggleLoadingIconSpinner(visibleIds){for(const id of visibleIds){this._pages[id-1]?.toggleLoadingIconSpinner(!0)}for(const pageView of this.#buffer)visibleIds.has(pageView.id)||pageView.toggleLoadingIconSpinner(!1)}forceRendering(currentlyVisiblePages){const visiblePages=currentlyVisiblePages||this._getVisiblePages(),scrollAhead=this.#getScrollAhead(visiblePages),preRenderExtra=this._spreadMode!==_ui_utils.SpreadMode.NONE&&this._scrollMode!==_ui_utils.ScrollMode.HORIZONTAL,pageView=this.renderingQueue.getHighestPriority(visiblePages,this._pages,scrollAhead,preRenderExtra);return this.#toggleLoadingIconSpinner(visiblePages.ids),!!pageView&&(this.#ensurePdfPageLoaded(pageView).then((()=>{this.renderingQueue.renderView(pageView)})),!0)}createTextLayerBuilder(textLayerDiv,pageIndex,viewport,enhanceTextSelection=!1,eventBus,highlighter){return new _text_layer_builder.TextLayerBuilder({textLayerDiv:textLayerDiv,eventBus:eventBus,pageIndex:pageIndex,viewport:viewport,enhanceTextSelection:!this.isInPresentationMode&&enhanceTextSelection,highlighter:highlighter})}createTextHighlighter(pageIndex,eventBus){return new _text_highlighter.TextHighlighter({eventBus:eventBus,pageIndex:pageIndex,findController:this.isInPresentationMode?null:this.findController})}createAnnotationLayerBuilder(pageDiv,pdfPage,annotationStorage=null,imageResourcesPath="",renderForms=!0,l10n=_l10n_utils.NullL10n,enableScripting=null,hasJSActionsPromise=null,mouseState=null,fieldObjectsPromise=null,annotationCanvasMap=null){return new _annotation_layer_builder.AnnotationLayerBuilder({pageDiv:pageDiv,pdfPage:pdfPage,annotationStorage:annotationStorage||this.pdfDocument?.annotationStorage,imageResourcesPath:imageResourcesPath,renderForms:renderForms,linkService:this.linkService,downloadManager:this.downloadManager,l10n:l10n,enableScripting:enableScripting??this.enableScripting,hasJSActionsPromise:hasJSActionsPromise||this.pdfDocument?.hasJSActions(),fieldObjectsPromise:fieldObjectsPromise||this.pdfDocument?.getFieldObjects(),mouseState:mouseState||this._scriptingManager?.mouseState,annotationCanvasMap:annotationCanvasMap})}createXfaLayerBuilder(pageDiv,pdfPage,annotationStorage=null){return new _xfa_layer_builder.XfaLayerBuilder({pageDiv:pageDiv,pdfPage:pdfPage,annotationStorage:annotationStorage||this.pdfDocument?.annotationStorage,linkService:this.linkService})}createStructTreeLayerBuilder(pdfPage){return new _struct_tree_layer_builder.StructTreeLayerBuilder({pdfPage:pdfPage})}get hasEqualPageSizes(){const firstPageView=this._pages[0];for(let i=1,ii=this._pages.length;i<ii;++i){const pageView=this._pages[i];if(pageView.width!==firstPageView.width||pageView.height!==firstPageView.height)return!1}return!0}getPagesOverview(){return this._pages.map((pageView=>{const viewport=pageView.pdfPage.getViewport({scale:1});return!this.enablePrintAutoRotate||(0,_ui_utils.isPortraitOrientation)(viewport)?{width:viewport.width,height:viewport.height,rotation:viewport.rotation}:{width:viewport.height,height:viewport.width,rotation:(viewport.rotation-90)%360}}))}get optionalContentConfigPromise(){return this.pdfDocument?this._optionalContentConfigPromise?this._optionalContentConfigPromise:this.pdfDocument.getOptionalContentConfig():Promise.resolve(null)}set optionalContentConfigPromise(promise){if(!(promise instanceof Promise))throw new Error(`Invalid optionalContentConfigPromise: ${promise}`);if(!this.pdfDocument)return;if(!this._optionalContentConfigPromise)return;this._optionalContentConfigPromise=promise;const updateArgs={optionalContentConfigPromise:promise};for(const pageView of this._pages)pageView.update(updateArgs);this.update(),this.eventBus.dispatch("optionalcontentconfigchanged",{source:this,promise:promise})}get scrollMode(){return this._scrollMode}set scrollMode(mode){if(this._scrollMode!==mode){if(!(0,_ui_utils.isValidScrollMode)(mode))throw new Error(`Invalid scroll mode: ${mode}`);this.pagesCount>PagesCountLimit.FORCE_SCROLL_MODE_PAGE||(this._previousScrollMode=this._scrollMode,this._scrollMode=mode,this.eventBus.dispatch("scrollmodechanged",{source:this,mode:mode}),this._updateScrollMode(this._currentPageNumber))}}_updateScrollMode(pageNumber=null){const scrollMode=this._scrollMode,viewer=this.viewer;viewer.classList.toggle("scrollHorizontal",scrollMode===_ui_utils.ScrollMode.HORIZONTAL),viewer.classList.toggle("scrollWrapped",scrollMode===_ui_utils.ScrollMode.WRAPPED),this.pdfDocument&&pageNumber&&(scrollMode===_ui_utils.ScrollMode.PAGE?this.#ensurePageViewVisible():this._previousScrollMode===_ui_utils.ScrollMode.PAGE&&this._updateSpreadMode(),this._currentScaleValue&&isNaN(this._currentScaleValue)&&this._setScale(this._currentScaleValue,!0),this._setCurrentPageNumber(pageNumber,!0),this.update())}get spreadMode(){return this._spreadMode}set spreadMode(mode){if(this._spreadMode!==mode){if(!(0,_ui_utils.isValidSpreadMode)(mode))throw new Error(`Invalid spread mode: ${mode}`);this._spreadMode=mode,this.eventBus.dispatch("spreadmodechanged",{source:this,mode:mode}),this._updateSpreadMode(this._currentPageNumber)}}_updateSpreadMode(pageNumber=null){if(!this.pdfDocument)return;const viewer=this.viewer,pages=this._pages;if(this._scrollMode===_ui_utils.ScrollMode.PAGE)this.#ensurePageViewVisible();else if(viewer.textContent="",this._spreadMode===_ui_utils.SpreadMode.NONE)for(let i=0,ii=pages.length;i<ii;++i)viewer.appendChild(pages[i].div);else{const parity=this._spreadMode-1;let spread=null;for(let i=0,ii=pages.length;i<ii;++i)null===spread?(spread=document.createElement("div"),spread.className="spread",viewer.appendChild(spread)):i%2===parity&&(spread=spread.cloneNode(!1),viewer.appendChild(spread)),spread.appendChild(pages[i].div)}pageNumber&&(this._currentScaleValue&&isNaN(this._currentScaleValue)&&this._setScale(this._currentScaleValue,!0),this._setCurrentPageNumber(pageNumber,!0),this.update())}_getPageAdvance(currentPageNumber,previous=!1){switch(this._scrollMode){case _ui_utils.ScrollMode.WRAPPED:{const{views:views}=this._getVisiblePages(),pageLayout=new Map;for(const{id:id,y:y,percent:percent,widthPercent:widthPercent}of views){if(0===percent||widthPercent<100)continue;let yArray=pageLayout.get(y);yArray||pageLayout.set(y,yArray||=[]),yArray.push(id)}for(const yArray of pageLayout.values()){const currentIndex=yArray.indexOf(currentPageNumber);if(-1===currentIndex)continue;const numPages=yArray.length;if(1===numPages)break;if(previous)for(let i=currentIndex-1,ii=0;i>=ii;i--){const currentId=yArray[i],expectedId=yArray[i+1]-1;if(currentId<expectedId)return currentPageNumber-expectedId}else for(let i=currentIndex+1,ii=numPages;i<ii;i++){const currentId=yArray[i],expectedId=yArray[i-1]+1;if(currentId>expectedId)return expectedId-currentPageNumber}if(previous){const firstId=yArray[0];if(firstId<currentPageNumber)return currentPageNumber-firstId+1}else{const lastId=yArray[numPages-1];if(lastId>currentPageNumber)return lastId-currentPageNumber+1}break}break}case _ui_utils.ScrollMode.HORIZONTAL:break;case _ui_utils.ScrollMode.PAGE:case _ui_utils.ScrollMode.VERTICAL:{if(this._spreadMode===_ui_utils.SpreadMode.NONE)break;const parity=this._spreadMode-1;if(previous&&currentPageNumber%2!==parity)break;if(!previous&&currentPageNumber%2===parity)break;const{views:views}=this._getVisiblePages(),expectedId=previous?currentPageNumber-1:currentPageNumber+1;for(const{id:id,percent:percent,widthPercent:widthPercent}of views)if(id===expectedId){if(percent>0&&100===widthPercent)return 2;break}break}}return 1}nextPage(){const currentPageNumber=this._currentPageNumber,pagesCount=this.pagesCount;if(currentPageNumber>=pagesCount)return!1;const advance=this._getPageAdvance(currentPageNumber,!1)||1;return this.currentPageNumber=Math.min(currentPageNumber+advance,pagesCount),!0}previousPage(){const currentPageNumber=this._currentPageNumber;if(currentPageNumber<=1)return!1;const advance=this._getPageAdvance(currentPageNumber,!0)||1;return this.currentPageNumber=Math.max(currentPageNumber-advance,1),!0}increaseScale(steps=1){let newScale=this._currentScale;do{newScale=(newScale*_ui_utils.DEFAULT_SCALE_DELTA).toFixed(2),newScale=Math.ceil(10*newScale)/10,newScale=Math.min(_ui_utils.MAX_SCALE,newScale)}while(--steps>0&&newScale<_ui_utils.MAX_SCALE);this.currentScaleValue=newScale}decreaseScale(steps=1){let newScale=this._currentScale;do{newScale=(newScale/_ui_utils.DEFAULT_SCALE_DELTA).toFixed(2),newScale=Math.floor(10*newScale)/10,newScale=Math.max(_ui_utils.MIN_SCALE,newScale)}while(--steps>0&&newScale>_ui_utils.MIN_SCALE);this.currentScaleValue=newScale}}exports.BaseViewer=BaseViewer},(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.AnnotationLayerBuilder=void 0;var _pdfjsLib=__webpack_require__(5),_l10n_utils=__webpack_require__(30);exports.AnnotationLayerBuilder=class{constructor({pageDiv:pageDiv,pdfPage:pdfPage,linkService:linkService,downloadManager:downloadManager,annotationStorage:annotationStorage=null,imageResourcesPath:imageResourcesPath="",renderForms:renderForms=!0,l10n:l10n=_l10n_utils.NullL10n,enableScripting:enableScripting=!1,hasJSActionsPromise:hasJSActionsPromise=null,fieldObjectsPromise:fieldObjectsPromise=null,mouseState:mouseState=null,annotationCanvasMap:annotationCanvasMap=null}){this.pageDiv=pageDiv,this.pdfPage=pdfPage,this.linkService=linkService,this.downloadManager=downloadManager,this.imageResourcesPath=imageResourcesPath,this.renderForms=renderForms,this.l10n=l10n,this.annotationStorage=annotationStorage,this.enableScripting=enableScripting,this._hasJSActionsPromise=hasJSActionsPromise,this._fieldObjectsPromise=fieldObjectsPromise,this._mouseState=mouseState,this._annotationCanvasMap=annotationCanvasMap,this.div=null,this._cancelled=!1}async render(viewport,intent="display"){const[annotations,hasJSActions=!1,fieldObjects=null]=await Promise.all([this.pdfPage.getAnnotations({intent:intent}),this._hasJSActionsPromise,this._fieldObjectsPromise]);if(this._cancelled||0===annotations.length)return;const parameters={viewport:viewport.clone({dontFlip:!0}),div:this.div,annotations:annotations,page:this.pdfPage,imageResourcesPath:this.imageResourcesPath,renderForms:this.renderForms,linkService:this.linkService,downloadManager:this.downloadManager,annotationStorage:this.annotationStorage,enableScripting:this.enableScripting,hasJSActions:hasJSActions,fieldObjects:fieldObjects,mouseState:this._mouseState,annotationCanvasMap:this._annotationCanvasMap};this.div?_pdfjsLib.AnnotationLayer.update(parameters):(this.div=document.createElement("div"),this.div.className="annotationLayer",this.pageDiv.appendChild(this.div),parameters.div=this.div,_pdfjsLib.AnnotationLayer.render(parameters),this.l10n.translate(this.div))}cancel(){this._cancelled=!0}hide(){this.div&&(this.div.hidden=!0)}}},(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.NullL10n=void 0,exports.fixupLangCode=function(langCode){return PARTIAL_LANG_CODES[langCode?.toLowerCase()]||langCode},exports.getL10nFallback=getL10nFallback;const DEFAULT_L10N_STRINGS={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",print_progress_percent:"{{progress}}%","toggle_sidebar.title":"Toggle Sidebar","toggle_sidebar_notification2.title":"Toggle Sidebar (document contains outline/attachments/layers)",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",error_version_info:"PDF.js v{{version}} (build: {{build}})",error_message:"Message: {{message}}",error_stack:"Stack: {{stack}}",error_file:"File: {{file}}",error_line:"Line: {{line}}",rendering_error:"An error occurred while rendering the page.",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading:"Loading…",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts."};function getL10nFallback(key,args){switch(key){case"find_match_count":key=`find_match_count[${1===args.total?"one":"other"}]`;break;case"find_match_count_limit":key=`find_match_count_limit[${1===args.limit?"one":"other"}]`}return DEFAULT_L10N_STRINGS[key]||""}const PARTIAL_LANG_CODES={en:"en-US",es:"es-ES",fy:"fy-NL",ga:"ga-IE",gu:"gu-IN",hi:"hi-IN",hy:"hy-AM",nb:"nb-NO",ne:"ne-NP",nn:"nn-NO",pa:"pa-IN",pt:"pt-PT",sv:"sv-SE",zh:"zh-CN"};const NullL10n={getLanguage:async()=>"en-us",getDirection:async()=>"ltr",get:async(key,args=null,fallback=getL10nFallback(key,args))=>function(text,args){return args?text.replace(/\{\{\s*(\w+)\s*\}\}/g,((all,name)=>name in args?args[name]:"{{"+name+"}}")):text}(fallback,args),async translate(element){}};exports.NullL10n=NullL10n},(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.PDFPageView=void 0;var _pdfjsLib=__webpack_require__(5),_ui_utils=__webpack_require__(3),_app_options=__webpack_require__(1),_l10n_utils=__webpack_require__(30);const MAX_CANVAS_PIXELS=_app_options.compatibilityParams.maxCanvasPixels||16777216;exports.PDFPageView=class{#annotationMode=_pdfjsLib.AnnotationMode.ENABLE_FORMS;constructor(options){const container=options.container,defaultViewport=options.defaultViewport;this.id=options.id,this.renderingId="page"+this.id,this.pdfPage=null,this.pageLabel=null,this.rotation=0,this.scale=options.scale||_ui_utils.DEFAULT_SCALE,this.viewport=defaultViewport,this.pdfPageRotate=defaultViewport.rotation,this._optionalContentConfigPromise=options.optionalContentConfigPromise||null,this.hasRestrictedScaling=!1,this.textLayerMode=options.textLayerMode??_ui_utils.TextLayerMode.ENABLE,this.#annotationMode=options.annotationMode??_pdfjsLib.AnnotationMode.ENABLE_FORMS,this.imageResourcesPath=options.imageResourcesPath||"",this.useOnlyCssZoom=options.useOnlyCssZoom||!1,this.maxCanvasPixels=options.maxCanvasPixels||MAX_CANVAS_PIXELS,this.eventBus=options.eventBus,this.renderingQueue=options.renderingQueue,this.textLayerFactory=options.textLayerFactory,this.annotationLayerFactory=options.annotationLayerFactory,this.xfaLayerFactory=options.xfaLayerFactory,this.textHighlighter=options.textHighlighterFactory?.createTextHighlighter(this.id-1,this.eventBus),this.structTreeLayerFactory=options.structTreeLayerFactory,this.renderer=options.renderer||_ui_utils.RendererType.CANVAS,this.l10n=options.l10n||_l10n_utils.NullL10n,this.paintTask=null,this.paintedViewportMap=new WeakMap,this.renderingState=_ui_utils.RenderingStates.INITIAL,this.resume=null,this._renderError=null,this._isStandalone=!this.renderingQueue?.hasViewer(),this._annotationCanvasMap=null,this.annotationLayer=null,this.textLayer=null,this.zoomLayer=null,this.xfaLayer=null,this.structTreeLayer=null;const div=document.createElement("div");div.className="page",div.style.width=Math.floor(this.viewport.width)+"px",div.style.height=Math.floor(this.viewport.height)+"px",div.setAttribute("data-page-number",this.id),div.setAttribute("role","region"),this.l10n.get("page_landmark",{page:this.id}).then((msg=>{div.setAttribute("aria-label",msg)})),this.div=div,container?.appendChild(div)}setPdfPage(pdfPage){this.pdfPage=pdfPage,this.pdfPageRotate=pdfPage.rotate;const totalRotation=(this.rotation+this.pdfPageRotate)%360;this.viewport=pdfPage.getViewport({scale:this.scale*_pdfjsLib.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:totalRotation}),this.reset()}destroy(){this.reset(),this.pdfPage&&this.pdfPage.cleanup()}async _renderAnnotationLayer(){let error=null;try{await this.annotationLayer.render(this.viewport,"display")}catch(ex){error=ex}finally{this.eventBus.dispatch("annotationlayerrendered",{source:this,pageNumber:this.id,error:error})}}async _renderXfaLayer(){let error=null;try{const result=await this.xfaLayer.render(this.viewport,"display");this.textHighlighter&&this._buildXfaTextContentItems(result.textDivs)}catch(ex){error=ex}finally{this.eventBus.dispatch("xfalayerrendered",{source:this,pageNumber:this.id,error:error})}}async _buildXfaTextContentItems(textDivs){const text=await this.pdfPage.getTextContent(),items=[];for(const item of text.items)items.push(item.str);this.textHighlighter.setTextMapping(textDivs,items),this.textHighlighter.enable()}_resetZoomLayer(removeFromDOM=!1){if(!this.zoomLayer)return;const zoomLayerCanvas=this.zoomLayer.firstChild;this.paintedViewportMap.delete(zoomLayerCanvas),zoomLayerCanvas.width=0,zoomLayerCanvas.height=0,removeFromDOM&&this.zoomLayer.remove(),this.zoomLayer=null}reset({keepZoomLayer:keepZoomLayer=!1,keepAnnotationLayer:keepAnnotationLayer=!1,keepXfaLayer:keepXfaLayer=!1}={}){this.cancelRendering({keepAnnotationLayer:keepAnnotationLayer,keepXfaLayer:keepXfaLayer}),this.renderingState=_ui_utils.RenderingStates.INITIAL;const div=this.div;div.style.width=Math.floor(this.viewport.width)+"px",div.style.height=Math.floor(this.viewport.height)+"px";const childNodes=div.childNodes,zoomLayerNode=keepZoomLayer&&this.zoomLayer||null,annotationLayerNode=keepAnnotationLayer&&this.annotationLayer?.div||null,xfaLayerNode=keepXfaLayer&&this.xfaLayer?.div||null;for(let i=childNodes.length-1;i>=0;i--){const node=childNodes[i];switch(node){case zoomLayerNode:case annotationLayerNode:case xfaLayerNode:continue}node.remove()}div.removeAttribute("data-loaded"),annotationLayerNode&&this.annotationLayer.hide(),xfaLayerNode&&this.xfaLayer.hide(),zoomLayerNode||(this.canvas&&(this.paintedViewportMap.delete(this.canvas),this.canvas.width=0,this.canvas.height=0,delete this.canvas),this._resetZoomLayer()),this.svg&&(this.paintedViewportMap.delete(this.svg),delete this.svg),this.loadingIconDiv=document.createElement("div"),this.loadingIconDiv.className="loadingIcon notVisible",this._isStandalone&&this.toggleLoadingIconSpinner(!0),this.loadingIconDiv.setAttribute("role","img"),this.l10n.get("loading").then((msg=>{this.loadingIconDiv?.setAttribute("aria-label",msg)})),div.appendChild(this.loadingIconDiv)}update({scale:scale=0,rotation:rotation=null,optionalContentConfigPromise:optionalContentConfigPromise=null}){if("object"!=typeof arguments[0])return console.error("PDFPageView.update called with separate parameters, please use an object instead."),void this.update({scale:arguments[0],rotation:arguments[1],optionalContentConfigPromise:arguments[2]});this.scale=scale||this.scale,"number"==typeof rotation&&(this.rotation=rotation),optionalContentConfigPromise instanceof Promise&&(this._optionalContentConfigPromise=optionalContentConfigPromise);const totalRotation=(this.rotation+this.pdfPageRotate)%360,viewportScale=this.scale*_pdfjsLib.PixelsPerInch.PDF_TO_CSS_UNITS;if(this.viewport=this.viewport.clone({scale:viewportScale,rotation:totalRotation}),this._isStandalone){const{style:style}=document.documentElement;style.setProperty("--zoom-factor",this.scale),style.setProperty("--viewport-scale-factor",viewportScale)}if(this.svg)return this.cssTransform({target:this.svg,redrawAnnotationLayer:!0,redrawXfaLayer:!0}),void this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!0,timestamp:performance.now(),error:this._renderError});let isScalingRestricted=!1;if(this.canvas&&this.maxCanvasPixels>0){const outputScale=this.outputScale;(Math.floor(this.viewport.width)*outputScale.sx|0)*(Math.floor(this.viewport.height)*outputScale.sy|0)>this.maxCanvasPixels&&(isScalingRestricted=!0)}if(this.canvas){if(this.useOnlyCssZoom||this.hasRestrictedScaling&&isScalingRestricted)return this.cssTransform({target:this.canvas,redrawAnnotationLayer:!0,redrawXfaLayer:!0}),void this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!0,timestamp:performance.now(),error:this._renderError});this.zoomLayer||this.canvas.hidden||(this.zoomLayer=this.canvas.parentNode,this.zoomLayer.style.position="absolute")}this.zoomLayer&&this.cssTransform({target:this.zoomLayer.firstChild}),this.reset({keepZoomLayer:!0,keepAnnotationLayer:!0,keepXfaLayer:!0})}cancelRendering({keepAnnotationLayer:keepAnnotationLayer=!1,keepXfaLayer:keepXfaLayer=!1}={}){this.paintTask&&(this.paintTask.cancel(),this.paintTask=null),this.resume=null,this.textLayer&&(this.textLayer.cancel(),this.textLayer=null),!this.annotationLayer||keepAnnotationLayer&&this.annotationLayer.div||(this.annotationLayer.cancel(),this.annotationLayer=null,this._annotationCanvasMap=null),!this.xfaLayer||keepXfaLayer&&this.xfaLayer.div||(this.xfaLayer.cancel(),this.xfaLayer=null,this.textHighlighter?.disable()),this._onTextLayerRendered&&(this.eventBus._off("textlayerrendered",this._onTextLayerRendered),this._onTextLayerRendered=null)}cssTransform({target:target,redrawAnnotationLayer:redrawAnnotationLayer=!1,redrawXfaLayer:redrawXfaLayer=!1}){const width=this.viewport.width,height=this.viewport.height,div=this.div;target.style.width=target.parentNode.style.width=div.style.width=Math.floor(width)+"px",target.style.height=target.parentNode.style.height=div.style.height=Math.floor(height)+"px";const relativeRotation=this.viewport.rotation-this.paintedViewportMap.get(target).rotation,absRotation=Math.abs(relativeRotation);let scaleX=1,scaleY=1;if(90!==absRotation&&270!==absRotation||(scaleX=height/width,scaleY=width/height),target.style.transform=`rotate(${relativeRotation}deg) scale(${scaleX}, ${scaleY})`,this.textLayer){const textLayerViewport=this.textLayer.viewport,textRelativeRotation=this.viewport.rotation-textLayerViewport.rotation,textAbsRotation=Math.abs(textRelativeRotation);let scale=width/textLayerViewport.width;90!==textAbsRotation&&270!==textAbsRotation||(scale=width/textLayerViewport.height);const textLayerDiv=this.textLayer.textLayerDiv;let transX,transY;switch(textAbsRotation){case 0:transX=transY=0;break;case 90:transX=0,transY="-"+textLayerDiv.style.height;break;case 180:transX="-"+textLayerDiv.style.width,transY="-"+textLayerDiv.style.height;break;case 270:transX="-"+textLayerDiv.style.width,transY=0;break;default:console.error("Bad rotation value.")}textLayerDiv.style.transform=`rotate(${textAbsRotation}deg) scale(${scale}) translate(${transX}, ${transY})`,textLayerDiv.style.transformOrigin="0% 0%"}redrawAnnotationLayer&&this.annotationLayer&&this._renderAnnotationLayer(),redrawXfaLayer&&this.xfaLayer&&this._renderXfaLayer()}get width(){return this.viewport.width}get height(){return this.viewport.height}getPagePoint(x,y){return this.viewport.convertToPdfPoint(x,y)}toggleLoadingIconSpinner(viewVisible=!1){this.loadingIconDiv?.classList.toggle("notVisible",!viewVisible)}draw(){this.renderingState!==_ui_utils.RenderingStates.INITIAL&&(console.error("Must be in new state before drawing"),this.reset());const{div:div,pdfPage:pdfPage}=this;if(!pdfPage)return this.renderingState=_ui_utils.RenderingStates.FINISHED,this.loadingIconDiv&&(this.loadingIconDiv.remove(),delete this.loadingIconDiv),Promise.reject(new Error("pdfPage is not loaded"));this.renderingState=_ui_utils.RenderingStates.RUNNING;const canvasWrapper=document.createElement("div");canvasWrapper.style.width=div.style.width,canvasWrapper.style.height=div.style.height,canvasWrapper.classList.add("canvasWrapper"),this.annotationLayer?.div?div.insertBefore(canvasWrapper,this.annotationLayer.div):div.appendChild(canvasWrapper);let textLayer=null;if(this.textLayerMode!==_ui_utils.TextLayerMode.DISABLE&&this.textLayerFactory){const textLayerDiv=document.createElement("div");textLayerDiv.className="textLayer",textLayerDiv.style.width=canvasWrapper.style.width,textLayerDiv.style.height=canvasWrapper.style.height,this.annotationLayer?.div?div.insertBefore(textLayerDiv,this.annotationLayer.div):div.appendChild(textLayerDiv),textLayer=this.textLayerFactory.createTextLayerBuilder(textLayerDiv,this.id-1,this.viewport,this.textLayerMode===_ui_utils.TextLayerMode.ENABLE_ENHANCE,this.eventBus,this.textHighlighter)}this.textLayer=textLayer,this.#annotationMode!==_pdfjsLib.AnnotationMode.DISABLE&&this.annotationLayerFactory&&(this._annotationCanvasMap||=new Map,this.annotationLayer||=this.annotationLayerFactory.createAnnotationLayerBuilder(div,pdfPage,null,this.imageResourcesPath,this.#annotationMode===_pdfjsLib.AnnotationMode.ENABLE_FORMS,this.l10n,null,null,null,null,this._annotationCanvasMap)),this.xfaLayer?.div&&div.appendChild(this.xfaLayer.div);let renderContinueCallback=null;this.renderingQueue&&(renderContinueCallback=cont=>{if(!this.renderingQueue.isHighestPriority(this))return this.renderingState=_ui_utils.RenderingStates.PAUSED,void(this.resume=()=>{this.renderingState=_ui_utils.RenderingStates.RUNNING,cont()});cont()});const finishPaintTask=async(error=null)=>{if(paintTask===this.paintTask&&(this.paintTask=null),error instanceof _pdfjsLib.RenderingCancelledException)this._renderError=null;else if(this._renderError=error,this.renderingState=_ui_utils.RenderingStates.FINISHED,this.loadingIconDiv&&(this.loadingIconDiv.remove(),delete this.loadingIconDiv),this._resetZoomLayer(!0),this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!1,timestamp:performance.now(),error:this._renderError}),error)throw error},paintTask=this.renderer===_ui_utils.RendererType.SVG?this.paintOnSvg(canvasWrapper):this.paintOnCanvas(canvasWrapper);paintTask.onRenderContinue=renderContinueCallback,this.paintTask=paintTask;const resultPromise=paintTask.promise.then((()=>finishPaintTask(null).then((()=>{if(textLayer){const readableStream=pdfPage.streamTextContent({includeMarkedContent:!0});textLayer.setTextContentStream(readableStream),textLayer.render()}this.annotationLayer&&this._renderAnnotationLayer()}))),(function(reason){return finishPaintTask(reason)}));return this.xfaLayerFactory&&(this.xfaLayer||(this.xfaLayer=this.xfaLayerFactory.createXfaLayerBuilder(div,pdfPage,null)),this._renderXfaLayer()),this.structTreeLayerFactory&&this.textLayer&&this.canvas&&(this._onTextLayerRendered=event=>{event.pageNumber===this.id&&(this.eventBus._off("textlayerrendered",this._onTextLayerRendered),this._onTextLayerRendered=null,this.canvas&&this.pdfPage.getStructTree().then((tree=>{if(!tree)return;if(!this.canvas)return;const treeDom=this.structTreeLayer.render(tree);treeDom.classList.add("structTree"),this.canvas.appendChild(treeDom)})))},this.eventBus._on("textlayerrendered",this._onTextLayerRendered),this.structTreeLayer=this.structTreeLayerFactory.createStructTreeLayerBuilder(pdfPage)),div.setAttribute("data-loaded",!0),this.eventBus.dispatch("pagerender",{source:this,pageNumber:this.id}),resultPromise}paintOnCanvas(canvasWrapper){const renderCapability=(0,_pdfjsLib.createPromiseCapability)(),result={promise:renderCapability.promise,onRenderContinue(cont){cont()},cancel(){renderTask.cancel()}},viewport=this.viewport,canvas=document.createElement("canvas");canvas.hidden=!0;let isCanvasHidden=!0;const showCanvas=function(){isCanvasHidden&&(canvas.hidden=!1,isCanvasHidden=!1)};canvasWrapper.appendChild(canvas),this.canvas=canvas,canvas.mozOpaque=!0;const ctx=canvas.getContext("2d",{alpha:!1}),outputScale=this.outputScale=new _ui_utils.OutputScale;if(this.useOnlyCssZoom){const actualSizeViewport=viewport.clone({scale:_pdfjsLib.PixelsPerInch.PDF_TO_CSS_UNITS});outputScale.sx*=actualSizeViewport.width/viewport.width,outputScale.sy*=actualSizeViewport.height/viewport.height}if(this.maxCanvasPixels>0){const pixelsInViewport=viewport.width*viewport.height,maxScale=Math.sqrt(this.maxCanvasPixels/pixelsInViewport);outputScale.sx>maxScale||outputScale.sy>maxScale?(outputScale.sx=maxScale,outputScale.sy=maxScale,this.hasRestrictedScaling=!0):this.hasRestrictedScaling=!1}const sfx=(0,_ui_utils.approximateFraction)(outputScale.sx),sfy=(0,_ui_utils.approximateFraction)(outputScale.sy);canvas.width=(0,_ui_utils.roundToDivide)(viewport.width*outputScale.sx,sfx[0]),canvas.height=(0,_ui_utils.roundToDivide)(viewport.height*outputScale.sy,sfy[0]),canvas.style.width=(0,_ui_utils.roundToDivide)(viewport.width,sfx[1])+"px",canvas.style.height=(0,_ui_utils.roundToDivide)(viewport.height,sfy[1])+"px",this.paintedViewportMap.set(canvas,viewport);const renderContext={canvasContext:ctx,transform:outputScale.scaled?[outputScale.sx,0,0,outputScale.sy,0,0]:null,viewport:this.viewport,annotationMode:this.#annotationMode,optionalContentConfigPromise:this._optionalContentConfigPromise,annotationCanvasMap:this._annotationCanvasMap},renderTask=this.pdfPage.render(renderContext);return renderTask.onContinue=function(cont){showCanvas(),result.onRenderContinue?result.onRenderContinue(cont):cont()},renderTask.promise.then((function(){showCanvas(),renderCapability.resolve()}),(function(error){showCanvas(),renderCapability.reject(error)})),result}paintOnSvg(wrapper){let cancelled=!1;const ensureNotCancelled=()=>{if(cancelled)throw new _pdfjsLib.RenderingCancelledException(`Rendering cancelled, page ${this.id}`,"svg")},pdfPage=this.pdfPage,actualSizeViewport=this.viewport.clone({scale:_pdfjsLib.PixelsPerInch.PDF_TO_CSS_UNITS});return{promise:pdfPage.getOperatorList({annotationMode:this.#annotationMode}).then((opList=>{ensureNotCancelled();return new _pdfjsLib.SVGGraphics(pdfPage.commonObjs,pdfPage.objs).getSVG(opList,actualSizeViewport).then((svg=>{ensureNotCancelled(),this.svg=svg,this.paintedViewportMap.set(svg,actualSizeViewport),svg.style.width=wrapper.style.width,svg.style.height=wrapper.style.height,this.renderingState=_ui_utils.RenderingStates.FINISHED,wrapper.appendChild(svg)}))})),onRenderContinue(cont){cont()},cancel(){cancelled=!0}}}setPageLabel(label){this.pageLabel="string"==typeof label?label:null,null!==this.pageLabel?this.div.setAttribute("data-page-label",this.pageLabel):this.div.removeAttribute("data-page-label")}}},(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.StructTreeLayerBuilder=void 0;const PDF_ROLE_TO_HTML_ROLE={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},HEADING_PATTERN=/^H(\d+)$/;exports.StructTreeLayerBuilder=class{constructor({pdfPage:pdfPage}){this.pdfPage=pdfPage}render(structTree){return this._walk(structTree)}_setAttributes(structElement,htmlElement){void 0!==structElement.alt&&htmlElement.setAttribute("aria-label",structElement.alt),void 0!==structElement.id&&htmlElement.setAttribute("aria-owns",structElement.id),void 0!==structElement.lang&&htmlElement.setAttribute("lang",structElement.lang)}_walk(node){if(!node)return null;const element=document.createElement("span");if("role"in node){const{role:role}=node,match=role.match(HEADING_PATTERN);match?(element.setAttribute("role","heading"),element.setAttribute("aria-level",match[1])):PDF_ROLE_TO_HTML_ROLE[role]&&element.setAttribute("role",PDF_ROLE_TO_HTML_ROLE[role])}if(this._setAttributes(node,element),node.children)if(1===node.children.length&&"id"in node.children[0])this._setAttributes(node.children[0],element);else for(const kid of node.children)element.appendChild(this._walk(kid));return element}}},(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.TextHighlighter=void 0;exports.TextHighlighter=class{constructor({findController:findController,eventBus:eventBus,pageIndex:pageIndex}){this.findController=findController,this.matches=[],this.eventBus=eventBus,this.pageIdx=pageIndex,this._onUpdateTextLayerMatches=null,this.textDivs=null,this.textContentItemsStr=null,this.enabled=!1}setTextMapping(divs,texts){this.textDivs=divs,this.textContentItemsStr=texts}enable(){if(!this.textDivs||!this.textContentItemsStr)throw new Error("Text divs and strings have not been set.");if(this.enabled)throw new Error("TextHighlighter is already enabled.");this.enabled=!0,this._onUpdateTextLayerMatches||(this._onUpdateTextLayerMatches=evt=>{evt.pageIndex!==this.pageIdx&&-1!==evt.pageIndex||this._updateMatches()},this.eventBus._on("updatetextlayermatches",this._onUpdateTextLayerMatches)),this._updateMatches()}disable(){this.enabled&&(this.enabled=!1,this._onUpdateTextLayerMatches&&(this.eventBus._off("updatetextlayermatches",this._onUpdateTextLayerMatches),this._onUpdateTextLayerMatches=null))}_convertMatches(matches,matchesLength){if(!matches)return[];const{textContentItemsStr:textContentItemsStr}=this;let i=0,iIndex=0;const end=textContentItemsStr.length-1,result=[];for(let m=0,mm=matches.length;m<mm;m++){let matchIdx=matches[m];for(;i!==end&&matchIdx>=iIndex+textContentItemsStr[i].length;)iIndex+=textContentItemsStr[i].length,i++;i===textContentItemsStr.length&&console.error("Could not find a matching mapping");const match={begin:{divIdx:i,offset:matchIdx-iIndex}};for(matchIdx+=matchesLength[m];i!==end&&matchIdx>iIndex+textContentItemsStr[i].length;)iIndex+=textContentItemsStr[i].length,i++;match.end={divIdx:i,offset:matchIdx-iIndex},result.push(match)}return result}_renderMatches(matches){if(0===matches.length)return;const{findController:findController,pageIdx:pageIdx}=this,{textContentItemsStr:textContentItemsStr,textDivs:textDivs}=this,isSelectedPage=pageIdx===findController.selected.pageIdx,selectedMatchIdx=findController.selected.matchIdx;let prevEnd=null;const infinity={divIdx:-1,offset:void 0};function beginText(begin,className){const divIdx=begin.divIdx;return textDivs[divIdx].textContent="",appendTextToDiv(divIdx,0,begin.offset,className)}function appendTextToDiv(divIdx,fromOffset,toOffset,className){let div=textDivs[divIdx];if(div.nodeType===Node.TEXT_NODE){const span=document.createElement("span");div.parentNode.insertBefore(span,div),span.appendChild(div),textDivs[divIdx]=span,div=span}const content=textContentItemsStr[divIdx].substring(fromOffset,toOffset),node=document.createTextNode(content);if(className){const span=document.createElement("span");return span.className=`${className} appended`,span.appendChild(node),div.appendChild(span),className.includes("selected")?span.offsetLeft:0}return div.appendChild(node),0}let i0=selectedMatchIdx,i1=i0+1;if(findController.state.highlightAll)i0=0,i1=matches.length;else if(!isSelectedPage)return;for(let i=i0;i<i1;i++){const match=matches[i],begin=match.begin,end=match.end,isSelected=isSelectedPage&&i===selectedMatchIdx,highlightSuffix=isSelected?" selected":"";let selectedLeft=0;if(prevEnd&&begin.divIdx===prevEnd.divIdx?appendTextToDiv(prevEnd.divIdx,prevEnd.offset,begin.offset):(null!==prevEnd&&appendTextToDiv(prevEnd.divIdx,prevEnd.offset,infinity.offset),beginText(begin)),begin.divIdx===end.divIdx)selectedLeft=appendTextToDiv(begin.divIdx,begin.offset,end.offset,"highlight"+highlightSuffix);else{selectedLeft=appendTextToDiv(begin.divIdx,begin.offset,infinity.offset,"highlight begin"+highlightSuffix);for(let n0=begin.divIdx+1,n1=end.divIdx;n0<n1;n0++)textDivs[n0].className="highlight middle"+highlightSuffix;beginText(end,"highlight end"+highlightSuffix)}prevEnd=end,isSelected&&findController.scrollMatchIntoView({element:textDivs[begin.divIdx],selectedLeft:selectedLeft,pageIndex:pageIdx,matchIndex:selectedMatchIdx})}prevEnd&&appendTextToDiv(prevEnd.divIdx,prevEnd.offset,infinity.offset)}_updateMatches(){if(!this.enabled)return;const{findController:findController,matches:matches,pageIdx:pageIdx}=this,{textContentItemsStr:textContentItemsStr,textDivs:textDivs}=this;let clearedUntilDivIdx=-1;for(let i=0,ii=matches.length;i<ii;i++){const match=matches[i];for(let n=Math.max(clearedUntilDivIdx,match.begin.divIdx),end=match.end.divIdx;n<=end;n++){const div=textDivs[n];div.textContent=textContentItemsStr[n],div.className=""}clearedUntilDivIdx=match.end.divIdx+1}if(!findController?.highlightMatches)return;const pageMatches=findController.pageMatches[pageIdx]||null,pageMatchesLength=findController.pageMatchesLength[pageIdx]||null;this.matches=this._convertMatches(pageMatches,pageMatchesLength),this._renderMatches(this.matches)}}},(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.TextLayerBuilder=void 0;var _pdfjsLib=__webpack_require__(5);exports.TextLayerBuilder=class{constructor({textLayerDiv:textLayerDiv,eventBus:eventBus,pageIndex:pageIndex,viewport:viewport,highlighter:highlighter=null,enhanceTextSelection:enhanceTextSelection=!1}){this.textLayerDiv=textLayerDiv,this.eventBus=eventBus,this.textContent=null,this.textContentItemsStr=[],this.textContentStream=null,this.renderingDone=!1,this.pageNumber=pageIndex+1,this.viewport=viewport,this.textDivs=[],this.textLayerRenderTask=null,this.highlighter=highlighter,this.enhanceTextSelection=enhanceTextSelection,this._bindMouse()}_finishRendering(){if(this.renderingDone=!0,!this.enhanceTextSelection){const endOfContent=document.createElement("div");endOfContent.className="endOfContent",this.textLayerDiv.appendChild(endOfContent)}this.eventBus.dispatch("textlayerrendered",{source:this,pageNumber:this.pageNumber,numTextDivs:this.textDivs.length})}render(timeout=0){if(!this.textContent&&!this.textContentStream||this.renderingDone)return;this.cancel(),this.textDivs.length=0,this.highlighter?.setTextMapping(this.textDivs,this.textContentItemsStr);const textLayerFrag=document.createDocumentFragment();this.textLayerRenderTask=(0,_pdfjsLib.renderTextLayer)({textContent:this.textContent,textContentStream:this.textContentStream,container:textLayerFrag,viewport:this.viewport,textDivs:this.textDivs,textContentItemsStr:this.textContentItemsStr,timeout:timeout,enhanceTextSelection:this.enhanceTextSelection}),this.textLayerRenderTask.promise.then((()=>{this.textLayerDiv.appendChild(textLayerFrag),this._finishRendering(),this.highlighter?.enable()}),(function(reason){}))}cancel(){this.textLayerRenderTask&&(this.textLayerRenderTask.cancel(),this.textLayerRenderTask=null),this.highlighter?.disable()}setTextContentStream(readableStream){this.cancel(),this.textContentStream=readableStream}setTextContent(textContent){this.cancel(),this.textContent=textContent}_bindMouse(){const div=this.textLayerDiv;let expandDivsTimer=null;div.addEventListener("mousedown",(evt=>{if(this.enhanceTextSelection&&this.textLayerRenderTask)return this.textLayerRenderTask.expandTextDivs(!0),void(expandDivsTimer&&(clearTimeout(expandDivsTimer),expandDivsTimer=null));const end=div.querySelector(".endOfContent");if(!end)return;let adjustTop=evt.target!==div;if(adjustTop=adjustTop&&"none"!==window.getComputedStyle(end).getPropertyValue("-moz-user-select"),adjustTop){const divBounds=div.getBoundingClientRect(),r=Math.max(0,(evt.pageY-divBounds.top)/divBounds.height);end.style.top=(100*r).toFixed(2)+"%"}end.classList.add("active")})),div.addEventListener("mouseup",(()=>{if(this.enhanceTextSelection&&this.textLayerRenderTask)return void(expandDivsTimer=setTimeout((()=>{this.textLayerRenderTask&&this.textLayerRenderTask.expandTextDivs(!1),expandDivsTimer=null}),300));const end=div.querySelector(".endOfContent");end&&(end.style.top="",end.classList.remove("active"))}))}}},(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.XfaLayerBuilder=void 0;var _pdfjsLib=__webpack_require__(5);exports.XfaLayerBuilder=class{constructor({pageDiv:pageDiv,pdfPage:pdfPage,annotationStorage:annotationStorage=null,linkService:linkService,xfaHtml:xfaHtml=null}){this.pageDiv=pageDiv,this.pdfPage=pdfPage,this.annotationStorage=annotationStorage,this.linkService=linkService,this.xfaHtml=xfaHtml,this.div=null,this._cancelled=!1}render(viewport,intent="display"){if("print"===intent){const parameters={viewport:viewport.clone({dontFlip:!0}),div:this.div,xfaHtml:this.xfaHtml,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:intent},div=document.createElement("div");this.pageDiv.appendChild(div),parameters.div=div;const result=_pdfjsLib.XfaLayer.render(parameters);return Promise.resolve(result)}return this.pdfPage.getXfa().then((xfaHtml=>{if(this._cancelled||!xfaHtml)return{textDivs:[]};const parameters={viewport:viewport.clone({dontFlip:!0}),div:this.div,xfaHtml:xfaHtml,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:intent};return this.div?_pdfjsLib.XfaLayer.update(parameters):(this.div=document.createElement("div"),this.pageDiv.appendChild(this.div),parameters.div=this.div,_pdfjsLib.XfaLayer.render(parameters))})).catch((error=>{console.error(error)}))}cancel(){this._cancelled=!0}hide(){this.div&&(this.div.hidden=!0)}}},(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.SecondaryToolbar=void 0;var _ui_utils=__webpack_require__(3),_pdf_cursor_tools=__webpack_require__(6),_base_viewer=__webpack_require__(28);exports.SecondaryToolbar=class{constructor(options,mainContainer,eventBus){this.toolbar=options.toolbar,this.toggleButton=options.toggleButton,this.toolbarButtonContainer=options.toolbarButtonContainer,this.buttons=[{element:options.presentationModeButton,eventName:"presentationmode",close:!0},{element:options.openFileButton,eventName:"openfile",close:!0},{element:options.printButton,eventName:"print",close:!0},{element:options.downloadButton,eventName:"download",close:!0},{element:options.viewBookmarkButton,eventName:null,close:!0},{element:options.firstPageButton,eventName:"firstpage",close:!0},{element:options.lastPageButton,eventName:"lastpage",close:!0},{element:options.pageRotateCwButton,eventName:"rotatecw",close:!1},{element:options.pageRotateCcwButton,eventName:"rotateccw",close:!1},{element:options.cursorSelectToolButton,eventName:"switchcursortool",eventDetails:{tool:_pdf_cursor_tools.CursorTool.SELECT},close:!0},{element:options.cursorHandToolButton,eventName:"switchcursortool",eventDetails:{tool:_pdf_cursor_tools.CursorTool.HAND},close:!0},{element:options.scrollPageButton,eventName:"switchscrollmode",eventDetails:{mode:_ui_utils.ScrollMode.PAGE},close:!0},{element:options.scrollVerticalButton,eventName:"switchscrollmode",eventDetails:{mode:_ui_utils.ScrollMode.VERTICAL},close:!0},{element:options.scrollHorizontalButton,eventName:"switchscrollmode",eventDetails:{mode:_ui_utils.ScrollMode.HORIZONTAL},close:!0},{element:options.scrollWrappedButton,eventName:"switchscrollmode",eventDetails:{mode:_ui_utils.ScrollMode.WRAPPED},close:!0},{element:options.spreadNoneButton,eventName:"switchspreadmode",eventDetails:{mode:_ui_utils.SpreadMode.NONE},close:!0},{element:options.spreadOddButton,eventName:"switchspreadmode",eventDetails:{mode:_ui_utils.SpreadMode.ODD},close:!0},{element:options.spreadEvenButton,eventName:"switchspreadmode",eventDetails:{mode:_ui_utils.SpreadMode.EVEN},close:!0},{element:options.documentPropertiesButton,eventName:"documentproperties",close:!0}],this.items={firstPage:options.firstPageButton,lastPage:options.lastPageButton,pageRotateCw:options.pageRotateCwButton,pageRotateCcw:options.pageRotateCcwButton},this.mainContainer=mainContainer,this.eventBus=eventBus,this.opened=!1,this.containerHeight=null,this.previousContainerHeight=null,this.reset(),this._bindClickListeners(),this._bindCursorToolsListener(options),this._bindScrollModeListener(options),this._bindSpreadModeListener(options),this.eventBus._on("resize",this._setMaxHeight.bind(this))}get isOpen(){return this.opened}setPageNumber(pageNumber){this.pageNumber=pageNumber,this._updateUIState()}setPagesCount(pagesCount){this.pagesCount=pagesCount,this._updateUIState()}reset(){this.pageNumber=0,this.pagesCount=0,this._updateUIState(),this.eventBus.dispatch("secondarytoolbarreset",{source:this})}_updateUIState(){this.items.firstPage.disabled=this.pageNumber<=1,this.items.lastPage.disabled=this.pageNumber>=this.pagesCount,this.items.pageRotateCw.disabled=0===this.pagesCount,this.items.pageRotateCcw.disabled=0===this.pagesCount}_bindClickListeners(){this.toggleButton.addEventListener("click",this.toggle.bind(this));for(const{element:element,eventName:eventName,close:close,eventDetails:eventDetails}of this.buttons)element.addEventListener("click",(evt=>{if(null!==eventName){const details={source:this};for(const property in eventDetails)details[property]=eventDetails[property];this.eventBus.dispatch(eventName,details)}close&&this.close()}))}_bindCursorToolsListener(buttons){this.eventBus._on("cursortoolchanged",(function({tool:tool}){buttons.cursorSelectToolButton.classList.toggle("toggled",tool===_pdf_cursor_tools.CursorTool.SELECT),buttons.cursorHandToolButton.classList.toggle("toggled",tool===_pdf_cursor_tools.CursorTool.HAND)}))}_bindScrollModeListener(buttons){const scrollModeChanged=({mode:mode})=>{buttons.scrollPageButton.classList.toggle("toggled",mode===_ui_utils.ScrollMode.PAGE),buttons.scrollVerticalButton.classList.toggle("toggled",mode===_ui_utils.ScrollMode.VERTICAL),buttons.scrollHorizontalButton.classList.toggle("toggled",mode===_ui_utils.ScrollMode.HORIZONTAL),buttons.scrollWrappedButton.classList.toggle("toggled",mode===_ui_utils.ScrollMode.WRAPPED);const forceScrollModePage=this.pagesCount>_base_viewer.PagesCountLimit.FORCE_SCROLL_MODE_PAGE;buttons.scrollPageButton.disabled=forceScrollModePage,buttons.scrollVerticalButton.disabled=forceScrollModePage,buttons.scrollHorizontalButton.disabled=forceScrollModePage,buttons.scrollWrappedButton.disabled=forceScrollModePage;const isScrollModeHorizontal=mode===_ui_utils.ScrollMode.HORIZONTAL;buttons.spreadNoneButton.disabled=isScrollModeHorizontal,buttons.spreadOddButton.disabled=isScrollModeHorizontal,buttons.spreadEvenButton.disabled=isScrollModeHorizontal};this.eventBus._on("scrollmodechanged",scrollModeChanged),this.eventBus._on("secondarytoolbarreset",(evt=>{evt.source===this&&scrollModeChanged({mode:_ui_utils.ScrollMode.VERTICAL})}))}_bindSpreadModeListener(buttons){function spreadModeChanged({mode:mode}){buttons.spreadNoneButton.classList.toggle("toggled",mode===_ui_utils.SpreadMode.NONE),buttons.spreadOddButton.classList.toggle("toggled",mode===_ui_utils.SpreadMode.ODD),buttons.spreadEvenButton.classList.toggle("toggled",mode===_ui_utils.SpreadMode.EVEN)}this.eventBus._on("spreadmodechanged",spreadModeChanged),this.eventBus._on("secondarytoolbarreset",(evt=>{evt.source===this&&spreadModeChanged({mode:_ui_utils.SpreadMode.NONE})}))}open(){this.opened||(this.opened=!0,this._setMaxHeight(),this.toggleButton.classList.add("toggled"),this.toggleButton.setAttribute("aria-expanded","true"),this.toolbar.classList.remove("hidden"))}close(){this.opened&&(this.opened=!1,this.toolbar.classList.add("hidden"),this.toggleButton.classList.remove("toggled"),this.toggleButton.setAttribute("aria-expanded","false"))}toggle(){this.opened?this.close():this.open()}_setMaxHeight(){this.opened&&(this.containerHeight=this.mainContainer.clientHeight,this.containerHeight!==this.previousContainerHeight&&(this.toolbarButtonContainer.style.maxHeight=this.containerHeight-_ui_utils.SCROLLBAR_PADDING+"px",this.previousContainerHeight=this.containerHeight))}}},(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.Toolbar=void 0;var _ui_utils=__webpack_require__(3);exports.Toolbar=class{constructor(options,eventBus,l10n){this.toolbar=options.container,this.eventBus=eventBus,this.l10n=l10n,this.buttons=[{element:options.previous,eventName:"previouspage"},{element:options.next,eventName:"nextpage"},{element:options.zoomIn,eventName:"zoomin"},{element:options.zoomOut,eventName:"zoomout"},{element:options.openFile,eventName:"openfile"},{element:options.print,eventName:"print"},{element:options.presentationModeButton,eventName:"presentationmode"},{element:options.download,eventName:"download"},{element:options.viewBookmark,eventName:null}],this.items={numPages:options.numPages,pageNumber:options.pageNumber,scaleSelect:options.scaleSelect,customScaleOption:options.customScaleOption,previous:options.previous,next:options.next,zoomIn:options.zoomIn,zoomOut:options.zoomOut},this._wasLocalized=!1,this.reset(),this._bindListeners()}setPageNumber(pageNumber,pageLabel){this.pageNumber=pageNumber,this.pageLabel=pageLabel,this._updateUIState(!1)}setPagesCount(pagesCount,hasPageLabels){this.pagesCount=pagesCount,this.hasPageLabels=hasPageLabels,this._updateUIState(!0)}setPageScale(pageScaleValue,pageScale){this.pageScaleValue=(pageScaleValue||pageScale).toString(),this.pageScale=pageScale,this._updateUIState(!1)}reset(){this.pageNumber=0,this.pageLabel=null,this.hasPageLabels=!1,this.pagesCount=0,this.pageScaleValue=_ui_utils.DEFAULT_SCALE_VALUE,this.pageScale=_ui_utils.DEFAULT_SCALE,this._updateUIState(!0),this.updateLoadingIndicatorState()}_bindListeners(){const{pageNumber:pageNumber,scaleSelect:scaleSelect}=this.items,self=this;for(const{element:element,eventName:eventName}of this.buttons)element.addEventListener("click",(evt=>{null!==eventName&&this.eventBus.dispatch(eventName,{source:this})}));pageNumber.addEventListener("click",(function(){this.select()})),pageNumber.addEventListener("change",(function(){self.eventBus.dispatch("pagenumberchanged",{source:self,value:this.value})})),scaleSelect.addEventListener("change",(function(){"custom"!==this.value&&self.eventBus.dispatch("scalechanged",{source:self,value:this.value})})),scaleSelect.addEventListener("click",(function(evt){const target=evt.target;this.value===self.pageScaleValue&&"OPTION"===target.tagName.toUpperCase()&&this.blur()})),scaleSelect.oncontextmenu=_ui_utils.noContextMenuHandler,this.eventBus._on("localized",(()=>{this._wasLocalized=!0,this._adjustScaleWidth(),this._updateUIState(!0)}))}_updateUIState(resetNumPages=!1){if(!this._wasLocalized)return;const{pageNumber:pageNumber,pagesCount:pagesCount,pageScaleValue:pageScaleValue,pageScale:pageScale,items:items}=this;resetNumPages&&(this.hasPageLabels?items.pageNumber.type="text":(items.pageNumber.type="number",this.l10n.get("of_pages",{pagesCount:pagesCount}).then((msg=>{items.numPages.textContent=msg}))),items.pageNumber.max=pagesCount),this.hasPageLabels?(items.pageNumber.value=this.pageLabel,this.l10n.get("page_of_pages",{pageNumber:pageNumber,pagesCount:pagesCount}).then((msg=>{items.numPages.textContent=msg}))):items.pageNumber.value=pageNumber,items.previous.disabled=pageNumber<=1,items.next.disabled=pageNumber>=pagesCount,items.zoomOut.disabled=pageScale<=_ui_utils.MIN_SCALE,items.zoomIn.disabled=pageScale>=_ui_utils.MAX_SCALE,this.l10n.get("page_scale_percent",{scale:Math.round(1e4*pageScale)/100}).then((msg=>{let predefinedValueFound=!1;for(const option of items.scaleSelect.options)option.value===pageScaleValue?(option.selected=!0,predefinedValueFound=!0):option.selected=!1;predefinedValueFound||(items.customScaleOption.textContent=msg,items.customScaleOption.selected=!0)}))}updateLoadingIndicatorState(loading=!1){this.items.pageNumber.classList.toggle("visiblePageIsLoading",loading)}async _adjustScaleWidth(){const{items:items,l10n:l10n}=this,predefinedValuesPromise=Promise.all([l10n.get("page_scale_auto"),l10n.get("page_scale_actual"),l10n.get("page_scale_fit"),l10n.get("page_scale_width")]),style=getComputedStyle(items.scaleSelect),scaleSelectContainerWidth=parseInt(style.getPropertyValue("--scale-select-container-width"),10),scaleSelectOverflow=parseInt(style.getPropertyValue("--scale-select-overflow"),10);let canvas=document.createElement("canvas");canvas.mozOpaque=!0;let ctx=canvas.getContext("2d",{alpha:!1});await _ui_utils.animationStarted,ctx.font=`${style.fontSize} ${style.fontFamily}`;let maxWidth=0;for(const predefinedValue of await predefinedValuesPromise){const{width:width}=ctx.measureText(predefinedValue);width>maxWidth&&(maxWidth=width)}if(maxWidth+=2*scaleSelectOverflow,maxWidth>scaleSelectContainerWidth){document.documentElement.style.setProperty("--scale-select-container-width",`${maxWidth}px`)}canvas.width=0,canvas.height=0,canvas=ctx=null}}},(__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.ViewHistory=void 0;exports.ViewHistory=class{constructor(fingerprint,cacheSize=20){this.fingerprint=fingerprint,this.cacheSize=cacheSize,this._initializedPromise=this._readFromStorage().then((databaseStr=>{const database=JSON.parse(databaseStr||"{}");let index=-1;if(Array.isArray(database.files)){for(;database.files.length>=this.cacheSize;)database.files.shift();for(let i=0,ii=database.files.length;i<ii;i++){if(database.files[i].fingerprint===this.fingerprint){index=i;break}}}else database.files=[];-1===index&&(index=database.files.push({fingerprint:this.fingerprint})-1),this.file=database.files[index],this.database=database}))}async _writeToStorage(){const databaseStr=JSON.stringify(this.database);localStorage.setItem("pdfjs.history",databaseStr)}async _readFromStorage(){return localStorage.getItem("pdfjs.history")}async set(name,val){return await this._initializedPromise,this.file[name]=val,this._writeToStorage()}async setMultiple(properties){await this._initializedPromise;for(const name in properties)this.file[name]=properties[name];return this._writeToStorage()}async get(name,defaultValue){await this._initializedPromise;const val=this.file[name];return void 0!==val?val:defaultValue}async getMultiple(properties){await this._initializedPromise;const values=Object.create(null);for(const name in properties){const val=this.file[name];values[name]=void 0!==val?val:properties[name]}return values}}},(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.GenericCom=void 0;var _app=__webpack_require__(2),_preferences=__webpack_require__(40),_download_manager=__webpack_require__(41),_genericl10n=__webpack_require__(42),_generic_scripting=__webpack_require__(44);exports.GenericCom={};class GenericPreferences extends _preferences.BasePreferences{async _writeToStorage(prefObj){localStorage.setItem("pdfjs.preferences",JSON.stringify(prefObj))}async _readFromStorage(prefObj){return JSON.parse(localStorage.getItem("pdfjs.preferences"))}}class GenericExternalServices extends _app.DefaultExternalServices{static createDownloadManager(options){return new _download_manager.DownloadManager}static createPreferences(){return new GenericPreferences}static createL10n({locale:locale="en-US"}){return new _genericl10n.GenericL10n(locale)}static createScripting({sandboxBundleSrc:sandboxBundleSrc}){return new _generic_scripting.GenericScripting(sandboxBundleSrc)}}_app.PDFViewerApplication.externalServices=GenericExternalServices},(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.BasePreferences=void 0;__webpack_require__(1);class BasePreferences{constructor(){if(this.constructor===BasePreferences)throw new Error("Cannot initialize BasePreferences.");Object.defineProperty(this,"defaults",{value:Object.freeze({annotationMode:2,cursorToolOnLoad:0,defaultZoomValue:"",disablePageLabels:!1,enablePermissions:!1,enablePrintAutoRotate:!0,enableScripting:!0,externalLinkTarget:0,historyUpdateUrl:!1,ignoreDestinationZoom:!1,pdfBugEnabled:!1,renderer:"canvas",sidebarViewOnLoad:-1,scrollModeOnLoad:-1,spreadModeOnLoad:-1,textLayerMode:1,useOnlyCssZoom:!1,viewerCssTheme:0,viewOnLoad:0,disableAutoFetch:!1,disableFontFace:!1,disableRange:!1,disableStream:!1,enableXfa:!0}),writable:!1,enumerable:!0,configurable:!1}),this.prefs=Object.create(null),this._initializedPromise=this._readFromStorage(this.defaults).then((prefs=>{for(const name in this.defaults){const prefValue=prefs?.[name];typeof prefValue==typeof this.defaults[name]&&(this.prefs[name]=prefValue)}}))}async _writeToStorage(prefObj){throw new Error("Not implemented: _writeToStorage")}async _readFromStorage(prefObj){throw new Error("Not implemented: _readFromStorage")}async reset(){return await this._initializedPromise,this.prefs=Object.create(null),this._writeToStorage(this.defaults)}async set(name,value){await this._initializedPromise;const defaultValue=this.defaults[name];if(void 0===defaultValue)throw new Error(`Set preference: "${name}" is undefined.`);if(void 0===value)throw new Error("Set preference: no value is specified.");const valueType=typeof value,defaultType=typeof defaultValue;if(valueType!==defaultType){if("number"!==valueType||"string"!==defaultType)throw new Error(`Set preference: "${value}" is a ${valueType}, expected a ${defaultType}.`);value=value.toString()}else if("number"===valueType&&!Number.isInteger(value))throw new Error(`Set preference: "${value}" must be an integer.`);return this.prefs[name]=value,this._writeToStorage(this.prefs)}async get(name){await this._initializedPromise;const defaultValue=this.defaults[name],prefValue=this.prefs[name];if(void 0===defaultValue)throw new Error(`Get preference: "${name}" is undefined.`);return void 0!==prefValue?prefValue:defaultValue}async getAll(){await this._initializedPromise;const obj=Object.create(null);for(const name in this.defaults){const prefValue=this.prefs[name];obj[name]=void 0!==prefValue?prefValue:this.defaults[name]}return obj}}exports.BasePreferences=BasePreferences},(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.DownloadManager=void 0;var _pdfjsLib=__webpack_require__(5);function download(blobUrl,filename){const a=document.createElement("a");if(!a.click)throw new Error('DownloadManager: "a.click()" is not supported.');a.href=blobUrl,a.target="_parent","download"in a&&(a.download=filename),(document.body||document.documentElement).appendChild(a),a.click(),a.remove()}exports.DownloadManager=class{constructor(){this._openBlobUrls=new WeakMap}downloadUrl(url,filename){(0,_pdfjsLib.createValidAbsoluteUrl)(url,"http://example.com")?download(url+"#pdfjs.action=download",filename):console.error(`downloadUrl - not a valid URL: ${url}`)}downloadData(data,filename,contentType){download(URL.createObjectURL(new Blob([data],{type:contentType})),filename)}openOrDownloadData(element,data,filename){const isPdfData=(0,_pdfjsLib.isPdfFile)(filename),contentType=isPdfData?"application/pdf":"";if(isPdfData){let viewerUrl,blobUrl=this._openBlobUrls.get(element);blobUrl||(blobUrl=URL.createObjectURL(new Blob([data],{type:contentType})),this._openBlobUrls.set(element,blobUrl)),viewerUrl="?file="+encodeURIComponent(blobUrl+"#"+filename);try{return window.open(viewerUrl),!0}catch(ex){console.error(`openOrDownloadData: ${ex}`),URL.revokeObjectURL(blobUrl),this._openBlobUrls.delete(element)}}return this.downloadData(data,filename,contentType),!1}download(blob,url,filename,sourceEventType="download"){download(URL.createObjectURL(blob),filename)}}},(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.GenericL10n=void 0,__webpack_require__(43);var _l10n_utils=__webpack_require__(30);const webL10n=document.webL10n;exports.GenericL10n=class{constructor(lang){this._lang=lang,this._ready=new Promise(((resolve,reject)=>{webL10n.setLanguage((0,_l10n_utils.fixupLangCode)(lang),(()=>{resolve(webL10n)}))}))}async getLanguage(){return(await this._ready).getLanguage()}async getDirection(){return(await this._ready).getDirection()}async get(key,args=null,fallback=(0,_l10n_utils.getL10nFallback)(key,args)){return(await this._ready).get(key,args,fallback)}async translate(element){return(await this._ready).translate(element)}}},()=>{document.webL10n=function(window,document,undefined){var gL10nData={},gTextData="",gTextProp="textContent",gLanguage="",gMacros={},gReadyState="loading";function xhrLoadText(url,onSuccess,onFailure){onSuccess=onSuccess||function(data){},onFailure=onFailure||function(){};var xhr=new XMLHttpRequest;xhr.open("GET",url,true),xhr.overrideMimeType&&xhr.overrideMimeType("text/plain; charset=utf-8"),xhr.onreadystatechange=function(){4==xhr.readyState&&(200==xhr.status||0===xhr.status?onSuccess(xhr.responseText):onFailure())},xhr.onerror=onFailure,xhr.ontimeout=onFailure;try{xhr.send(null)}catch(e){onFailure()}}function parseResource(href,lang,successCallback,failureCallback){var baseURL=href.replace(/[^\/]*$/,"")||"./";function evalString(text){return text.lastIndexOf("\\")<0?text:text.replace(/\\\\/g,"\\").replace(/\\n/g,"\n").replace(/\\r/g,"\r").replace(/\\t/g,"\t").replace(/\\b/g,"\b").replace(/\\f/g,"\f").replace(/\\{/g,"{").replace(/\\}/g,"}").replace(/\\"/g,'"').replace(/\\'/g,"'")}xhrLoadText(href,(function(response){gTextData+=response,function(text,parsedPropertiesCallback){var dictionary={},reBlank=/^\s*|\s*$/,reComment=/^\s*#|^\s*$/,reSection=/^\s*\[(.*)\]\s*$/,reImport=/^\s*@import\s+url\((.*)\)\s*$/i,reSplit=/^([^=\s]*)\s*=\s*(.+)$/;function parseRawLines(rawText,extendedSyntax,parsedRawLinesCallback){var entries=rawText.replace(reBlank,"").split(/[\r\n]+/),currentLang="*",genericLang=lang.split("-",1)[0],skipLang=!1,match="";!function nextEntry(){for(;;){if(!entries.length)return void parsedRawLinesCallback();var line=entries.shift();if(!reComment.test(line)){if(extendedSyntax){if(match=reSection.exec(line)){currentLang=match[1].toLowerCase(),skipLang="*"!==currentLang&&currentLang!==lang&&currentLang!==genericLang;continue}if(skipLang)continue;if(match=reImport.exec(line))return void loadImport(baseURL+match[1],nextEntry)}var tmp=line.match(reSplit);tmp&&3==tmp.length&&(dictionary[tmp[1]]=evalString(tmp[2]))}}}()}function loadImport(url,callback){xhrLoadText(url,(function(content){parseRawLines(content,!1,callback)}),(function(){console.warn(url+" not found."),callback()}))}parseRawLines(text,!0,(function(){parsedPropertiesCallback(dictionary)}))}(response,(function(data){for(var key in data){var id,prop,index=key.lastIndexOf(".");index>0?(id=key.substring(0,index),prop=key.substring(index+1)):(id=key,prop=gTextProp),gL10nData[id]||(gL10nData[id]={}),gL10nData[id][prop]=data[key]}successCallback&&successCallback()}))}),failureCallback)}function loadLocale(lang,callback){lang&&(lang=lang.toLowerCase()),callback=callback||function(){},gL10nData={},gTextData="",gLanguage="",gLanguage=lang;var langLinks=document.querySelectorAll('link[type="application/l10n"]'),langCount=langLinks.length;if(0!==langCount){var script,onResourceLoaded,gResourceCount=0;onResourceLoaded=function(){++gResourceCount>=langCount&&(callback(),gReadyState="complete")};for(var i=0;i<langCount;i++){new L10nResourceLink(langLinks[i]).load(lang,onResourceLoaded)}}else{var dict=(script=document.querySelector('script[type="application/l10n"]'))?JSON.parse(script.innerHTML):null;if(dict&&dict.locales&&dict.default_locale){if(console.log("using the embedded JSON directory, early way out"),!(gL10nData=dict.locales[lang])){var defaultLocale=dict.default_locale.toLowerCase();for(var anyCaseLang in dict.locales){if((anyCaseLang=anyCaseLang.toLowerCase())===lang){gL10nData=dict.locales[lang];break}anyCaseLang===defaultLocale&&(gL10nData=dict.locales[defaultLocale])}}callback()}else console.log("no resource to load, early way out");gReadyState="complete"}function L10nResourceLink(link){var href=link.href;this.load=function(lang,callback){parseResource(href,lang,callback,(function(){console.warn(href+" not found."),console.warn('"'+lang+'" resource not found'),gLanguage="",callback()}))}}}function getL10nData(key,args,fallback){var data=gL10nData[key];if(!data){if(console.warn("#"+key+" is undefined."),!fallback)return null;data=fallback}var rv={};for(var prop in data){var str=data[prop];str=substArguments(str=substIndexes(str,args,key,prop),args,key),rv[prop]=str}return rv}function substIndexes(str,args,key,prop){var reMatch=/\{\[\s*([a-zA-Z]+)\(([a-zA-Z]+)\)\s*\]\}/.exec(str);if(!reMatch||!reMatch.length)return str;var param,macroName=reMatch[1],paramName=reMatch[2];(args&&paramName in args?param=args[paramName]:paramName in gL10nData&&(param=gL10nData[paramName]),macroName in gMacros)&&(str=(0,gMacros[macroName])(str,param,key,prop));return str}function substArguments(str,args,key){return str.replace(/\{\{\s*(.+?)\s*\}\}/g,(function(matched_text,arg){return args&&arg in args?args[arg]:arg in gL10nData?gL10nData[arg]:(console.log("argument {{"+arg+"}} for #"+key+" is undefined."),matched_text)}))}function translateElement(element){var l10n=function(element){if(!element)return{};var l10nId=element.getAttribute("data-l10n-id"),l10nArgs=element.getAttribute("data-l10n-args"),args={};if(l10nArgs)try{args=JSON.parse(l10nArgs)}catch(e){console.warn("could not parse arguments for #"+l10nId)}return{id:l10nId,args:args}}(element);if(l10n.id){var data=getL10nData(l10n.id,l10n.args);if(data){if(data[gTextProp]){if(0===function(element){if(element.children)return element.children.length;if(void 0!==element.childElementCount)return element.childElementCount;for(var count=0,i=0;i<element.childNodes.length;i++)count+=1===element.nodeType?1:0;return count}(element))element[gTextProp]=data[gTextProp];else{for(var children=element.childNodes,found=!1,i=0,l=children.length;i<l;i++)3===children[i].nodeType&&/\S/.test(children[i].nodeValue)&&(found?children[i].nodeValue="":(children[i].nodeValue=data[gTextProp],found=!0));if(!found){var textNode=document.createTextNode(data[gTextProp]);element.insertBefore(textNode,element.firstChild)}}delete data[gTextProp]}for(var k in data)element[k]=data[k]}else console.warn("#"+l10n.id+" is undefined.")}}return gMacros.plural=function(str,param,key,prop){var n=parseFloat(param);if(isNaN(n))return str;if(prop!=gTextProp)return str;gMacros._pluralRules||(gMacros._pluralRules=function(lang){function isIn(n,list){return-1!==list.indexOf(n)}function isBetween(n,start,end){return start<=n&&n<=end}var pluralRules={0:function(n){return"other"},1:function(n){return isBetween(n%100,3,10)?"few":0===n?"zero":isBetween(n%100,11,99)?"many":2==n?"two":1==n?"one":"other"},2:function(n){return 0!==n&&n%10==0?"many":2==n?"two":1==n?"one":"other"},3:function(n){return 1==n?"one":"other"},4:function(n){return isBetween(n,0,1)?"one":"other"},5:function(n){return isBetween(n,0,2)&&2!=n?"one":"other"},6:function(n){return 0===n?"zero":n%10==1&&n%100!=11?"one":"other"},7:function(n){return 2==n?"two":1==n?"one":"other"},8:function(n){return isBetween(n,3,6)?"few":isBetween(n,7,10)?"many":2==n?"two":1==n?"one":"other"},9:function(n){return 0===n||1!=n&&isBetween(n%100,1,19)?"few":1==n?"one":"other"},10:function(n){return isBetween(n%10,2,9)&&!isBetween(n%100,11,19)?"few":n%10!=1||isBetween(n%100,11,19)?"other":"one"},11:function(n){return isBetween(n%10,2,4)&&!isBetween(n%100,12,14)?"few":n%10==0||isBetween(n%10,5,9)||isBetween(n%100,11,14)?"many":n%10==1&&n%100!=11?"one":"other"},12:function(n){return isBetween(n,2,4)?"few":1==n?"one":"other"},13:function(n){return isBetween(n%10,2,4)&&!isBetween(n%100,12,14)?"few":1!=n&&isBetween(n%10,0,1)||isBetween(n%10,5,9)||isBetween(n%100,12,14)?"many":1==n?"one":"other"},14:function(n){return isBetween(n%100,3,4)?"few":n%100==2?"two":n%100==1?"one":"other"},15:function(n){return 0===n||isBetween(n%100,2,10)?"few":isBetween(n%100,11,19)?"many":1==n?"one":"other"},16:function(n){return n%10==1&&11!=n?"one":"other"},17:function(n){return 3==n?"few":0===n?"zero":6==n?"many":2==n?"two":1==n?"one":"other"},18:function(n){return 0===n?"zero":isBetween(n,0,2)&&0!==n&&2!=n?"one":"other"},19:function(n){return isBetween(n,2,10)?"few":isBetween(n,0,1)?"one":"other"},20:function(n){return!isBetween(n%10,3,4)&&n%10!=9||isBetween(n%100,10,19)||isBetween(n%100,70,79)||isBetween(n%100,90,99)?n%1e6==0&&0!==n?"many":n%10!=2||isIn(n%100,[12,72,92])?n%10!=1||isIn(n%100,[11,71,91])?"other":"one":"two":"few"},21:function(n){return 0===n?"zero":1==n?"one":"other"},22:function(n){return isBetween(n,0,1)||isBetween(n,11,99)?"one":"other"},23:function(n){return isBetween(n%10,1,2)||n%20==0?"one":"other"},24:function(n){return isBetween(n,3,10)||isBetween(n,13,19)?"few":isIn(n,[2,12])?"two":isIn(n,[1,11])?"one":"other"}},index={af:3,ak:4,am:4,ar:1,asa:3,az:0,be:11,bem:3,bez:3,bg:3,bh:4,bm:0,bn:3,bo:0,br:20,brx:3,bs:11,ca:3,cgg:3,chr:3,cs:12,cy:17,da:3,de:3,dv:3,dz:0,ee:3,el:3,en:3,eo:3,es:3,et:3,eu:3,fa:0,ff:5,fi:3,fil:4,fo:3,fr:5,fur:3,fy:3,ga:8,gd:24,gl:3,gsw:3,gu:3,guw:4,gv:23,ha:3,haw:3,he:2,hi:4,hr:11,hu:0,id:0,ig:0,ii:0,is:3,it:3,iu:7,ja:0,jmc:3,jv:0,ka:0,kab:5,kaj:3,kcg:3,kde:0,kea:0,kk:3,kl:3,km:0,kn:0,ko:0,ksb:3,ksh:21,ku:3,kw:7,lag:18,lb:3,lg:3,ln:4,lo:0,lt:10,lv:6,mas:3,mg:4,mk:16,ml:3,mn:3,mo:9,mr:3,ms:0,mt:15,my:0,nah:3,naq:7,nb:3,nd:3,ne:3,nl:3,nn:3,no:3,nr:3,nso:4,ny:3,nyn:3,om:3,or:3,pa:3,pap:3,pl:13,ps:3,pt:3,rm:3,ro:9,rof:3,ru:11,rwk:3,sah:0,saq:3,se:7,seh:3,ses:0,sg:0,sh:11,shi:19,sk:12,sl:14,sma:7,smi:7,smj:7,smn:7,sms:7,sn:3,so:3,sq:3,sr:11,ss:3,ssy:3,st:3,sv:3,sw:3,syr:3,ta:3,te:3,teo:3,th:0,ti:4,tig:3,tk:3,tl:4,tn:3,to:0,tr:0,ts:3,tzm:22,uk:11,ur:3,ve:3,vi:0,vun:3,wa:4,wae:3,wo:0,xh:3,xog:3,yo:0,zh:0,zu:3}[lang.replace(/-.*$/,"")];return index in pluralRules?pluralRules[index]:(console.warn("plural form unknown for ["+lang+"]"),function(){return"other"})}(gLanguage));var index="["+gMacros._pluralRules(n)+"]";return 0===n&&key+"[zero]"in gL10nData?str=gL10nData[key+"[zero]"][prop]:1==n&&key+"[one]"in gL10nData?str=gL10nData[key+"[one]"][prop]:2==n&&key+"[two]"in gL10nData?str=gL10nData[key+"[two]"][prop]:key+index in gL10nData?str=gL10nData[key+index][prop]:key+"[other]"in gL10nData&&(str=gL10nData[key+"[other]"][prop]),str},{get:function(key,args,fallbackString){var fallback,index=key.lastIndexOf("."),prop=gTextProp;index>0&&(prop=key.substring(index+1),key=key.substring(0,index)),fallbackString&&((fallback={})[prop]=fallbackString);var data=getL10nData(key,args,fallback);return data&&prop in data?data[prop]:"{{"+key+"}}"},getData:function(){return gL10nData},getText:function(){return gTextData},getLanguage:function(){return gLanguage},setLanguage:function(lang,callback){loadLocale(lang,(function(){callback&&callback()}))},getDirection:function(){var shortCode=gLanguage.split("-",1)[0];return["ar","he","fa","ps","ur"].indexOf(shortCode)>=0?"rtl":"ltr"},translate:function(element){for(var children=function(element){return element?element.querySelectorAll("*[data-l10n-id]"):[]}(element=element||document.documentElement),elementCount=children.length,i=0;i<elementCount;i++)translateElement(children[i]);translateElement(element)},getReadyState:function(){return gReadyState},ready:function(callback){callback&&("complete"==gReadyState||"interactive"==gReadyState?window.setTimeout((function(){callback()})):document.addEventListener&&document.addEventListener("localized",(function once(){document.removeEventListener("localized",once),callback()})))}}}(window,document)},(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.GenericScripting=void 0,exports.docPropertiesLookup=async function(pdfDocument){const baseUrl="".split("#")[0];let{info:info,metadata:metadata,contentDispositionFilename:contentDispositionFilename,contentLength:contentLength}=await pdfDocument.getMetadata();if(!contentLength){const{length:length}=await pdfDocument.getDownloadInfo();contentLength=length}return{...info,baseURL:baseUrl,filesize:contentLength,filename:contentDispositionFilename||(0,_pdfjsLib.getPdfFilenameFromUrl)(""),metadata:metadata?.getRaw(),authors:metadata?.get("dc:creator"),numPages:pdfDocument.numPages,URL:""}};var _pdfjsLib=__webpack_require__(5);exports.GenericScripting=class{constructor(sandboxBundleSrc){this._ready=(0,_pdfjsLib.loadScript)(sandboxBundleSrc,!0).then((()=>window.pdfjsSandbox.QuickJSSandbox()))}async createSandbox(data){(await this._ready).create(data)}async dispatchEventInSandbox(event){const sandbox=await this._ready;setTimeout((()=>sandbox.dispatchEvent(event)),0)}async destroySandbox(){(await this._ready).nukeSandbox()}}},(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.PDFPrintService=PDFPrintService;var _pdfjsLib=__webpack_require__(5),_app=__webpack_require__(2),_print_utils=__webpack_require__(46);let activeService=null,overlayManager=null;function PDFPrintService(pdfDocument,pagesOverview,printContainer,printResolution,optionalContentConfigPromise=null,l10n){this.pdfDocument=pdfDocument,this.pagesOverview=pagesOverview,this.printContainer=printContainer,this._printResolution=printResolution||150,this._optionalContentConfigPromise=optionalContentConfigPromise||pdfDocument.getOptionalContentConfig(),this.l10n=l10n,this.currentPage=-1,this.scratchCanvas=document.createElement("canvas")}PDFPrintService.prototype={layout(){this.throwIfInactive();const body=document.querySelector("body");body.setAttribute("data-pdfjsprinting",!0);this.pagesOverview.every((function(size){return size.width===this.pagesOverview[0].width&&size.height===this.pagesOverview[0].height}),this)||console.warn("Not all pages have the same size. The printed result may be incorrect!"),this.pageStyleSheet=document.createElement("style");const pageSize=this.pagesOverview[0];this.pageStyleSheet.textContent="@page { size: "+pageSize.width+"pt "+pageSize.height+"pt;}",body.appendChild(this.pageStyleSheet)},destroy(){if(activeService!==this)return;this.printContainer.textContent="";document.querySelector("body").removeAttribute("data-pdfjsprinting"),this.pageStyleSheet&&(this.pageStyleSheet.remove(),this.pageStyleSheet=null),this.scratchCanvas.width=this.scratchCanvas.height=0,this.scratchCanvas=null,activeService=null,ensureOverlay().then((function(){"printServiceOverlay"===overlayManager.active&&overlayManager.close("printServiceOverlay")}))},renderPages(){if(this.pdfDocument.isPureXfa)return(0,_print_utils.getXfaHtmlForPrinting)(this.printContainer,this.pdfDocument),Promise.resolve();const pageCount=this.pagesOverview.length,renderNextPage=(resolve,reject)=>{if(this.throwIfInactive(),++this.currentPage>=pageCount)return renderProgress(pageCount,pageCount,this.l10n),void resolve();const index=this.currentPage;renderProgress(index,pageCount,this.l10n),function(activeServiceOnEntry,pdfDocument,pageNumber,size,printResolution,optionalContentConfigPromise){const scratchCanvas=activeService.scratchCanvas,PRINT_UNITS=printResolution/_pdfjsLib.PixelsPerInch.PDF;scratchCanvas.width=Math.floor(size.width*PRINT_UNITS),scratchCanvas.height=Math.floor(size.height*PRINT_UNITS);const ctx=scratchCanvas.getContext("2d");return ctx.save(),ctx.fillStyle="rgb(255, 255, 255)",ctx.fillRect(0,0,scratchCanvas.width,scratchCanvas.height),ctx.restore(),pdfDocument.getPage(pageNumber).then((function(pdfPage){const renderContext={canvasContext:ctx,transform:[PRINT_UNITS,0,0,PRINT_UNITS,0,0],viewport:pdfPage.getViewport({scale:1,rotation:size.rotation}),intent:"print",annotationMode:_pdfjsLib.AnnotationMode.ENABLE_STORAGE,optionalContentConfigPromise:optionalContentConfigPromise};return pdfPage.render(renderContext).promise}))}(0,this.pdfDocument,index+1,this.pagesOverview[index],this._printResolution,this._optionalContentConfigPromise).then(this.useRenderedPage.bind(this)).then((function(){renderNextPage(resolve,reject)}),reject)};return new Promise(renderNextPage)},useRenderedPage(){this.throwIfInactive();const img=document.createElement("img"),scratchCanvas=this.scratchCanvas;"toBlob"in scratchCanvas?scratchCanvas.toBlob((function(blob){img.src=URL.createObjectURL(blob)})):img.src=scratchCanvas.toDataURL();const wrapper=document.createElement("div");return wrapper.className="printedPage",wrapper.appendChild(img),this.printContainer.appendChild(wrapper),new Promise((function(resolve,reject){img.onload=resolve,img.onerror=reject}))},performPrint(){return this.throwIfInactive(),new Promise((resolve=>{setTimeout((()=>{this.active?(print.call(window),setTimeout(resolve,20)):resolve()}),0)}))},get active(){return this===activeService},throwIfInactive(){if(!this.active)throw new Error("This print request was cancelled or completed.")}};const print=window.print;function dispatchEvent(eventType){const event=document.createEvent("CustomEvent");event.initCustomEvent(eventType,!1,!1,"custom"),window.dispatchEvent(event)}function abort(){activeService&&(activeService.destroy(),dispatchEvent("afterprint"))}function renderProgress(index,total,l10n){const progressContainer=document.getElementById("printServiceOverlay"),progress=Math.round(100*index/total),progressBar=progressContainer.querySelector("progress"),progressPerc=progressContainer.querySelector(".relative-progress");progressBar.value=progress,l10n.get("print_progress_percent",{progress:progress}).then((msg=>{progressPerc.textContent=msg}))}if(window.print=function(){if(activeService)console.warn("Ignored window.print() because of a pending print job.");else{ensureOverlay().then((function(){activeService&&overlayManager.open("printServiceOverlay")}));try{dispatchEvent("beforeprint")}finally{if(!activeService)return console.error("Expected print service to be initialized."),void ensureOverlay().then((function(){"printServiceOverlay"===overlayManager.active&&overlayManager.close("printServiceOverlay")}));const activeServiceOnEntry=activeService;activeService.renderPages().then((function(){return activeServiceOnEntry.performPrint()})).catch((function(){})).then((function(){activeServiceOnEntry.active&&abort()}))}}},window.addEventListener("keydown",(function(event){80!==event.keyCode||!event.ctrlKey&&!event.metaKey||event.altKey||event.shiftKey&&!window.chrome&&!window.opera||(window.print(),event.preventDefault(),event.stopImmediatePropagation?event.stopImmediatePropagation():event.stopPropagation())}),!0),"onbeforeprint"in window){const stopPropagationIfNeeded=function(event){"custom"!==event.detail&&event.stopImmediatePropagation&&event.stopImmediatePropagation()};window.addEventListener("beforeprint",stopPropagationIfNeeded),window.addEventListener("afterprint",stopPropagationIfNeeded)}let overlayPromise;function ensureOverlay(){if(!overlayPromise){if(overlayManager=_app.PDFViewerApplication.overlayManager,!overlayManager)throw new Error("The overlay manager has not yet been initialized.");overlayPromise=overlayManager.register("printServiceOverlay",document.getElementById("printServiceOverlay"),abort,!0),document.getElementById("printCancel").onclick=abort}return overlayPromise}_app.PDFPrintServiceFactory.instance={supportsPrinting:!0,createPrintService(pdfDocument,pagesOverview,printContainer,printResolution,optionalContentConfigPromise,l10n){if(activeService)throw new Error("The print service is created and active.");return activeService=new PDFPrintService(pdfDocument,pagesOverview,printContainer,printResolution,optionalContentConfigPromise,l10n),activeService}}},(__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.getXfaHtmlForPrinting=function(printContainer,pdfDocument){const xfaHtml=pdfDocument.allXfaHtml,linkService=new _pdf_link_service.SimpleLinkService,scale=Math.round(100*_pdfjsLib.PixelsPerInch.PDF_TO_CSS_UNITS)/100;for(const xfaPage of xfaHtml.children){const page=document.createElement("div");page.className="xfaPrintedPage",printContainer.appendChild(page);const builder=new _xfa_layer_builder.XfaLayerBuilder({pageDiv:page,pdfPage:null,annotationStorage:pdfDocument.annotationStorage,linkService:linkService,xfaHtml:xfaPage}),viewport=(0,_pdfjsLib.getXfaPageViewport)(xfaPage,{scale:scale});builder.render(viewport,"print")}};var _pdfjsLib=__webpack_require__(5),_pdf_link_service=__webpack_require__(8),_xfa_layer_builder=__webpack_require__(35)}],__webpack_module_cache__={};function __webpack_require__(moduleId){var cachedModule=__webpack_module_cache__[moduleId];if(void 0!==cachedModule)return cachedModule.exports;var module=__webpack_module_cache__[moduleId]={exports:{}};return __webpack_modules__[moduleId](module,module.exports,__webpack_require__),module.exports}var __webpack_exports__={};(()=>{var exports=__webpack_exports__;Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"PDFViewerApplication",{enumerable:!0,get:function(){return _app.PDFViewerApplication}}),Object.defineProperty(exports,"PDFViewerApplicationOptions",{enumerable:!0,get:function(){return _app_options.AppOptions}});var _app_options=__webpack_require__(1),_app=__webpack_require__(2);function webViewerLoad(){const config=function(){let errorWrapper=null;return errorWrapper={container:document.getElementById("errorWrapper"),errorMessage:document.getElementById("errorMessage"),closeButton:document.getElementById("errorClose"),errorMoreInfo:document.getElementById("errorMoreInfo"),moreInfoButton:document.getElementById("errorShowMore"),lessInfoButton:document.getElementById("errorShowLess")},{appContainer:document.body,mainContainer:document.getElementById("viewerContainer"),viewerContainer:document.getElementById("viewer"),toolbar:{container:document.getElementById("toolbarViewer"),numPages:document.getElementById("numPages"),pageNumber:document.getElementById("pageNumber"),scaleSelect:document.getElementById("scaleSelect"),customScaleOption:document.getElementById("customScaleOption"),previous:document.getElementById("previous"),next:document.getElementById("next"),zoomIn:document.getElementById("zoomIn"),zoomOut:document.getElementById("zoomOut"),viewFind:document.getElementById("viewFind"),openFile:document.getElementById("openFile"),print:document.getElementById("print"),presentationModeButton:document.getElementById("presentationMode"),download:document.getElementById("download"),viewBookmark:document.getElementById("viewBookmark")},secondaryToolbar:{toolbar:document.getElementById("secondaryToolbar"),toggleButton:document.getElementById("secondaryToolbarToggle"),toolbarButtonContainer:document.getElementById("secondaryToolbarButtonContainer"),presentationModeButton:document.getElementById("secondaryPresentationMode"),openFileButton:document.getElementById("secondaryOpenFile"),printButton:document.getElementById("secondaryPrint"),downloadButton:document.getElementById("secondaryDownload"),viewBookmarkButton:document.getElementById("secondaryViewBookmark"),firstPageButton:document.getElementById("firstPage"),lastPageButton:document.getElementById("lastPage"),pageRotateCwButton:document.getElementById("pageRotateCw"),pageRotateCcwButton:document.getElementById("pageRotateCcw"),cursorSelectToolButton:document.getElementById("cursorSelectTool"),cursorHandToolButton:document.getElementById("cursorHandTool"),scrollPageButton:document.getElementById("scrollPage"),scrollVerticalButton:document.getElementById("scrollVertical"),scrollHorizontalButton:document.getElementById("scrollHorizontal"),scrollWrappedButton:document.getElementById("scrollWrapped"),spreadNoneButton:document.getElementById("spreadNone"),spreadOddButton:document.getElementById("spreadOdd"),spreadEvenButton:document.getElementById("spreadEven"),documentPropertiesButton:document.getElementById("documentProperties")},sidebar:{outerContainer:document.getElementById("outerContainer"),viewerContainer:document.getElementById("viewerContainer"),toggleButton:document.getElementById("sidebarToggle"),thumbnailButton:document.getElementById("viewThumbnail"),outlineButton:document.getElementById("viewOutline"),attachmentsButton:document.getElementById("viewAttachments"),layersButton:document.getElementById("viewLayers"),thumbnailView:document.getElementById("thumbnailView"),outlineView:document.getElementById("outlineView"),attachmentsView:document.getElementById("attachmentsView"),layersView:document.getElementById("layersView"),outlineOptionsContainer:document.getElementById("outlineOptionsContainer"),currentOutlineItemButton:document.getElementById("currentOutlineItem")},sidebarResizer:{outerContainer:document.getElementById("outerContainer"),resizer:document.getElementById("sidebarResizer")},findBar:{bar:document.getElementById("findbar"),toggleButton:document.getElementById("viewFind"),findField:document.getElementById("findInput"),highlightAllCheckbox:document.getElementById("findHighlightAll"),caseSensitiveCheckbox:document.getElementById("findMatchCase"),matchDiacriticsCheckbox:document.getElementById("findMatchDiacritics"),entireWordCheckbox:document.getElementById("findEntireWord"),findMsg:document.getElementById("findMsg"),findResultsCount:document.getElementById("findResultsCount"),findPreviousButton:document.getElementById("findPrevious"),findNextButton:document.getElementById("findNext")},passwordOverlay:{overlayName:"passwordOverlay",container:document.getElementById("passwordOverlay"),label:document.getElementById("passwordText"),input:document.getElementById("password"),submitButton:document.getElementById("passwordSubmit"),cancelButton:document.getElementById("passwordCancel")},documentProperties:{overlayName:"documentPropertiesOverlay",container:document.getElementById("documentPropertiesOverlay"),closeButton:document.getElementById("documentPropertiesClose"),fields:{fileName:document.getElementById("fileNameField"),fileSize:document.getElementById("fileSizeField"),title:document.getElementById("titleField"),author:document.getElementById("authorField"),subject:document.getElementById("subjectField"),keywords:document.getElementById("keywordsField"),creationDate:document.getElementById("creationDateField"),modificationDate:document.getElementById("modificationDateField"),creator:document.getElementById("creatorField"),producer:document.getElementById("producerField"),version:document.getElementById("versionField"),pageCount:document.getElementById("pageCountField"),pageSize:document.getElementById("pageSizeField"),linearized:document.getElementById("linearizedField")}},errorWrapper:errorWrapper,printContainer:document.getElementById("printContainer"),openFileInputName:"fileInput",debuggerScriptPath:"./debugger.js"}}(),event=document.createEvent("CustomEvent");event.initCustomEvent("webviewerloaded",!0,!0,{source:window});try{parent.document.dispatchEvent(event)}catch(ex){console.error(`webviewerloaded: ${ex}`),document.dispatchEvent(event)}_app.PDFViewerApplication.run(config)}window.PDFViewerApplication=_app.PDFViewerApplication,window.PDFViewerApplicationOptions=_app_options.AppOptions,__webpack_require__(39),__webpack_require__(45),document.blockUnblockOnload&&document.blockUnblockOnload(!0),"interactive"===document.readyState||"complete"===document.readyState?webViewerLoad():document.addEventListener("DOMContentLoaded",webViewerLoad,!0)})()})();